"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@segment";
exports.ids = ["vendor-chunks/@segment"];
exports.modules = {

/***/ "(ssr)/./node_modules/@segment/analytics-core/dist/esm/analytics/dispatch.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/@segment/analytics-core/dist/esm/analytics/dispatch.js ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   dispatch: () => (/* binding */ dispatch),\n/* harmony export */   getDelay: () => (/* binding */ getDelay)\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ \"(ssr)/./node_modules/tslib/tslib.es6.mjs\");\n/* harmony import */ var _callback__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../callback */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/callback/index.js\");\n\n\n/* The amount of time in ms to wait before invoking the callback. */\nvar getDelay = function (startTimeInEpochMS, timeoutInMS) {\n    var elapsedTime = Date.now() - startTimeInEpochMS;\n    // increasing the timeout increases the delay by almost the same amount -- this is weird legacy behavior.\n    return Math.max((timeoutInMS !== null && timeoutInMS !== void 0 ? timeoutInMS : 300) - elapsedTime, 0);\n};\n/**\n * Push an event into the dispatch queue and invoke any callbacks.\n *\n * @param event - Segment event to enqueue.\n * @param queue - Queue to dispatch against.\n * @param emitter - This is typically an instance of \"Analytics\" -- used for metrics / progress information.\n * @param options\n */\nfunction dispatch(ctx, queue, emitter, options) {\n    return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {\n        var startTime, dispatched;\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    emitter.emit('dispatch_start', ctx);\n                    startTime = Date.now();\n                    if (!queue.isEmpty()) return [3 /*break*/, 2];\n                    return [4 /*yield*/, queue.dispatchSingle(ctx)];\n                case 1:\n                    dispatched = _a.sent();\n                    return [3 /*break*/, 4];\n                case 2: return [4 /*yield*/, queue.dispatch(ctx)];\n                case 3:\n                    dispatched = _a.sent();\n                    _a.label = 4;\n                case 4:\n                    if (!(options === null || options === void 0 ? void 0 : options.callback)) return [3 /*break*/, 6];\n                    return [4 /*yield*/, (0,_callback__WEBPACK_IMPORTED_MODULE_1__.invokeCallback)(dispatched, options.callback, getDelay(startTime, options.timeout))];\n                case 5:\n                    dispatched = _a.sent();\n                    _a.label = 6;\n                case 6:\n                    if (options === null || options === void 0 ? void 0 : options.debug) {\n                        dispatched.flush();\n                    }\n                    return [2 /*return*/, dispatched];\n            }\n        });\n    });\n}\n//# sourceMappingURL=dispatch.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUvZGlzdC9lc20vYW5hbHl0aWNzL2Rpc3BhdGNoLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBK0M7QUFDRjtBQUM3QztBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUCxXQUFXLGdEQUFTO0FBQ3BCO0FBQ0EsZUFBZSxrREFBVztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMseURBQWM7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBIiwic291cmNlcyI6WyIvVXNlcnMvYXBwbGUvRGVza3RvcC9BZWxmIFByb2plY3RzL2FlbGYtY29kZS1nZW5lcmF0b3Ivbm9kZV9tb2R1bGVzL0BzZWdtZW50L2FuYWx5dGljcy1jb3JlL2Rpc3QvZXNtL2FuYWx5dGljcy9kaXNwYXRjaC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBfX2F3YWl0ZXIsIF9fZ2VuZXJhdG9yIH0gZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBpbnZva2VDYWxsYmFjayB9IGZyb20gJy4uL2NhbGxiYWNrJztcbi8qIFRoZSBhbW91bnQgb2YgdGltZSBpbiBtcyB0byB3YWl0IGJlZm9yZSBpbnZva2luZyB0aGUgY2FsbGJhY2suICovXG5leHBvcnQgdmFyIGdldERlbGF5ID0gZnVuY3Rpb24gKHN0YXJ0VGltZUluRXBvY2hNUywgdGltZW91dEluTVMpIHtcbiAgICB2YXIgZWxhcHNlZFRpbWUgPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lSW5FcG9jaE1TO1xuICAgIC8vIGluY3JlYXNpbmcgdGhlIHRpbWVvdXQgaW5jcmVhc2VzIHRoZSBkZWxheSBieSBhbG1vc3QgdGhlIHNhbWUgYW1vdW50IC0tIHRoaXMgaXMgd2VpcmQgbGVnYWN5IGJlaGF2aW9yLlxuICAgIHJldHVybiBNYXRoLm1heCgodGltZW91dEluTVMgIT09IG51bGwgJiYgdGltZW91dEluTVMgIT09IHZvaWQgMCA/IHRpbWVvdXRJbk1TIDogMzAwKSAtIGVsYXBzZWRUaW1lLCAwKTtcbn07XG4vKipcbiAqIFB1c2ggYW4gZXZlbnQgaW50byB0aGUgZGlzcGF0Y2ggcXVldWUgYW5kIGludm9rZSBhbnkgY2FsbGJhY2tzLlxuICpcbiAqIEBwYXJhbSBldmVudCAtIFNlZ21lbnQgZXZlbnQgdG8gZW5xdWV1ZS5cbiAqIEBwYXJhbSBxdWV1ZSAtIFF1ZXVlIHRvIGRpc3BhdGNoIGFnYWluc3QuXG4gKiBAcGFyYW0gZW1pdHRlciAtIFRoaXMgaXMgdHlwaWNhbGx5IGFuIGluc3RhbmNlIG9mIFwiQW5hbHl0aWNzXCIgLS0gdXNlZCBmb3IgbWV0cmljcyAvIHByb2dyZXNzIGluZm9ybWF0aW9uLlxuICogQHBhcmFtIG9wdGlvbnNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRpc3BhdGNoKGN0eCwgcXVldWUsIGVtaXR0ZXIsIG9wdGlvbnMpIHtcbiAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzdGFydFRpbWUsIGRpc3BhdGNoZWQ7XG4gICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgIGVtaXR0ZXIuZW1pdCgnZGlzcGF0Y2hfc3RhcnQnLCBjdHgpO1xuICAgICAgICAgICAgICAgICAgICBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXF1ZXVlLmlzRW1wdHkoKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHF1ZXVlLmRpc3BhdGNoU2luZ2xlKGN0eCldO1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hlZCA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gWzQgLyp5aWVsZCovLCBxdWV1ZS5kaXNwYXRjaChjdHgpXTtcbiAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoZWQgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gNDtcbiAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgIGlmICghKG9wdGlvbnMgPT09IG51bGwgfHwgb3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogb3B0aW9ucy5jYWxsYmFjaykpIHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBpbnZva2VDYWxsYmFjayhkaXNwYXRjaGVkLCBvcHRpb25zLmNhbGxiYWNrLCBnZXREZWxheShzdGFydFRpbWUsIG9wdGlvbnMudGltZW91dCkpXTtcbiAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoZWQgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gNjtcbiAgICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zID09PSBudWxsIHx8IG9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9wdGlvbnMuZGVidWcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoZWQuZmx1c2goKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgZGlzcGF0Y2hlZF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGlzcGF0Y2guanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-core/dist/esm/analytics/dispatch.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-core/dist/esm/callback/index.js":
/*!*************************************************************************!*\
  !*** ./node_modules/@segment/analytics-core/dist/esm/callback/index.js ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   invokeCallback: () => (/* binding */ invokeCallback),\n/* harmony export */   pTimeout: () => (/* binding */ pTimeout),\n/* harmony export */   sleep: () => (/* binding */ sleep)\n/* harmony export */ });\nfunction pTimeout(promise, timeout) {\n    return new Promise(function (resolve, reject) {\n        var timeoutId = setTimeout(function () {\n            reject(Error('Promise timed out'));\n        }, timeout);\n        promise\n            .then(function (val) {\n            clearTimeout(timeoutId);\n            return resolve(val);\n        })\n            .catch(reject);\n    });\n}\nfunction sleep(timeoutInMs) {\n    return new Promise(function (resolve) { return setTimeout(resolve, timeoutInMs); });\n}\n/**\n * @param ctx\n * @param callback - the function to invoke\n * @param delay - aka \"timeout\". The amount of time in ms to wait before invoking the callback.\n */\nfunction invokeCallback(ctx, callback, delay) {\n    var cb = function () {\n        try {\n            return Promise.resolve(callback(ctx));\n        }\n        catch (err) {\n            return Promise.reject(err);\n        }\n    };\n    return (sleep(delay)\n        // pTimeout ensures that the callback can't cause the context to hang\n        .then(function () { return pTimeout(cb(), 1000); })\n        .catch(function (err) {\n        ctx === null || ctx === void 0 ? void 0 : ctx.log('warn', 'Callback Error', { error: err });\n        ctx === null || ctx === void 0 ? void 0 : ctx.stats.increment('callback_error');\n    })\n        .then(function () { return ctx; }));\n}\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUvZGlzdC9lc20vY2FsbGJhY2svaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0w7QUFDTztBQUNQLDRDQUE0QywwQ0FBMEM7QUFDdEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0Qiw4QkFBOEI7QUFDMUQ7QUFDQSxzRkFBc0YsWUFBWTtBQUNsRztBQUNBLEtBQUs7QUFDTCw0QkFBNEIsYUFBYTtBQUN6QztBQUNBIiwic291cmNlcyI6WyIvVXNlcnMvYXBwbGUvRGVza3RvcC9BZWxmIFByb2plY3RzL2FlbGYtY29kZS1nZW5lcmF0b3Ivbm9kZV9tb2R1bGVzL0BzZWdtZW50L2FuYWx5dGljcy1jb3JlL2Rpc3QvZXNtL2NhbGxiYWNrL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBmdW5jdGlvbiBwVGltZW91dChwcm9taXNlLCB0aW1lb3V0KSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdmFyIHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmVqZWN0KEVycm9yKCdQcm9taXNlIHRpbWVkIG91dCcpKTtcbiAgICAgICAgfSwgdGltZW91dCk7XG4gICAgICAgIHByb21pc2VcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUodmFsKTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChyZWplY3QpO1xuICAgIH0pO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHNsZWVwKHRpbWVvdXRJbk1zKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJldHVybiBzZXRUaW1lb3V0KHJlc29sdmUsIHRpbWVvdXRJbk1zKTsgfSk7XG59XG4vKipcbiAqIEBwYXJhbSBjdHhcbiAqIEBwYXJhbSBjYWxsYmFjayAtIHRoZSBmdW5jdGlvbiB0byBpbnZva2VcbiAqIEBwYXJhbSBkZWxheSAtIGFrYSBcInRpbWVvdXRcIi4gVGhlIGFtb3VudCBvZiB0aW1lIGluIG1zIHRvIHdhaXQgYmVmb3JlIGludm9raW5nIHRoZSBjYWxsYmFjay5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGludm9rZUNhbGxiYWNrKGN0eCwgY2FsbGJhY2ssIGRlbGF5KSB7XG4gICAgdmFyIGNiID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShjYWxsYmFjayhjdHgpKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIChzbGVlcChkZWxheSlcbiAgICAgICAgLy8gcFRpbWVvdXQgZW5zdXJlcyB0aGF0IHRoZSBjYWxsYmFjayBjYW4ndCBjYXVzZSB0aGUgY29udGV4dCB0byBoYW5nXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIHBUaW1lb3V0KGNiKCksIDEwMDApOyB9KVxuICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuICAgICAgICBjdHggPT09IG51bGwgfHwgY3R4ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjdHgubG9nKCd3YXJuJywgJ0NhbGxiYWNrIEVycm9yJywgeyBlcnJvcjogZXJyIH0pO1xuICAgICAgICBjdHggPT09IG51bGwgfHwgY3R4ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjdHguc3RhdHMuaW5jcmVtZW50KCdjYWxsYmFja19lcnJvcicpO1xuICAgIH0pXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIGN0eDsgfSkpO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-core/dist/esm/callback/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-core/dist/esm/context/index.js":
/*!************************************************************************!*\
  !*** ./node_modules/@segment/analytics-core/dist/esm/context/index.js ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ContextCancelation: () => (/* binding */ ContextCancelation),\n/* harmony export */   CoreContext: () => (/* binding */ CoreContext)\n/* harmony export */ });\n/* harmony import */ var _lukeed_uuid__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @lukeed/uuid */ \"(ssr)/./node_modules/@lukeed/uuid/dist/index.mjs\");\n/* harmony import */ var dset__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! dset */ \"(ssr)/./node_modules/dset/dist/index.mjs\");\n/* harmony import */ var _logger__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../logger */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/logger/index.js\");\n/* harmony import */ var _stats__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../stats */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/stats/index.js\");\n\n\n\n\nvar ContextCancelation = /** @class */ (function () {\n    function ContextCancelation(options) {\n        var _a, _b, _c;\n        this.retry = (_a = options.retry) !== null && _a !== void 0 ? _a : true;\n        this.type = (_b = options.type) !== null && _b !== void 0 ? _b : 'plugin Error';\n        this.reason = (_c = options.reason) !== null && _c !== void 0 ? _c : '';\n    }\n    return ContextCancelation;\n}());\n\nvar CoreContext = /** @class */ (function () {\n    function CoreContext(event, id, stats, logger) {\n        if (id === void 0) { id = (0,_lukeed_uuid__WEBPACK_IMPORTED_MODULE_0__.v4)(); }\n        if (stats === void 0) { stats = new _stats__WEBPACK_IMPORTED_MODULE_2__.NullStats(); }\n        if (logger === void 0) { logger = new _logger__WEBPACK_IMPORTED_MODULE_3__.CoreLogger(); }\n        this.attempts = 0;\n        this.event = event;\n        this._id = id;\n        this.logger = logger;\n        this.stats = stats;\n    }\n    CoreContext.system = function () {\n        // This should be overridden by the subclass to return an instance of the subclass.\n    };\n    CoreContext.prototype.isSame = function (other) {\n        return other.id === this.id;\n    };\n    CoreContext.prototype.cancel = function (error) {\n        if (error) {\n            throw error;\n        }\n        throw new ContextCancelation({ reason: 'Context Cancel' });\n    };\n    CoreContext.prototype.log = function (level, message, extras) {\n        this.logger.log(level, message, extras);\n    };\n    Object.defineProperty(CoreContext.prototype, \"id\", {\n        get: function () {\n            return this._id;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    CoreContext.prototype.updateEvent = function (path, val) {\n        var _a;\n        // Don't allow integrations that are set to false to be overwritten with integration settings.\n        if (path.split('.')[0] === 'integrations') {\n            var integrationName = path.split('.')[1];\n            if (((_a = this.event.integrations) === null || _a === void 0 ? void 0 : _a[integrationName]) === false) {\n                return this.event;\n            }\n        }\n        (0,dset__WEBPACK_IMPORTED_MODULE_1__.dset)(this.event, path, val);\n        return this.event;\n    };\n    CoreContext.prototype.failedDelivery = function () {\n        return this._failedDelivery;\n    };\n    CoreContext.prototype.setFailedDelivery = function (options) {\n        this._failedDelivery = options;\n    };\n    CoreContext.prototype.logs = function () {\n        return this.logger.logs;\n    };\n    CoreContext.prototype.flush = function () {\n        this.logger.flush();\n        this.stats.flush();\n    };\n    CoreContext.prototype.toJSON = function () {\n        return {\n            id: this._id,\n            event: this.event,\n            logs: this.logger.logs,\n            metrics: this.stats.metrics,\n        };\n    };\n    return CoreContext;\n}());\n\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUvZGlzdC9lc20vY29udGV4dC9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBMEM7QUFDZDtBQUNXO0FBQ0Y7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDNkI7QUFDOUI7QUFDQTtBQUNBLDZCQUE2QixLQUFLLGdEQUFJO0FBQ3RDLGdDQUFnQyxZQUFZLDZDQUFTO0FBQ3JELGlDQUFpQyxhQUFhLCtDQUFVO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLDBCQUEwQjtBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsMENBQUk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ3NCO0FBQ3ZCIiwic291cmNlcyI6WyIvVXNlcnMvYXBwbGUvRGVza3RvcC9BZWxmIFByb2plY3RzL2FlbGYtY29kZS1nZW5lcmF0b3Ivbm9kZV9tb2R1bGVzL0BzZWdtZW50L2FuYWx5dGljcy1jb3JlL2Rpc3QvZXNtL2NvbnRleHQvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdjQgYXMgdXVpZCB9IGZyb20gJ0BsdWtlZWQvdXVpZCc7XG5pbXBvcnQgeyBkc2V0IH0gZnJvbSAnZHNldCc7XG5pbXBvcnQgeyBDb3JlTG9nZ2VyIH0gZnJvbSAnLi4vbG9nZ2VyJztcbmltcG9ydCB7IE51bGxTdGF0cyB9IGZyb20gJy4uL3N0YXRzJztcbnZhciBDb250ZXh0Q2FuY2VsYXRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ29udGV4dENhbmNlbGF0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgICAgIHRoaXMucmV0cnkgPSAoX2EgPSBvcHRpb25zLnJldHJ5KSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiB0cnVlO1xuICAgICAgICB0aGlzLnR5cGUgPSAoX2IgPSBvcHRpb25zLnR5cGUpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6ICdwbHVnaW4gRXJyb3InO1xuICAgICAgICB0aGlzLnJlYXNvbiA9IChfYyA9IG9wdGlvbnMucmVhc29uKSAhPT0gbnVsbCAmJiBfYyAhPT0gdm9pZCAwID8gX2MgOiAnJztcbiAgICB9XG4gICAgcmV0dXJuIENvbnRleHRDYW5jZWxhdGlvbjtcbn0oKSk7XG5leHBvcnQgeyBDb250ZXh0Q2FuY2VsYXRpb24gfTtcbnZhciBDb3JlQ29udGV4dCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDb3JlQ29udGV4dChldmVudCwgaWQsIHN0YXRzLCBsb2dnZXIpIHtcbiAgICAgICAgaWYgKGlkID09PSB2b2lkIDApIHsgaWQgPSB1dWlkKCk7IH1cbiAgICAgICAgaWYgKHN0YXRzID09PSB2b2lkIDApIHsgc3RhdHMgPSBuZXcgTnVsbFN0YXRzKCk7IH1cbiAgICAgICAgaWYgKGxvZ2dlciA9PT0gdm9pZCAwKSB7IGxvZ2dlciA9IG5ldyBDb3JlTG9nZ2VyKCk7IH1cbiAgICAgICAgdGhpcy5hdHRlbXB0cyA9IDA7XG4gICAgICAgIHRoaXMuZXZlbnQgPSBldmVudDtcbiAgICAgICAgdGhpcy5faWQgPSBpZDtcbiAgICAgICAgdGhpcy5sb2dnZXIgPSBsb2dnZXI7XG4gICAgICAgIHRoaXMuc3RhdHMgPSBzdGF0cztcbiAgICB9XG4gICAgQ29yZUNvbnRleHQuc3lzdGVtID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBUaGlzIHNob3VsZCBiZSBvdmVycmlkZGVuIGJ5IHRoZSBzdWJjbGFzcyB0byByZXR1cm4gYW4gaW5zdGFuY2Ugb2YgdGhlIHN1YmNsYXNzLlxuICAgIH07XG4gICAgQ29yZUNvbnRleHQucHJvdG90eXBlLmlzU2FtZSA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgICAgICByZXR1cm4gb3RoZXIuaWQgPT09IHRoaXMuaWQ7XG4gICAgfTtcbiAgICBDb3JlQ29udGV4dC5wcm90b3R5cGUuY2FuY2VsID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IENvbnRleHRDYW5jZWxhdGlvbih7IHJlYXNvbjogJ0NvbnRleHQgQ2FuY2VsJyB9KTtcbiAgICB9O1xuICAgIENvcmVDb250ZXh0LnByb3RvdHlwZS5sb2cgPSBmdW5jdGlvbiAobGV2ZWwsIG1lc3NhZ2UsIGV4dHJhcykge1xuICAgICAgICB0aGlzLmxvZ2dlci5sb2cobGV2ZWwsIG1lc3NhZ2UsIGV4dHJhcyk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29yZUNvbnRleHQucHJvdG90eXBlLCBcImlkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBDb3JlQ29udGV4dC5wcm90b3R5cGUudXBkYXRlRXZlbnQgPSBmdW5jdGlvbiAocGF0aCwgdmFsKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgLy8gRG9uJ3QgYWxsb3cgaW50ZWdyYXRpb25zIHRoYXQgYXJlIHNldCB0byBmYWxzZSB0byBiZSBvdmVyd3JpdHRlbiB3aXRoIGludGVncmF0aW9uIHNldHRpbmdzLlxuICAgICAgICBpZiAocGF0aC5zcGxpdCgnLicpWzBdID09PSAnaW50ZWdyYXRpb25zJykge1xuICAgICAgICAgICAgdmFyIGludGVncmF0aW9uTmFtZSA9IHBhdGguc3BsaXQoJy4nKVsxXTtcbiAgICAgICAgICAgIGlmICgoKF9hID0gdGhpcy5ldmVudC5pbnRlZ3JhdGlvbnMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYVtpbnRlZ3JhdGlvbk5hbWVdKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5ldmVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBkc2V0KHRoaXMuZXZlbnQsIHBhdGgsIHZhbCk7XG4gICAgICAgIHJldHVybiB0aGlzLmV2ZW50O1xuICAgIH07XG4gICAgQ29yZUNvbnRleHQucHJvdG90eXBlLmZhaWxlZERlbGl2ZXJ5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZmFpbGVkRGVsaXZlcnk7XG4gICAgfTtcbiAgICBDb3JlQ29udGV4dC5wcm90b3R5cGUuc2V0RmFpbGVkRGVsaXZlcnkgPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgICAgICB0aGlzLl9mYWlsZWREZWxpdmVyeSA9IG9wdGlvbnM7XG4gICAgfTtcbiAgICBDb3JlQ29udGV4dC5wcm90b3R5cGUubG9ncyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9nZ2VyLmxvZ3M7XG4gICAgfTtcbiAgICBDb3JlQ29udGV4dC5wcm90b3R5cGUuZmx1c2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubG9nZ2VyLmZsdXNoKCk7XG4gICAgICAgIHRoaXMuc3RhdHMuZmx1c2goKTtcbiAgICB9O1xuICAgIENvcmVDb250ZXh0LnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZDogdGhpcy5faWQsXG4gICAgICAgICAgICBldmVudDogdGhpcy5ldmVudCxcbiAgICAgICAgICAgIGxvZ3M6IHRoaXMubG9nZ2VyLmxvZ3MsXG4gICAgICAgICAgICBtZXRyaWNzOiB0aGlzLnN0YXRzLm1ldHJpY3MsXG4gICAgICAgIH07XG4gICAgfTtcbiAgICByZXR1cm4gQ29yZUNvbnRleHQ7XG59KCkpO1xuZXhwb3J0IHsgQ29yZUNvbnRleHQgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-core/dist/esm/context/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-core/dist/esm/events/index.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@segment/analytics-core/dist/esm/events/index.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CoreEventFactory: () => (/* binding */ CoreEventFactory)\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! tslib */ \"(ssr)/./node_modules/tslib/tslib.es6.mjs\");\n/* harmony import */ var dset__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! dset */ \"(ssr)/./node_modules/dset/dist/index.mjs\");\n/* harmony import */ var _utils_pick__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/pick */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/utils/pick.js\");\n/* harmony import */ var _validation_assertions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../validation/assertions */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/validation/assertions.js\");\n\n\n\n\n\n/**\n * Internal settings object that is used internally by the factory\n */\nvar InternalEventFactorySettings = /** @class */ (function () {\n    function InternalEventFactorySettings(settings) {\n        var _a, _b;\n        this.settings = settings;\n        this.createMessageId = settings.createMessageId;\n        this.onEventMethodCall = (_a = settings.onEventMethodCall) !== null && _a !== void 0 ? _a : (function () { });\n        this.onFinishedEvent = (_b = settings.onFinishedEvent) !== null && _b !== void 0 ? _b : (function () { });\n    }\n    return InternalEventFactorySettings;\n}());\nvar CoreEventFactory = /** @class */ (function () {\n    function CoreEventFactory(settings) {\n        this.settings = new InternalEventFactorySettings(settings);\n    }\n    CoreEventFactory.prototype.track = function (event, properties, options, globalIntegrations) {\n        this.settings.onEventMethodCall({ type: 'track', options: options });\n        return this.normalize((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, this.baseEvent()), { event: event, type: 'track', properties: properties !== null && properties !== void 0 ? properties : {}, options: (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, options), integrations: (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, globalIntegrations) }));\n    };\n    CoreEventFactory.prototype.page = function (category, page, properties, options, globalIntegrations) {\n        var _a;\n        this.settings.onEventMethodCall({ type: 'page', options: options });\n        var event = {\n            type: 'page',\n            properties: (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, properties),\n            options: (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, options),\n            integrations: (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, globalIntegrations),\n        };\n        if (category !== null) {\n            event.category = category;\n            event.properties = (_a = event.properties) !== null && _a !== void 0 ? _a : {};\n            event.properties.category = category;\n        }\n        if (page !== null) {\n            event.name = page;\n        }\n        return this.normalize((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, this.baseEvent()), event));\n    };\n    CoreEventFactory.prototype.screen = function (category, screen, properties, options, globalIntegrations) {\n        this.settings.onEventMethodCall({ type: 'screen', options: options });\n        var event = {\n            type: 'screen',\n            properties: (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, properties),\n            options: (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, options),\n            integrations: (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, globalIntegrations),\n        };\n        if (category !== null) {\n            event.category = category;\n        }\n        if (screen !== null) {\n            event.name = screen;\n        }\n        return this.normalize((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, this.baseEvent()), event));\n    };\n    CoreEventFactory.prototype.identify = function (userId, traits, options, globalIntegrations) {\n        this.settings.onEventMethodCall({ type: 'identify', options: options });\n        return this.normalize((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, this.baseEvent()), { type: 'identify', userId: userId, traits: traits !== null && traits !== void 0 ? traits : {}, options: (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, options), integrations: globalIntegrations }));\n    };\n    CoreEventFactory.prototype.group = function (groupId, traits, options, globalIntegrations) {\n        this.settings.onEventMethodCall({ type: 'group', options: options });\n        return this.normalize((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, this.baseEvent()), { type: 'group', traits: traits !== null && traits !== void 0 ? traits : {}, options: (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, options), integrations: (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, globalIntegrations), //\n            groupId: groupId }));\n    };\n    CoreEventFactory.prototype.alias = function (to, from, // TODO: can we make this undefined?\n    options, globalIntegrations) {\n        this.settings.onEventMethodCall({ type: 'alias', options: options });\n        var base = {\n            userId: to,\n            type: 'alias',\n            options: (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, options),\n            integrations: (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, globalIntegrations),\n        };\n        if (from !== null) {\n            base.previousId = from;\n        }\n        if (to === undefined) {\n            return this.normalize((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, base), this.baseEvent()));\n        }\n        return this.normalize((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, this.baseEvent()), base));\n    };\n    CoreEventFactory.prototype.baseEvent = function () {\n        return {\n            integrations: {},\n            options: {},\n        };\n    };\n    /**\n     * Builds the context part of an event based on \"foreign\" keys that\n     * are provided in the `Options` parameter for an Event\n     */\n    CoreEventFactory.prototype.context = function (options) {\n        var _a;\n        /**\n         * If the event options are known keys from this list, we move them to the top level of the event.\n         * Any other options are moved to context.\n         */\n        var eventOverrideKeys = [\n            'userId',\n            'anonymousId',\n            'timestamp',\n            'messageId',\n        ];\n        delete options['integrations'];\n        var providedOptionsKeys = Object.keys(options);\n        var context = (_a = options.context) !== null && _a !== void 0 ? _a : {};\n        var eventOverrides = {};\n        providedOptionsKeys.forEach(function (key) {\n            if (key === 'context') {\n                return;\n            }\n            if (eventOverrideKeys.includes(key)) {\n                (0,dset__WEBPACK_IMPORTED_MODULE_0__.dset)(eventOverrides, key, options[key]);\n            }\n            else {\n                (0,dset__WEBPACK_IMPORTED_MODULE_0__.dset)(context, key, options[key]);\n            }\n        });\n        return [context, eventOverrides];\n    };\n    CoreEventFactory.prototype.normalize = function (event) {\n        var _a, _b;\n        var integrationBooleans = Object.keys((_a = event.integrations) !== null && _a !== void 0 ? _a : {}).reduce(function (integrationNames, name) {\n            var _a;\n            var _b;\n            return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, integrationNames), (_a = {}, _a[name] = Boolean((_b = event.integrations) === null || _b === void 0 ? void 0 : _b[name]), _a));\n        }, {});\n        // filter out any undefined options\n        event.options = (0,_utils_pick__WEBPACK_IMPORTED_MODULE_2__.pickBy)(event.options || {}, function (_, value) {\n            return value !== undefined;\n        });\n        // This is pretty trippy, but here's what's going on:\n        // - a) We don't pass initial integration options as part of the event, only if they're true or false\n        // - b) We do accept per integration overrides (like integrations.Amplitude.sessionId) at the event level\n        // Hence the need to convert base integration options to booleans, but maintain per event integration overrides\n        var allIntegrations = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, integrationBooleans), (_b = event.options) === null || _b === void 0 ? void 0 : _b.integrations);\n        var _c = event.options\n            ? this.context(event.options)\n            : [], context = _c[0], overrides = _c[1];\n        var options = event.options, rest = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__rest)(event, [\"options\"]);\n        var evt = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({ timestamp: new Date() }, rest), { context: context, integrations: allIntegrations }), overrides), { messageId: options.messageId || this.settings.createMessageId() });\n        this.settings.onFinishedEvent(evt);\n        (0,_validation_assertions__WEBPACK_IMPORTED_MODULE_3__.validateEvent)(evt);\n        return evt;\n    };\n    return CoreEventFactory;\n}());\n\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUvZGlzdC9lc20vZXZlbnRzL2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQXlDO0FBQ1o7QUFDRDtBQUNXO0FBQ2tCO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvSEFBb0g7QUFDcEgsZ0hBQWdIO0FBQ2hIO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxpQ0FBaUM7QUFDM0UsOEJBQThCLCtDQUFRLENBQUMsK0NBQVEsR0FBRyx1QkFBdUIsdUdBQXVHLFdBQVcsK0NBQVEsR0FBRywwQkFBMEIsK0NBQVEsR0FBRyx1QkFBdUI7QUFDbFE7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLGdDQUFnQztBQUMxRTtBQUNBO0FBQ0Esd0JBQXdCLCtDQUFRLEdBQUc7QUFDbkMscUJBQXFCLCtDQUFRLEdBQUc7QUFDaEMsMEJBQTBCLCtDQUFRLEdBQUc7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLCtDQUFRLENBQUMsK0NBQVEsR0FBRztBQUNsRDtBQUNBO0FBQ0EsMENBQTBDLGtDQUFrQztBQUM1RTtBQUNBO0FBQ0Esd0JBQXdCLCtDQUFRLEdBQUc7QUFDbkMscUJBQXFCLCtDQUFRLEdBQUc7QUFDaEMsMEJBQTBCLCtDQUFRLEdBQUc7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsK0NBQVEsQ0FBQywrQ0FBUSxHQUFHO0FBQ2xEO0FBQ0E7QUFDQSwwQ0FBMEMsb0NBQW9DO0FBQzlFLDhCQUE4QiwrQ0FBUSxDQUFDLCtDQUFRLEdBQUcsdUJBQXVCLDRGQUE0RixXQUFXLCtDQUFRLEdBQUcsOENBQThDO0FBQ3pPO0FBQ0E7QUFDQSwwQ0FBMEMsaUNBQWlDO0FBQzNFLDhCQUE4QiwrQ0FBUSxDQUFDLCtDQUFRLEdBQUcsdUJBQXVCLHlFQUF5RSxXQUFXLCtDQUFRLEdBQUcsMEJBQTBCLCtDQUFRLEdBQUc7QUFDN00sOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxpQ0FBaUM7QUFDM0U7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLCtDQUFRLEdBQUc7QUFDaEMsMEJBQTBCLCtDQUFRLEdBQUc7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQywrQ0FBUSxDQUFDLCtDQUFRLEdBQUc7QUFDdEQ7QUFDQSw4QkFBOEIsK0NBQVEsQ0FBQywrQ0FBUSxHQUFHO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QjtBQUM1Qix1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLDBDQUFJO0FBQ3BCO0FBQ0E7QUFDQSxnQkFBZ0IsMENBQUk7QUFDcEI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyR0FBMkc7QUFDM0c7QUFDQTtBQUNBLG1CQUFtQiwrQ0FBUSxDQUFDLCtDQUFRLEdBQUcsNkJBQTZCO0FBQ3BFLFNBQVMsSUFBSTtBQUNiO0FBQ0Esd0JBQXdCLG1EQUFNLG9CQUFvQjtBQUNsRDtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QiwrQ0FBUSxDQUFDLCtDQUFRLEdBQUc7QUFDbEQ7QUFDQTtBQUNBO0FBQ0EsNENBQTRDLDZDQUFNO0FBQ2xELGtCQUFrQiwrQ0FBUSxDQUFDLCtDQUFRLENBQUMsK0NBQVEsQ0FBQywrQ0FBUSxHQUFHLHVCQUF1QixXQUFXLGlEQUFpRCxpQkFBaUIsaUVBQWlFO0FBQzdOO0FBQ0EsUUFBUSxxRUFBYTtBQUNyQjtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQzJCO0FBQzVCIiwic291cmNlcyI6WyIvVXNlcnMvYXBwbGUvRGVza3RvcC9BZWxmIFByb2plY3RzL2FlbGYtY29kZS1nZW5lcmF0b3Ivbm9kZV9tb2R1bGVzL0BzZWdtZW50L2FuYWx5dGljcy1jb3JlL2Rpc3QvZXNtL2V2ZW50cy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBfX2Fzc2lnbiwgX19yZXN0IH0gZnJvbSBcInRzbGliXCI7XG5leHBvcnQgKiBmcm9tICcuL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgZHNldCB9IGZyb20gJ2RzZXQnO1xuaW1wb3J0IHsgcGlja0J5IH0gZnJvbSAnLi4vdXRpbHMvcGljayc7XG5pbXBvcnQgeyB2YWxpZGF0ZUV2ZW50IH0gZnJvbSAnLi4vdmFsaWRhdGlvbi9hc3NlcnRpb25zJztcbi8qKlxuICogSW50ZXJuYWwgc2V0dGluZ3Mgb2JqZWN0IHRoYXQgaXMgdXNlZCBpbnRlcm5hbGx5IGJ5IHRoZSBmYWN0b3J5XG4gKi9cbnZhciBJbnRlcm5hbEV2ZW50RmFjdG9yeVNldHRpbmdzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEludGVybmFsRXZlbnRGYWN0b3J5U2V0dGluZ3Moc2V0dGluZ3MpIHtcbiAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgICAgICB0aGlzLmNyZWF0ZU1lc3NhZ2VJZCA9IHNldHRpbmdzLmNyZWF0ZU1lc3NhZ2VJZDtcbiAgICAgICAgdGhpcy5vbkV2ZW50TWV0aG9kQ2FsbCA9IChfYSA9IHNldHRpbmdzLm9uRXZlbnRNZXRob2RDYWxsKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiAoZnVuY3Rpb24gKCkgeyB9KTtcbiAgICAgICAgdGhpcy5vbkZpbmlzaGVkRXZlbnQgPSAoX2IgPSBzZXR0aW5ncy5vbkZpbmlzaGVkRXZlbnQpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IChmdW5jdGlvbiAoKSB7IH0pO1xuICAgIH1cbiAgICByZXR1cm4gSW50ZXJuYWxFdmVudEZhY3RvcnlTZXR0aW5ncztcbn0oKSk7XG52YXIgQ29yZUV2ZW50RmFjdG9yeSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDb3JlRXZlbnRGYWN0b3J5KHNldHRpbmdzKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBuZXcgSW50ZXJuYWxFdmVudEZhY3RvcnlTZXR0aW5ncyhzZXR0aW5ncyk7XG4gICAgfVxuICAgIENvcmVFdmVudEZhY3RvcnkucHJvdG90eXBlLnRyYWNrID0gZnVuY3Rpb24gKGV2ZW50LCBwcm9wZXJ0aWVzLCBvcHRpb25zLCBnbG9iYWxJbnRlZ3JhdGlvbnMpIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncy5vbkV2ZW50TWV0aG9kQ2FsbCh7IHR5cGU6ICd0cmFjaycsIG9wdGlvbnM6IG9wdGlvbnMgfSk7XG4gICAgICAgIHJldHVybiB0aGlzLm5vcm1hbGl6ZShfX2Fzc2lnbihfX2Fzc2lnbih7fSwgdGhpcy5iYXNlRXZlbnQoKSksIHsgZXZlbnQ6IGV2ZW50LCB0eXBlOiAndHJhY2snLCBwcm9wZXJ0aWVzOiBwcm9wZXJ0aWVzICE9PSBudWxsICYmIHByb3BlcnRpZXMgIT09IHZvaWQgMCA/IHByb3BlcnRpZXMgOiB7fSwgb3B0aW9uczogX19hc3NpZ24oe30sIG9wdGlvbnMpLCBpbnRlZ3JhdGlvbnM6IF9fYXNzaWduKHt9LCBnbG9iYWxJbnRlZ3JhdGlvbnMpIH0pKTtcbiAgICB9O1xuICAgIENvcmVFdmVudEZhY3RvcnkucHJvdG90eXBlLnBhZ2UgPSBmdW5jdGlvbiAoY2F0ZWdvcnksIHBhZ2UsIHByb3BlcnRpZXMsIG9wdGlvbnMsIGdsb2JhbEludGVncmF0aW9ucykge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHRoaXMuc2V0dGluZ3Mub25FdmVudE1ldGhvZENhbGwoeyB0eXBlOiAncGFnZScsIG9wdGlvbnM6IG9wdGlvbnMgfSk7XG4gICAgICAgIHZhciBldmVudCA9IHtcbiAgICAgICAgICAgIHR5cGU6ICdwYWdlJyxcbiAgICAgICAgICAgIHByb3BlcnRpZXM6IF9fYXNzaWduKHt9LCBwcm9wZXJ0aWVzKSxcbiAgICAgICAgICAgIG9wdGlvbnM6IF9fYXNzaWduKHt9LCBvcHRpb25zKSxcbiAgICAgICAgICAgIGludGVncmF0aW9uczogX19hc3NpZ24oe30sIGdsb2JhbEludGVncmF0aW9ucyksXG4gICAgICAgIH07XG4gICAgICAgIGlmIChjYXRlZ29yeSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgZXZlbnQuY2F0ZWdvcnkgPSBjYXRlZ29yeTtcbiAgICAgICAgICAgIGV2ZW50LnByb3BlcnRpZXMgPSAoX2EgPSBldmVudC5wcm9wZXJ0aWVzKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiB7fTtcbiAgICAgICAgICAgIGV2ZW50LnByb3BlcnRpZXMuY2F0ZWdvcnkgPSBjYXRlZ29yeTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFnZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgZXZlbnQubmFtZSA9IHBhZ2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMubm9ybWFsaXplKF9fYXNzaWduKF9fYXNzaWduKHt9LCB0aGlzLmJhc2VFdmVudCgpKSwgZXZlbnQpKTtcbiAgICB9O1xuICAgIENvcmVFdmVudEZhY3RvcnkucHJvdG90eXBlLnNjcmVlbiA9IGZ1bmN0aW9uIChjYXRlZ29yeSwgc2NyZWVuLCBwcm9wZXJ0aWVzLCBvcHRpb25zLCBnbG9iYWxJbnRlZ3JhdGlvbnMpIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncy5vbkV2ZW50TWV0aG9kQ2FsbCh7IHR5cGU6ICdzY3JlZW4nLCBvcHRpb25zOiBvcHRpb25zIH0pO1xuICAgICAgICB2YXIgZXZlbnQgPSB7XG4gICAgICAgICAgICB0eXBlOiAnc2NyZWVuJyxcbiAgICAgICAgICAgIHByb3BlcnRpZXM6IF9fYXNzaWduKHt9LCBwcm9wZXJ0aWVzKSxcbiAgICAgICAgICAgIG9wdGlvbnM6IF9fYXNzaWduKHt9LCBvcHRpb25zKSxcbiAgICAgICAgICAgIGludGVncmF0aW9uczogX19hc3NpZ24oe30sIGdsb2JhbEludGVncmF0aW9ucyksXG4gICAgICAgIH07XG4gICAgICAgIGlmIChjYXRlZ29yeSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgZXZlbnQuY2F0ZWdvcnkgPSBjYXRlZ29yeTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2NyZWVuICE9PSBudWxsKSB7XG4gICAgICAgICAgICBldmVudC5uYW1lID0gc2NyZWVuO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLm5vcm1hbGl6ZShfX2Fzc2lnbihfX2Fzc2lnbih7fSwgdGhpcy5iYXNlRXZlbnQoKSksIGV2ZW50KSk7XG4gICAgfTtcbiAgICBDb3JlRXZlbnRGYWN0b3J5LnByb3RvdHlwZS5pZGVudGlmeSA9IGZ1bmN0aW9uICh1c2VySWQsIHRyYWl0cywgb3B0aW9ucywgZ2xvYmFsSW50ZWdyYXRpb25zKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3Mub25FdmVudE1ldGhvZENhbGwoeyB0eXBlOiAnaWRlbnRpZnknLCBvcHRpb25zOiBvcHRpb25zIH0pO1xuICAgICAgICByZXR1cm4gdGhpcy5ub3JtYWxpemUoX19hc3NpZ24oX19hc3NpZ24oe30sIHRoaXMuYmFzZUV2ZW50KCkpLCB7IHR5cGU6ICdpZGVudGlmeScsIHVzZXJJZDogdXNlcklkLCB0cmFpdHM6IHRyYWl0cyAhPT0gbnVsbCAmJiB0cmFpdHMgIT09IHZvaWQgMCA/IHRyYWl0cyA6IHt9LCBvcHRpb25zOiBfX2Fzc2lnbih7fSwgb3B0aW9ucyksIGludGVncmF0aW9uczogZ2xvYmFsSW50ZWdyYXRpb25zIH0pKTtcbiAgICB9O1xuICAgIENvcmVFdmVudEZhY3RvcnkucHJvdG90eXBlLmdyb3VwID0gZnVuY3Rpb24gKGdyb3VwSWQsIHRyYWl0cywgb3B0aW9ucywgZ2xvYmFsSW50ZWdyYXRpb25zKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3Mub25FdmVudE1ldGhvZENhbGwoeyB0eXBlOiAnZ3JvdXAnLCBvcHRpb25zOiBvcHRpb25zIH0pO1xuICAgICAgICByZXR1cm4gdGhpcy5ub3JtYWxpemUoX19hc3NpZ24oX19hc3NpZ24oe30sIHRoaXMuYmFzZUV2ZW50KCkpLCB7IHR5cGU6ICdncm91cCcsIHRyYWl0czogdHJhaXRzICE9PSBudWxsICYmIHRyYWl0cyAhPT0gdm9pZCAwID8gdHJhaXRzIDoge30sIG9wdGlvbnM6IF9fYXNzaWduKHt9LCBvcHRpb25zKSwgaW50ZWdyYXRpb25zOiBfX2Fzc2lnbih7fSwgZ2xvYmFsSW50ZWdyYXRpb25zKSwgLy9cbiAgICAgICAgICAgIGdyb3VwSWQ6IGdyb3VwSWQgfSkpO1xuICAgIH07XG4gICAgQ29yZUV2ZW50RmFjdG9yeS5wcm90b3R5cGUuYWxpYXMgPSBmdW5jdGlvbiAodG8sIGZyb20sIC8vIFRPRE86IGNhbiB3ZSBtYWtlIHRoaXMgdW5kZWZpbmVkP1xuICAgIG9wdGlvbnMsIGdsb2JhbEludGVncmF0aW9ucykge1xuICAgICAgICB0aGlzLnNldHRpbmdzLm9uRXZlbnRNZXRob2RDYWxsKHsgdHlwZTogJ2FsaWFzJywgb3B0aW9uczogb3B0aW9ucyB9KTtcbiAgICAgICAgdmFyIGJhc2UgPSB7XG4gICAgICAgICAgICB1c2VySWQ6IHRvLFxuICAgICAgICAgICAgdHlwZTogJ2FsaWFzJyxcbiAgICAgICAgICAgIG9wdGlvbnM6IF9fYXNzaWduKHt9LCBvcHRpb25zKSxcbiAgICAgICAgICAgIGludGVncmF0aW9uczogX19hc3NpZ24oe30sIGdsb2JhbEludGVncmF0aW9ucyksXG4gICAgICAgIH07XG4gICAgICAgIGlmIChmcm9tICE9PSBudWxsKSB7XG4gICAgICAgICAgICBiYXNlLnByZXZpb3VzSWQgPSBmcm9tO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0byA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ub3JtYWxpemUoX19hc3NpZ24oX19hc3NpZ24oe30sIGJhc2UpLCB0aGlzLmJhc2VFdmVudCgpKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMubm9ybWFsaXplKF9fYXNzaWduKF9fYXNzaWduKHt9LCB0aGlzLmJhc2VFdmVudCgpKSwgYmFzZSkpO1xuICAgIH07XG4gICAgQ29yZUV2ZW50RmFjdG9yeS5wcm90b3R5cGUuYmFzZUV2ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaW50ZWdyYXRpb25zOiB7fSxcbiAgICAgICAgICAgIG9wdGlvbnM6IHt9LFxuICAgICAgICB9O1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQnVpbGRzIHRoZSBjb250ZXh0IHBhcnQgb2YgYW4gZXZlbnQgYmFzZWQgb24gXCJmb3JlaWduXCIga2V5cyB0aGF0XG4gICAgICogYXJlIHByb3ZpZGVkIGluIHRoZSBgT3B0aW9uc2AgcGFyYW1ldGVyIGZvciBhbiBFdmVudFxuICAgICAqL1xuICAgIENvcmVFdmVudEZhY3RvcnkucHJvdG90eXBlLmNvbnRleHQgPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiB0aGUgZXZlbnQgb3B0aW9ucyBhcmUga25vd24ga2V5cyBmcm9tIHRoaXMgbGlzdCwgd2UgbW92ZSB0aGVtIHRvIHRoZSB0b3AgbGV2ZWwgb2YgdGhlIGV2ZW50LlxuICAgICAgICAgKiBBbnkgb3RoZXIgb3B0aW9ucyBhcmUgbW92ZWQgdG8gY29udGV4dC5cbiAgICAgICAgICovXG4gICAgICAgIHZhciBldmVudE92ZXJyaWRlS2V5cyA9IFtcbiAgICAgICAgICAgICd1c2VySWQnLFxuICAgICAgICAgICAgJ2Fub255bW91c0lkJyxcbiAgICAgICAgICAgICd0aW1lc3RhbXAnLFxuICAgICAgICAgICAgJ21lc3NhZ2VJZCcsXG4gICAgICAgIF07XG4gICAgICAgIGRlbGV0ZSBvcHRpb25zWydpbnRlZ3JhdGlvbnMnXTtcbiAgICAgICAgdmFyIHByb3ZpZGVkT3B0aW9uc0tleXMgPSBPYmplY3Qua2V5cyhvcHRpb25zKTtcbiAgICAgICAgdmFyIGNvbnRleHQgPSAoX2EgPSBvcHRpb25zLmNvbnRleHQpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IHt9O1xuICAgICAgICB2YXIgZXZlbnRPdmVycmlkZXMgPSB7fTtcbiAgICAgICAgcHJvdmlkZWRPcHRpb25zS2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICAgIGlmIChrZXkgPT09ICdjb250ZXh0Jykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChldmVudE92ZXJyaWRlS2V5cy5pbmNsdWRlcyhrZXkpKSB7XG4gICAgICAgICAgICAgICAgZHNldChldmVudE92ZXJyaWRlcywga2V5LCBvcHRpb25zW2tleV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZHNldChjb250ZXh0LCBrZXksIG9wdGlvbnNba2V5XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gW2NvbnRleHQsIGV2ZW50T3ZlcnJpZGVzXTtcbiAgICB9O1xuICAgIENvcmVFdmVudEZhY3RvcnkucHJvdG90eXBlLm5vcm1hbGl6ZSA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICB2YXIgaW50ZWdyYXRpb25Cb29sZWFucyA9IE9iamVjdC5rZXlzKChfYSA9IGV2ZW50LmludGVncmF0aW9ucykgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDoge30pLnJlZHVjZShmdW5jdGlvbiAoaW50ZWdyYXRpb25OYW1lcywgbmFtZSkge1xuICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgdmFyIF9iO1xuICAgICAgICAgICAgcmV0dXJuIF9fYXNzaWduKF9fYXNzaWduKHt9LCBpbnRlZ3JhdGlvbk5hbWVzKSwgKF9hID0ge30sIF9hW25hbWVdID0gQm9vbGVhbigoX2IgPSBldmVudC5pbnRlZ3JhdGlvbnMpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYltuYW1lXSksIF9hKSk7XG4gICAgICAgIH0sIHt9KTtcbiAgICAgICAgLy8gZmlsdGVyIG91dCBhbnkgdW5kZWZpbmVkIG9wdGlvbnNcbiAgICAgICAgZXZlbnQub3B0aW9ucyA9IHBpY2tCeShldmVudC5vcHRpb25zIHx8IHt9LCBmdW5jdGlvbiAoXywgdmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZSAhPT0gdW5kZWZpbmVkO1xuICAgICAgICB9KTtcbiAgICAgICAgLy8gVGhpcyBpcyBwcmV0dHkgdHJpcHB5LCBidXQgaGVyZSdzIHdoYXQncyBnb2luZyBvbjpcbiAgICAgICAgLy8gLSBhKSBXZSBkb24ndCBwYXNzIGluaXRpYWwgaW50ZWdyYXRpb24gb3B0aW9ucyBhcyBwYXJ0IG9mIHRoZSBldmVudCwgb25seSBpZiB0aGV5J3JlIHRydWUgb3IgZmFsc2VcbiAgICAgICAgLy8gLSBiKSBXZSBkbyBhY2NlcHQgcGVyIGludGVncmF0aW9uIG92ZXJyaWRlcyAobGlrZSBpbnRlZ3JhdGlvbnMuQW1wbGl0dWRlLnNlc3Npb25JZCkgYXQgdGhlIGV2ZW50IGxldmVsXG4gICAgICAgIC8vIEhlbmNlIHRoZSBuZWVkIHRvIGNvbnZlcnQgYmFzZSBpbnRlZ3JhdGlvbiBvcHRpb25zIHRvIGJvb2xlYW5zLCBidXQgbWFpbnRhaW4gcGVyIGV2ZW50IGludGVncmF0aW9uIG92ZXJyaWRlc1xuICAgICAgICB2YXIgYWxsSW50ZWdyYXRpb25zID0gX19hc3NpZ24oX19hc3NpZ24oe30sIGludGVncmF0aW9uQm9vbGVhbnMpLCAoX2IgPSBldmVudC5vcHRpb25zKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuaW50ZWdyYXRpb25zKTtcbiAgICAgICAgdmFyIF9jID0gZXZlbnQub3B0aW9uc1xuICAgICAgICAgICAgPyB0aGlzLmNvbnRleHQoZXZlbnQub3B0aW9ucylcbiAgICAgICAgICAgIDogW10sIGNvbnRleHQgPSBfY1swXSwgb3ZlcnJpZGVzID0gX2NbMV07XG4gICAgICAgIHZhciBvcHRpb25zID0gZXZlbnQub3B0aW9ucywgcmVzdCA9IF9fcmVzdChldmVudCwgW1wib3B0aW9uc1wiXSk7XG4gICAgICAgIHZhciBldnQgPSBfX2Fzc2lnbihfX2Fzc2lnbihfX2Fzc2lnbihfX2Fzc2lnbih7IHRpbWVzdGFtcDogbmV3IERhdGUoKSB9LCByZXN0KSwgeyBjb250ZXh0OiBjb250ZXh0LCBpbnRlZ3JhdGlvbnM6IGFsbEludGVncmF0aW9ucyB9KSwgb3ZlcnJpZGVzKSwgeyBtZXNzYWdlSWQ6IG9wdGlvbnMubWVzc2FnZUlkIHx8IHRoaXMuc2V0dGluZ3MuY3JlYXRlTWVzc2FnZUlkKCkgfSk7XG4gICAgICAgIHRoaXMuc2V0dGluZ3Mub25GaW5pc2hlZEV2ZW50KGV2dCk7XG4gICAgICAgIHZhbGlkYXRlRXZlbnQoZXZ0KTtcbiAgICAgICAgcmV0dXJuIGV2dDtcbiAgICB9O1xuICAgIHJldHVybiBDb3JlRXZlbnRGYWN0b3J5O1xufSgpKTtcbmV4cG9ydCB7IENvcmVFdmVudEZhY3RvcnkgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-core/dist/esm/events/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-core/dist/esm/logger/index.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@segment/analytics-core/dist/esm/logger/index.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CoreLogger: () => (/* binding */ CoreLogger)\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ \"(ssr)/./node_modules/tslib/tslib.es6.mjs\");\n\nvar CoreLogger = /** @class */ (function () {\n    function CoreLogger() {\n        this._logs = [];\n    }\n    CoreLogger.prototype.log = function (level, message, extras) {\n        var time = new Date();\n        this._logs.push({\n            level: level,\n            message: message,\n            time: time,\n            extras: extras,\n        });\n    };\n    Object.defineProperty(CoreLogger.prototype, \"logs\", {\n        get: function () {\n            return this._logs;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    CoreLogger.prototype.flush = function () {\n        if (this.logs.length > 1) {\n            var formatted = this._logs.reduce(function (logs, log) {\n                var _a;\n                var _b, _c;\n                var line = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)({}, log), { json: JSON.stringify(log.extras, null, ' '), extras: log.extras });\n                delete line['time'];\n                var key = (_c = (_b = log.time) === null || _b === void 0 ? void 0 : _b.toISOString()) !== null && _c !== void 0 ? _c : '';\n                if (logs[key]) {\n                    key = \"\".concat(key, \"-\").concat(Math.random());\n                }\n                return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)({}, logs), (_a = {}, _a[key] = line, _a));\n            }, {});\n            // ie doesn't like console.table\n            if (console.table) {\n                console.table(formatted);\n            }\n            else {\n                console.log(formatted);\n            }\n        }\n        else {\n            this.logs.forEach(function (logEntry) {\n                var level = logEntry.level, message = logEntry.message, extras = logEntry.extras;\n                if (level === 'info' || level === 'debug') {\n                    console.log(message, extras !== null && extras !== void 0 ? extras : '');\n                }\n                else {\n                    console[level](message, extras !== null && extras !== void 0 ? extras : '');\n                }\n            });\n        }\n        this._logs = [];\n    };\n    return CoreLogger;\n}());\n\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUvZGlzdC9lc20vbG9nZ2VyL2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLCtDQUFRLENBQUMsK0NBQVEsR0FBRyxVQUFVLGlFQUFpRTtBQUMxSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLCtDQUFRLENBQUMsK0NBQVEsR0FBRyxpQkFBaUI7QUFDNUQsYUFBYSxJQUFJO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ3FCO0FBQ3RCIiwic291cmNlcyI6WyIvVXNlcnMvYXBwbGUvRGVza3RvcC9BZWxmIFByb2plY3RzL2FlbGYtY29kZS1nZW5lcmF0b3Ivbm9kZV9tb2R1bGVzL0BzZWdtZW50L2FuYWx5dGljcy1jb3JlL2Rpc3QvZXNtL2xvZ2dlci9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBfX2Fzc2lnbiB9IGZyb20gXCJ0c2xpYlwiO1xudmFyIENvcmVMb2dnZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ29yZUxvZ2dlcigpIHtcbiAgICAgICAgdGhpcy5fbG9ncyA9IFtdO1xuICAgIH1cbiAgICBDb3JlTG9nZ2VyLnByb3RvdHlwZS5sb2cgPSBmdW5jdGlvbiAobGV2ZWwsIG1lc3NhZ2UsIGV4dHJhcykge1xuICAgICAgICB2YXIgdGltZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgIHRoaXMuX2xvZ3MucHVzaCh7XG4gICAgICAgICAgICBsZXZlbDogbGV2ZWwsXG4gICAgICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuICAgICAgICAgICAgdGltZTogdGltZSxcbiAgICAgICAgICAgIGV4dHJhczogZXh0cmFzLFxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb3JlTG9nZ2VyLnByb3RvdHlwZSwgXCJsb2dzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbG9ncztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIENvcmVMb2dnZXIucHJvdG90eXBlLmZsdXNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5sb2dzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIHZhciBmb3JtYXR0ZWQgPSB0aGlzLl9sb2dzLnJlZHVjZShmdW5jdGlvbiAobG9ncywgbG9nKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgICAgIHZhciBfYiwgX2M7XG4gICAgICAgICAgICAgICAgdmFyIGxpbmUgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgbG9nKSwgeyBqc29uOiBKU09OLnN0cmluZ2lmeShsb2cuZXh0cmFzLCBudWxsLCAnICcpLCBleHRyYXM6IGxvZy5leHRyYXMgfSk7XG4gICAgICAgICAgICAgICAgZGVsZXRlIGxpbmVbJ3RpbWUnXTtcbiAgICAgICAgICAgICAgICB2YXIga2V5ID0gKF9jID0gKF9iID0gbG9nLnRpbWUpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi50b0lTT1N0cmluZygpKSAhPT0gbnVsbCAmJiBfYyAhPT0gdm9pZCAwID8gX2MgOiAnJztcbiAgICAgICAgICAgICAgICBpZiAobG9nc1trZXldKSB7XG4gICAgICAgICAgICAgICAgICAgIGtleSA9IFwiXCIuY29uY2F0KGtleSwgXCItXCIpLmNvbmNhdChNYXRoLnJhbmRvbSgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9fYXNzaWduKF9fYXNzaWduKHt9LCBsb2dzKSwgKF9hID0ge30sIF9hW2tleV0gPSBsaW5lLCBfYSkpO1xuICAgICAgICAgICAgfSwge30pO1xuICAgICAgICAgICAgLy8gaWUgZG9lc24ndCBsaWtlIGNvbnNvbGUudGFibGVcbiAgICAgICAgICAgIGlmIChjb25zb2xlLnRhYmxlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS50YWJsZShmb3JtYXR0ZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZm9ybWF0dGVkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubG9ncy5mb3JFYWNoKGZ1bmN0aW9uIChsb2dFbnRyeSkge1xuICAgICAgICAgICAgICAgIHZhciBsZXZlbCA9IGxvZ0VudHJ5LmxldmVsLCBtZXNzYWdlID0gbG9nRW50cnkubWVzc2FnZSwgZXh0cmFzID0gbG9nRW50cnkuZXh0cmFzO1xuICAgICAgICAgICAgICAgIGlmIChsZXZlbCA9PT0gJ2luZm8nIHx8IGxldmVsID09PSAnZGVidWcnKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG1lc3NhZ2UsIGV4dHJhcyAhPT0gbnVsbCAmJiBleHRyYXMgIT09IHZvaWQgMCA/IGV4dHJhcyA6ICcnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGVbbGV2ZWxdKG1lc3NhZ2UsIGV4dHJhcyAhPT0gbnVsbCAmJiBleHRyYXMgIT09IHZvaWQgMCA/IGV4dHJhcyA6ICcnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9sb2dzID0gW107XG4gICAgfTtcbiAgICByZXR1cm4gQ29yZUxvZ2dlcjtcbn0oKSk7XG5leHBvcnQgeyBDb3JlTG9nZ2VyIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-core/dist/esm/logger/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-core/dist/esm/priority-queue/backoff.js":
/*!*********************************************************************************!*\
  !*** ./node_modules/@segment/analytics-core/dist/esm/priority-queue/backoff.js ***!
  \*********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   backoff: () => (/* binding */ backoff)\n/* harmony export */ });\nfunction backoff(params) {\n    var random = Math.random() + 1;\n    var _a = params.minTimeout, minTimeout = _a === void 0 ? 500 : _a, _b = params.factor, factor = _b === void 0 ? 2 : _b, attempt = params.attempt, _c = params.maxTimeout, maxTimeout = _c === void 0 ? Infinity : _c;\n    return Math.min(random * minTimeout * Math.pow(factor, attempt), maxTimeout);\n}\n//# sourceMappingURL=backoff.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUvZGlzdC9lc20vcHJpb3JpdHktcXVldWUvYmFja29mZi5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyIvVXNlcnMvYXBwbGUvRGVza3RvcC9BZWxmIFByb2plY3RzL2FlbGYtY29kZS1nZW5lcmF0b3Ivbm9kZV9tb2R1bGVzL0BzZWdtZW50L2FuYWx5dGljcy1jb3JlL2Rpc3QvZXNtL3ByaW9yaXR5LXF1ZXVlL2JhY2tvZmYuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIGJhY2tvZmYocGFyYW1zKSB7XG4gICAgdmFyIHJhbmRvbSA9IE1hdGgucmFuZG9tKCkgKyAxO1xuICAgIHZhciBfYSA9IHBhcmFtcy5taW5UaW1lb3V0LCBtaW5UaW1lb3V0ID0gX2EgPT09IHZvaWQgMCA/IDUwMCA6IF9hLCBfYiA9IHBhcmFtcy5mYWN0b3IsIGZhY3RvciA9IF9iID09PSB2b2lkIDAgPyAyIDogX2IsIGF0dGVtcHQgPSBwYXJhbXMuYXR0ZW1wdCwgX2MgPSBwYXJhbXMubWF4VGltZW91dCwgbWF4VGltZW91dCA9IF9jID09PSB2b2lkIDAgPyBJbmZpbml0eSA6IF9jO1xuICAgIHJldHVybiBNYXRoLm1pbihyYW5kb20gKiBtaW5UaW1lb3V0ICogTWF0aC5wb3coZmFjdG9yLCBhdHRlbXB0KSwgbWF4VGltZW91dCk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1iYWNrb2ZmLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-core/dist/esm/priority-queue/backoff.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-core/dist/esm/priority-queue/index.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/@segment/analytics-core/dist/esm/priority-queue/index.js ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ON_REMOVE_FROM_FUTURE: () => (/* binding */ ON_REMOVE_FROM_FUTURE),\n/* harmony export */   PriorityQueue: () => (/* binding */ PriorityQueue)\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ \"(ssr)/./node_modules/tslib/tslib.es6.mjs\");\n/* harmony import */ var _segment_analytics_generic_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @segment/analytics-generic-utils */ \"(ssr)/./node_modules/@segment/analytics-generic-utils/dist/esm/emitter/emitter.js\");\n/* harmony import */ var _backoff__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./backoff */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/priority-queue/backoff.js\");\n\n\n\n/**\n * @internal\n */\nvar ON_REMOVE_FROM_FUTURE = 'onRemoveFromFuture';\nvar PriorityQueue = /** @class */ (function (_super) {\n    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__extends)(PriorityQueue, _super);\n    function PriorityQueue(maxAttempts, queue, seen) {\n        var _this = _super.call(this) || this;\n        _this.future = [];\n        _this.maxAttempts = maxAttempts;\n        _this.queue = queue;\n        _this.seen = seen !== null && seen !== void 0 ? seen : {};\n        return _this;\n    }\n    PriorityQueue.prototype.push = function () {\n        var _this = this;\n        var items = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            items[_i] = arguments[_i];\n        }\n        var accepted = items.map(function (operation) {\n            var attempts = _this.updateAttempts(operation);\n            if (attempts > _this.maxAttempts || _this.includes(operation)) {\n                return false;\n            }\n            _this.queue.push(operation);\n            return true;\n        });\n        this.queue = this.queue.sort(function (a, b) { return _this.getAttempts(a) - _this.getAttempts(b); });\n        return accepted;\n    };\n    PriorityQueue.prototype.pushWithBackoff = function (item, minTimeout) {\n        var _this = this;\n        if (minTimeout === void 0) { minTimeout = 0; }\n        // One immediate retry unless we have a minimum timeout (e.g. for rate limiting)\n        if (minTimeout == 0 && this.getAttempts(item) === 0) {\n            return this.push(item)[0];\n        }\n        var attempt = this.updateAttempts(item);\n        if (attempt > this.maxAttempts || this.includes(item)) {\n            return false;\n        }\n        var timeout = (0,_backoff__WEBPACK_IMPORTED_MODULE_1__.backoff)({ attempt: attempt - 1 });\n        if (minTimeout > 0 && timeout < minTimeout) {\n            timeout = minTimeout;\n        }\n        setTimeout(function () {\n            _this.queue.push(item);\n            // remove from future list\n            _this.future = _this.future.filter(function (f) { return f.id !== item.id; });\n            // Lets listeners know that a 'future' message is now available in the queue\n            _this.emit(ON_REMOVE_FROM_FUTURE);\n        }, timeout);\n        this.future.push(item);\n        return true;\n    };\n    PriorityQueue.prototype.getAttempts = function (item) {\n        var _a;\n        return (_a = this.seen[item.id]) !== null && _a !== void 0 ? _a : 0;\n    };\n    PriorityQueue.prototype.updateAttempts = function (item) {\n        this.seen[item.id] = this.getAttempts(item) + 1;\n        return this.getAttempts(item);\n    };\n    PriorityQueue.prototype.includes = function (item) {\n        return (this.queue.includes(item) ||\n            this.future.includes(item) ||\n            Boolean(this.queue.find(function (i) { return i.id === item.id; })) ||\n            Boolean(this.future.find(function (i) { return i.id === item.id; })));\n    };\n    PriorityQueue.prototype.pop = function () {\n        return this.queue.shift();\n    };\n    Object.defineProperty(PriorityQueue.prototype, \"length\", {\n        get: function () {\n            return this.queue.length;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(PriorityQueue.prototype, \"todo\", {\n        get: function () {\n            return this.queue.length + this.future.length;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return PriorityQueue;\n}(_segment_analytics_generic_utils__WEBPACK_IMPORTED_MODULE_2__.Emitter));\n\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUvZGlzdC9lc20vcHJpb3JpdHktcXVldWUvaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBa0M7QUFDeUI7QUFDdkI7QUFDcEM7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBLElBQUksZ0RBQVM7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHVCQUF1QjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsdURBQXVELHFEQUFxRDtBQUM1RztBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLGlEQUFPLEdBQUcsc0JBQXNCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhEQUE4RCwwQkFBMEI7QUFDeEY7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELDBCQUEwQjtBQUM3RSxvREFBb0QsMEJBQTBCO0FBQzlFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDLENBQUMscUVBQU87QUFDZ0I7QUFDekIiLCJzb3VyY2VzIjpbIi9Vc2Vycy9hcHBsZS9EZXNrdG9wL0FlbGYgUHJvamVjdHMvYWVsZi1jb2RlLWdlbmVyYXRvci9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUvZGlzdC9lc20vcHJpb3JpdHktcXVldWUvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgX19leHRlbmRzIH0gZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBFbWl0dGVyIH0gZnJvbSAnQHNlZ21lbnQvYW5hbHl0aWNzLWdlbmVyaWMtdXRpbHMnO1xuaW1wb3J0IHsgYmFja29mZiB9IGZyb20gJy4vYmFja29mZic7XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIE9OX1JFTU9WRV9GUk9NX0ZVVFVSRSA9ICdvblJlbW92ZUZyb21GdXR1cmUnO1xudmFyIFByaW9yaXR5UXVldWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFByaW9yaXR5UXVldWUsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gUHJpb3JpdHlRdWV1ZShtYXhBdHRlbXB0cywgcXVldWUsIHNlZW4pIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuZnV0dXJlID0gW107XG4gICAgICAgIF90aGlzLm1heEF0dGVtcHRzID0gbWF4QXR0ZW1wdHM7XG4gICAgICAgIF90aGlzLnF1ZXVlID0gcXVldWU7XG4gICAgICAgIF90aGlzLnNlZW4gPSBzZWVuICE9PSBudWxsICYmIHNlZW4gIT09IHZvaWQgMCA/IHNlZW4gOiB7fTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBQcmlvcml0eVF1ZXVlLnByb3RvdHlwZS5wdXNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgaXRlbXMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGl0ZW1zW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGFjY2VwdGVkID0gaXRlbXMubWFwKGZ1bmN0aW9uIChvcGVyYXRpb24pIHtcbiAgICAgICAgICAgIHZhciBhdHRlbXB0cyA9IF90aGlzLnVwZGF0ZUF0dGVtcHRzKG9wZXJhdGlvbik7XG4gICAgICAgICAgICBpZiAoYXR0ZW1wdHMgPiBfdGhpcy5tYXhBdHRlbXB0cyB8fCBfdGhpcy5pbmNsdWRlcyhvcGVyYXRpb24pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3RoaXMucXVldWUucHVzaChvcGVyYXRpb24pO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnF1ZXVlID0gdGhpcy5xdWV1ZS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBfdGhpcy5nZXRBdHRlbXB0cyhhKSAtIF90aGlzLmdldEF0dGVtcHRzKGIpOyB9KTtcbiAgICAgICAgcmV0dXJuIGFjY2VwdGVkO1xuICAgIH07XG4gICAgUHJpb3JpdHlRdWV1ZS5wcm90b3R5cGUucHVzaFdpdGhCYWNrb2ZmID0gZnVuY3Rpb24gKGl0ZW0sIG1pblRpbWVvdXQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKG1pblRpbWVvdXQgPT09IHZvaWQgMCkgeyBtaW5UaW1lb3V0ID0gMDsgfVxuICAgICAgICAvLyBPbmUgaW1tZWRpYXRlIHJldHJ5IHVubGVzcyB3ZSBoYXZlIGEgbWluaW11bSB0aW1lb3V0IChlLmcuIGZvciByYXRlIGxpbWl0aW5nKVxuICAgICAgICBpZiAobWluVGltZW91dCA9PSAwICYmIHRoaXMuZ2V0QXR0ZW1wdHMoaXRlbSkgPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnB1c2goaXRlbSlbMF07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGF0dGVtcHQgPSB0aGlzLnVwZGF0ZUF0dGVtcHRzKGl0ZW0pO1xuICAgICAgICBpZiAoYXR0ZW1wdCA+IHRoaXMubWF4QXR0ZW1wdHMgfHwgdGhpcy5pbmNsdWRlcyhpdGVtKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciB0aW1lb3V0ID0gYmFja29mZih7IGF0dGVtcHQ6IGF0dGVtcHQgLSAxIH0pO1xuICAgICAgICBpZiAobWluVGltZW91dCA+IDAgJiYgdGltZW91dCA8IG1pblRpbWVvdXQpIHtcbiAgICAgICAgICAgIHRpbWVvdXQgPSBtaW5UaW1lb3V0O1xuICAgICAgICB9XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3RoaXMucXVldWUucHVzaChpdGVtKTtcbiAgICAgICAgICAgIC8vIHJlbW92ZSBmcm9tIGZ1dHVyZSBsaXN0XG4gICAgICAgICAgICBfdGhpcy5mdXR1cmUgPSBfdGhpcy5mdXR1cmUuZmlsdGVyKGZ1bmN0aW9uIChmKSB7IHJldHVybiBmLmlkICE9PSBpdGVtLmlkOyB9KTtcbiAgICAgICAgICAgIC8vIExldHMgbGlzdGVuZXJzIGtub3cgdGhhdCBhICdmdXR1cmUnIG1lc3NhZ2UgaXMgbm93IGF2YWlsYWJsZSBpbiB0aGUgcXVldWVcbiAgICAgICAgICAgIF90aGlzLmVtaXQoT05fUkVNT1ZFX0ZST01fRlVUVVJFKTtcbiAgICAgICAgfSwgdGltZW91dCk7XG4gICAgICAgIHRoaXMuZnV0dXJlLnB1c2goaXRlbSk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgUHJpb3JpdHlRdWV1ZS5wcm90b3R5cGUuZ2V0QXR0ZW1wdHMgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHJldHVybiAoX2EgPSB0aGlzLnNlZW5baXRlbS5pZF0pICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IDA7XG4gICAgfTtcbiAgICBQcmlvcml0eVF1ZXVlLnByb3RvdHlwZS51cGRhdGVBdHRlbXB0cyA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIHRoaXMuc2VlbltpdGVtLmlkXSA9IHRoaXMuZ2V0QXR0ZW1wdHMoaXRlbSkgKyAxO1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRBdHRlbXB0cyhpdGVtKTtcbiAgICB9O1xuICAgIFByaW9yaXR5UXVldWUucHJvdG90eXBlLmluY2x1ZGVzID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLnF1ZXVlLmluY2x1ZGVzKGl0ZW0pIHx8XG4gICAgICAgICAgICB0aGlzLmZ1dHVyZS5pbmNsdWRlcyhpdGVtKSB8fFxuICAgICAgICAgICAgQm9vbGVhbih0aGlzLnF1ZXVlLmZpbmQoZnVuY3Rpb24gKGkpIHsgcmV0dXJuIGkuaWQgPT09IGl0ZW0uaWQ7IH0pKSB8fFxuICAgICAgICAgICAgQm9vbGVhbih0aGlzLmZ1dHVyZS5maW5kKGZ1bmN0aW9uIChpKSB7IHJldHVybiBpLmlkID09PSBpdGVtLmlkOyB9KSkpO1xuICAgIH07XG4gICAgUHJpb3JpdHlRdWV1ZS5wcm90b3R5cGUucG9wID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5xdWV1ZS5zaGlmdCgpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFByaW9yaXR5UXVldWUucHJvdG90eXBlLCBcImxlbmd0aFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucXVldWUubGVuZ3RoO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFByaW9yaXR5UXVldWUucHJvdG90eXBlLCBcInRvZG9cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnF1ZXVlLmxlbmd0aCArIHRoaXMuZnV0dXJlLmxlbmd0aDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBQcmlvcml0eVF1ZXVlO1xufShFbWl0dGVyKSk7XG5leHBvcnQgeyBQcmlvcml0eVF1ZXVlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-core/dist/esm/priority-queue/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-core/dist/esm/queue/delivery.js":
/*!*************************************************************************!*\
  !*** ./node_modules/@segment/analytics-core/dist/esm/queue/delivery.js ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   attempt: () => (/* binding */ attempt),\n/* harmony export */   ensure: () => (/* binding */ ensure)\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ \"(ssr)/./node_modules/tslib/tslib.es6.mjs\");\n/* harmony import */ var _context__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../context */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/context/index.js\");\n\n\nfunction tryAsync(fn) {\n    return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {\n        var err_1;\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    _a.trys.push([0, 2, , 3]);\n                    return [4 /*yield*/, fn()];\n                case 1: return [2 /*return*/, _a.sent()];\n                case 2:\n                    err_1 = _a.sent();\n                    return [2 /*return*/, Promise.reject(err_1)];\n                case 3: return [2 /*return*/];\n            }\n        });\n    });\n}\nfunction attempt(ctx, plugin) {\n    ctx.log('debug', 'plugin', { plugin: plugin.name });\n    var start = new Date().getTime();\n    var hook = plugin[ctx.event.type];\n    if (hook === undefined) {\n        return Promise.resolve(ctx);\n    }\n    var newCtx = tryAsync(function () { return hook.apply(plugin, [ctx]); })\n        .then(function (ctx) {\n        var done = new Date().getTime() - start;\n        ctx.stats.gauge('plugin_time', done, [\"plugin:\".concat(plugin.name)]);\n        return ctx;\n    })\n        .catch(function (err) {\n        if (err instanceof _context__WEBPACK_IMPORTED_MODULE_1__.ContextCancelation &&\n            err.type === 'middleware_cancellation') {\n            throw err;\n        }\n        if (err instanceof _context__WEBPACK_IMPORTED_MODULE_1__.ContextCancelation) {\n            ctx.log('warn', err.type, {\n                plugin: plugin.name,\n                error: err,\n            });\n            return err;\n        }\n        ctx.log('error', 'plugin Error', {\n            plugin: plugin.name,\n            error: err,\n        });\n        ctx.stats.increment('plugin_error', 1, [\"plugin:\".concat(plugin.name)]);\n        return err;\n    });\n    return newCtx;\n}\nfunction ensure(ctx, plugin) {\n    return attempt(ctx, plugin).then(function (newContext) {\n        if (newContext instanceof _context__WEBPACK_IMPORTED_MODULE_1__.CoreContext) {\n            return newContext;\n        }\n        ctx.log('debug', 'Context canceled');\n        ctx.stats.increment('context_canceled');\n        ctx.cancel(newContext);\n    });\n}\n//# sourceMappingURL=delivery.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUvZGlzdC9lc20vcXVldWUvZGVsaXZlcnkuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUErQztBQUNjO0FBQzdEO0FBQ0EsV0FBVyxnREFBUztBQUNwQjtBQUNBLGVBQWUsa0RBQVc7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ087QUFDUCxpQ0FBaUMscUJBQXFCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsbUNBQW1DO0FBQzNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsMkJBQTJCLHdEQUFrQjtBQUM3QztBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsd0RBQWtCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNPO0FBQ1A7QUFDQSxrQ0FBa0MsaURBQVc7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBIiwic291cmNlcyI6WyIvVXNlcnMvYXBwbGUvRGVza3RvcC9BZWxmIFByb2plY3RzL2FlbGYtY29kZS1nZW5lcmF0b3Ivbm9kZV9tb2R1bGVzL0BzZWdtZW50L2FuYWx5dGljcy1jb3JlL2Rpc3QvZXNtL3F1ZXVlL2RlbGl2ZXJ5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IF9fYXdhaXRlciwgX19nZW5lcmF0b3IgfSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IENvcmVDb250ZXh0LCBDb250ZXh0Q2FuY2VsYXRpb24gfSBmcm9tICcuLi9jb250ZXh0JztcbmZ1bmN0aW9uIHRyeUFzeW5jKGZuKSB7XG4gICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZXJyXzE7XG4gICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMCwgMiwgLCAzXSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGZuKCldO1xuICAgICAgICAgICAgICAgIGNhc2UgMTogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9hLnNlbnQoKV07XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICBlcnJfMSA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIFByb21pc2UucmVqZWN0KGVycl8xKV07XG4gICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGF0dGVtcHQoY3R4LCBwbHVnaW4pIHtcbiAgICBjdHgubG9nKCdkZWJ1ZycsICdwbHVnaW4nLCB7IHBsdWdpbjogcGx1Z2luLm5hbWUgfSk7XG4gICAgdmFyIHN0YXJ0ID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgdmFyIGhvb2sgPSBwbHVnaW5bY3R4LmV2ZW50LnR5cGVdO1xuICAgIGlmIChob29rID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShjdHgpO1xuICAgIH1cbiAgICB2YXIgbmV3Q3R4ID0gdHJ5QXN5bmMoZnVuY3Rpb24gKCkgeyByZXR1cm4gaG9vay5hcHBseShwbHVnaW4sIFtjdHhdKTsgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGN0eCkge1xuICAgICAgICB2YXIgZG9uZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpIC0gc3RhcnQ7XG4gICAgICAgIGN0eC5zdGF0cy5nYXVnZSgncGx1Z2luX3RpbWUnLCBkb25lLCBbXCJwbHVnaW46XCIuY29uY2F0KHBsdWdpbi5uYW1lKV0pO1xuICAgICAgICByZXR1cm4gY3R4O1xuICAgIH0pXG4gICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgIGlmIChlcnIgaW5zdGFuY2VvZiBDb250ZXh0Q2FuY2VsYXRpb24gJiZcbiAgICAgICAgICAgIGVyci50eXBlID09PSAnbWlkZGxld2FyZV9jYW5jZWxsYXRpb24nKSB7XG4gICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGVyciBpbnN0YW5jZW9mIENvbnRleHRDYW5jZWxhdGlvbikge1xuICAgICAgICAgICAgY3R4LmxvZygnd2FybicsIGVyci50eXBlLCB7XG4gICAgICAgICAgICAgICAgcGx1Z2luOiBwbHVnaW4ubmFtZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZXJyO1xuICAgICAgICB9XG4gICAgICAgIGN0eC5sb2coJ2Vycm9yJywgJ3BsdWdpbiBFcnJvcicsIHtcbiAgICAgICAgICAgIHBsdWdpbjogcGx1Z2luLm5hbWUsXG4gICAgICAgICAgICBlcnJvcjogZXJyLFxuICAgICAgICB9KTtcbiAgICAgICAgY3R4LnN0YXRzLmluY3JlbWVudCgncGx1Z2luX2Vycm9yJywgMSwgW1wicGx1Z2luOlwiLmNvbmNhdChwbHVnaW4ubmFtZSldKTtcbiAgICAgICAgcmV0dXJuIGVycjtcbiAgICB9KTtcbiAgICByZXR1cm4gbmV3Q3R4O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGVuc3VyZShjdHgsIHBsdWdpbikge1xuICAgIHJldHVybiBhdHRlbXB0KGN0eCwgcGx1Z2luKS50aGVuKGZ1bmN0aW9uIChuZXdDb250ZXh0KSB7XG4gICAgICAgIGlmIChuZXdDb250ZXh0IGluc3RhbmNlb2YgQ29yZUNvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXdDb250ZXh0O1xuICAgICAgICB9XG4gICAgICAgIGN0eC5sb2coJ2RlYnVnJywgJ0NvbnRleHQgY2FuY2VsZWQnKTtcbiAgICAgICAgY3R4LnN0YXRzLmluY3JlbWVudCgnY29udGV4dF9jYW5jZWxlZCcpO1xuICAgICAgICBjdHguY2FuY2VsKG5ld0NvbnRleHQpO1xuICAgIH0pO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGVsaXZlcnkuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-core/dist/esm/queue/delivery.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-core/dist/esm/queue/event-queue.js":
/*!****************************************************************************!*\
  !*** ./node_modules/@segment/analytics-core/dist/esm/queue/event-queue.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CoreEventQueue: () => (/* binding */ CoreEventQueue)\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ \"(ssr)/./node_modules/tslib/tslib.es6.mjs\");\n/* harmony import */ var _utils_group_by__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/group-by */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/utils/group-by.js\");\n/* harmony import */ var _priority_queue__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../priority-queue */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/priority-queue/index.js\");\n/* harmony import */ var _context__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../context */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/context/index.js\");\n/* harmony import */ var _segment_analytics_generic_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @segment/analytics-generic-utils */ \"(ssr)/./node_modules/@segment/analytics-generic-utils/dist/esm/emitter/emitter.js\");\n/* harmony import */ var _task_task_group__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../task/task-group */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/task/task-group.js\");\n/* harmony import */ var _delivery__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./delivery */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/queue/delivery.js\");\n\n\n\n\n\n\n\nvar CoreEventQueue = /** @class */ (function (_super) {\n    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__extends)(CoreEventQueue, _super);\n    function CoreEventQueue(priorityQueue) {\n        var _this = _super.call(this) || this;\n        /**\n         * All event deliveries get suspended until all the tasks in this task group are complete.\n         * For example: a middleware that augments the event object should be loaded safely as a\n         * critical task, this way, event queue will wait for it to be ready before sending events.\n         *\n         * This applies to all the events already in the queue, and the upcoming ones\n         */\n        _this.criticalTasks = (0,_task_task_group__WEBPACK_IMPORTED_MODULE_1__.createTaskGroup)();\n        _this.plugins = [];\n        _this.failedInitializations = [];\n        _this.flushing = false;\n        _this.queue = priorityQueue;\n        _this.queue.on(_priority_queue__WEBPACK_IMPORTED_MODULE_2__.ON_REMOVE_FROM_FUTURE, function () {\n            _this.scheduleFlush(0);\n        });\n        return _this;\n    }\n    CoreEventQueue.prototype.register = function (ctx, plugin, instance) {\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {\n            var handleLoadError, err_1;\n            var _this = this;\n            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        this.plugins.push(plugin);\n                        handleLoadError = function (err) {\n                            _this.failedInitializations.push(plugin.name);\n                            _this.emit('initialization_failure', plugin);\n                            console.warn(plugin.name, err);\n                            ctx.log('warn', 'Failed to load destination', {\n                                plugin: plugin.name,\n                                error: err,\n                            });\n                            // Filter out the failed plugin by excluding it from the list\n                            _this.plugins = _this.plugins.filter(function (p) { return p !== plugin; });\n                        };\n                        if (!(plugin.type === 'destination' && plugin.name !== 'Segment.io')) return [3 /*break*/, 1];\n                        plugin.load(ctx, instance).catch(handleLoadError);\n                        return [3 /*break*/, 4];\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, plugin.load(ctx, instance)];\n                    case 2:\n                        _a.sent();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        err_1 = _a.sent();\n                        handleLoadError(err_1);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    CoreEventQueue.prototype.deregister = function (ctx, plugin, instance) {\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {\n            var e_1;\n            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 3, , 4]);\n                        if (!plugin.unload) return [3 /*break*/, 2];\n                        return [4 /*yield*/, Promise.resolve(plugin.unload(ctx, instance))];\n                    case 1:\n                        _a.sent();\n                        _a.label = 2;\n                    case 2:\n                        this.plugins = this.plugins.filter(function (p) { return p.name !== plugin.name; });\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_1 = _a.sent();\n                        ctx.log('warn', 'Failed to unload destination', {\n                            plugin: plugin.name,\n                            error: e_1,\n                        });\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    CoreEventQueue.prototype.dispatch = function (ctx) {\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {\n            var willDeliver;\n            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {\n                ctx.log('debug', 'Dispatching');\n                ctx.stats.increment('message_dispatched');\n                this.queue.push(ctx);\n                willDeliver = this.subscribeToDelivery(ctx);\n                this.scheduleFlush(0);\n                return [2 /*return*/, willDeliver];\n            });\n        });\n    };\n    CoreEventQueue.prototype.subscribeToDelivery = function (ctx) {\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {\n            var _this = this;\n            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {\n                return [2 /*return*/, new Promise(function (resolve) {\n                        var onDeliver = function (flushed, delivered) {\n                            if (flushed.isSame(ctx)) {\n                                _this.off('flush', onDeliver);\n                                if (delivered) {\n                                    resolve(flushed);\n                                }\n                                else {\n                                    resolve(flushed);\n                                }\n                            }\n                        };\n                        _this.on('flush', onDeliver);\n                    })];\n            });\n        });\n    };\n    CoreEventQueue.prototype.dispatchSingle = function (ctx) {\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {\n            var _this = this;\n            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {\n                ctx.log('debug', 'Dispatching');\n                ctx.stats.increment('message_dispatched');\n                this.queue.updateAttempts(ctx);\n                ctx.attempts = 1;\n                return [2 /*return*/, this.deliver(ctx).catch(function (err) {\n                        var accepted = _this.enqueuRetry(err, ctx);\n                        if (!accepted) {\n                            ctx.setFailedDelivery({ reason: err });\n                            return ctx;\n                        }\n                        return _this.subscribeToDelivery(ctx);\n                    })];\n            });\n        });\n    };\n    CoreEventQueue.prototype.isEmpty = function () {\n        return this.queue.length === 0;\n    };\n    CoreEventQueue.prototype.scheduleFlush = function (timeout) {\n        var _this = this;\n        if (timeout === void 0) { timeout = 500; }\n        if (this.flushing) {\n            return;\n        }\n        this.flushing = true;\n        setTimeout(function () {\n            // eslint-disable-next-line @typescript-eslint/no-floating-promises\n            _this.flush().then(function () {\n                setTimeout(function () {\n                    _this.flushing = false;\n                    if (_this.queue.length) {\n                        _this.scheduleFlush(0);\n                    }\n                }, 0);\n            });\n        }, timeout);\n    };\n    CoreEventQueue.prototype.deliver = function (ctx) {\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {\n            var start, done, err_2, error;\n            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.criticalTasks.done()];\n                    case 1:\n                        _a.sent();\n                        start = Date.now();\n                        _a.label = 2;\n                    case 2:\n                        _a.trys.push([2, 4, , 5]);\n                        return [4 /*yield*/, this.flushOne(ctx)];\n                    case 3:\n                        ctx = _a.sent();\n                        done = Date.now() - start;\n                        this.emit('delivery_success', ctx);\n                        ctx.stats.gauge('delivered', done);\n                        ctx.log('debug', 'Delivered', ctx.event);\n                        return [2 /*return*/, ctx];\n                    case 4:\n                        err_2 = _a.sent();\n                        error = err_2;\n                        ctx.log('error', 'Failed to deliver', error);\n                        this.emit('delivery_failure', ctx, error);\n                        ctx.stats.increment('delivery_failed');\n                        throw err_2;\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    CoreEventQueue.prototype.enqueuRetry = function (err, ctx) {\n        var retriable = !(err instanceof _context__WEBPACK_IMPORTED_MODULE_3__.ContextCancelation) || err.retry;\n        if (!retriable) {\n            return false;\n        }\n        return this.queue.pushWithBackoff(ctx);\n    };\n    CoreEventQueue.prototype.flush = function () {\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {\n            var ctx, err_3, accepted;\n            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (this.queue.length === 0) {\n                            return [2 /*return*/, []];\n                        }\n                        ctx = this.queue.pop();\n                        if (!ctx) {\n                            return [2 /*return*/, []];\n                        }\n                        ctx.attempts = this.queue.getAttempts(ctx);\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, this.deliver(ctx)];\n                    case 2:\n                        ctx = _a.sent();\n                        this.emit('flush', ctx, true);\n                        return [3 /*break*/, 4];\n                    case 3:\n                        err_3 = _a.sent();\n                        accepted = this.enqueuRetry(err_3, ctx);\n                        if (!accepted) {\n                            ctx.setFailedDelivery({ reason: err_3 });\n                            this.emit('flush', ctx, false);\n                        }\n                        return [2 /*return*/, []];\n                    case 4: return [2 /*return*/, [ctx]];\n                }\n            });\n        });\n    };\n    CoreEventQueue.prototype.isReady = function () {\n        // return this.plugins.every((p) => p.isLoaded())\n        // should we wait for every plugin to load?\n        return true;\n    };\n    CoreEventQueue.prototype.availableExtensions = function (denyList) {\n        var available = this.plugins.filter(function (p) {\n            var _a, _b, _c;\n            // Only filter out destination plugins or the Segment.io plugin\n            if (p.type !== 'destination' && p.name !== 'Segment.io') {\n                return true;\n            }\n            var alternativeNameMatch = undefined;\n            (_a = p.alternativeNames) === null || _a === void 0 ? void 0 : _a.forEach(function (name) {\n                if (denyList[name] !== undefined) {\n                    alternativeNameMatch = denyList[name];\n                }\n            });\n            // Explicit integration option takes precedence, `All: false` does not apply to Segment.io\n            return ((_c = (_b = denyList[p.name]) !== null && _b !== void 0 ? _b : alternativeNameMatch) !== null && _c !== void 0 ? _c : (p.name === 'Segment.io' ? true : denyList.All) !== false);\n        });\n        var _a = (0,_utils_group_by__WEBPACK_IMPORTED_MODULE_4__.groupBy)(available, 'type'), _b = _a.before, before = _b === void 0 ? [] : _b, _c = _a.enrichment, enrichment = _c === void 0 ? [] : _c, _d = _a.destination, destination = _d === void 0 ? [] : _d, _e = _a.after, after = _e === void 0 ? [] : _e;\n        return {\n            before: before,\n            enrichment: enrichment,\n            destinations: destination,\n            after: after,\n        };\n    };\n    CoreEventQueue.prototype.flushOne = function (ctx) {\n        var _a, _b;\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {\n            var _c, before, enrichment, _i, before_1, beforeWare, temp, _d, enrichment_1, enrichmentWare, temp, _e, destinations, after, afterCalls;\n            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_f) {\n                switch (_f.label) {\n                    case 0:\n                        if (!this.isReady()) {\n                            throw new Error('Not ready');\n                        }\n                        if (ctx.attempts > 1) {\n                            this.emit('delivery_retry', ctx);\n                        }\n                        _c = this.availableExtensions((_a = ctx.event.integrations) !== null && _a !== void 0 ? _a : {}), before = _c.before, enrichment = _c.enrichment;\n                        _i = 0, before_1 = before;\n                        _f.label = 1;\n                    case 1:\n                        if (!(_i < before_1.length)) return [3 /*break*/, 4];\n                        beforeWare = before_1[_i];\n                        return [4 /*yield*/, (0,_delivery__WEBPACK_IMPORTED_MODULE_5__.ensure)(ctx, beforeWare)];\n                    case 2:\n                        temp = _f.sent();\n                        if (temp instanceof _context__WEBPACK_IMPORTED_MODULE_3__.CoreContext) {\n                            ctx = temp;\n                        }\n                        this.emit('message_enriched', ctx, beforeWare);\n                        _f.label = 3;\n                    case 3:\n                        _i++;\n                        return [3 /*break*/, 1];\n                    case 4:\n                        _d = 0, enrichment_1 = enrichment;\n                        _f.label = 5;\n                    case 5:\n                        if (!(_d < enrichment_1.length)) return [3 /*break*/, 8];\n                        enrichmentWare = enrichment_1[_d];\n                        return [4 /*yield*/, (0,_delivery__WEBPACK_IMPORTED_MODULE_5__.attempt)(ctx, enrichmentWare)];\n                    case 6:\n                        temp = _f.sent();\n                        if (temp instanceof _context__WEBPACK_IMPORTED_MODULE_3__.CoreContext) {\n                            ctx = temp;\n                        }\n                        this.emit('message_enriched', ctx, enrichmentWare);\n                        _f.label = 7;\n                    case 7:\n                        _d++;\n                        return [3 /*break*/, 5];\n                    case 8:\n                        _e = this.availableExtensions((_b = ctx.event.integrations) !== null && _b !== void 0 ? _b : {}), destinations = _e.destinations, after = _e.after;\n                        return [4 /*yield*/, new Promise(function (resolve, reject) {\n                                setTimeout(function () {\n                                    var attempts = destinations.map(function (destination) {\n                                        return (0,_delivery__WEBPACK_IMPORTED_MODULE_5__.attempt)(ctx, destination);\n                                    });\n                                    Promise.all(attempts).then(resolve).catch(reject);\n                                }, 0);\n                            })];\n                    case 9:\n                        _f.sent();\n                        ctx.stats.increment('message_delivered');\n                        this.emit('message_delivered', ctx);\n                        afterCalls = after.map(function (after) { return (0,_delivery__WEBPACK_IMPORTED_MODULE_5__.attempt)(ctx, after); });\n                        return [4 /*yield*/, Promise.all(afterCalls)];\n                    case 10:\n                        _f.sent();\n                        return [2 /*return*/, ctx];\n                }\n            });\n        });\n    };\n    return CoreEventQueue;\n}(_segment_analytics_generic_utils__WEBPACK_IMPORTED_MODULE_6__.Emitter));\n\n//# sourceMappingURL=event-queue.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUvZGlzdC9lc20vcXVldWUvZXZlbnQtcXVldWUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBMEQ7QUFDZDtBQUNjO0FBQ0c7QUFDRjtBQUNOO0FBQ1I7QUFDN0M7QUFDQSxJQUFJLGdEQUFTO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLGlFQUFlO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGtFQUFxQjtBQUM1QztBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxlQUFlLGdEQUFTO0FBQ3hCO0FBQ0E7QUFDQSxtQkFBbUIsa0RBQVc7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQSxnRkFBZ0Ysc0JBQXNCO0FBQ3RHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0EsZUFBZSxnREFBUztBQUN4QjtBQUNBLG1CQUFtQixrREFBVztBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwRUFBMEUsZ0NBQWdDO0FBQzFHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQSxlQUFlLGdEQUFTO0FBQ3hCO0FBQ0EsbUJBQW1CLGtEQUFXO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBLGVBQWUsZ0RBQVM7QUFDeEI7QUFDQSxtQkFBbUIsa0RBQVc7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0EsZUFBZSxnREFBUztBQUN4QjtBQUNBLG1CQUFtQixrREFBVztBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRCxhQUFhO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQixhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0EsZUFBZSxnREFBUztBQUN4QjtBQUNBLG1CQUFtQixrREFBVztBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBLHlDQUF5Qyx3REFBa0I7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxnREFBUztBQUN4QjtBQUNBLG1CQUFtQixrREFBVztBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRCxlQUFlO0FBQ25FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsU0FBUztBQUNULGlCQUFpQix3REFBTztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGdEQUFTO0FBQ3hCO0FBQ0EsbUJBQW1CLGtEQUFXO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1SEFBdUg7QUFDdkg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QyxpREFBTTtBQUNuRDtBQUNBO0FBQ0EsNENBQTRDLGlEQUFXO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLGtEQUFPO0FBQ3BEO0FBQ0E7QUFDQSw0Q0FBNEMsaURBQVc7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVIQUF1SDtBQUN2SDtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0Msa0RBQU87QUFDdEQscUNBQXFDO0FBQ3JDO0FBQ0EsaUNBQWlDO0FBQ2pDLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtFQUFrRSxPQUFPLGtEQUFPLGVBQWU7QUFDL0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBLENBQUMsQ0FBQyxxRUFBTztBQUNpQjtBQUMxQiIsInNvdXJjZXMiOlsiL1VzZXJzL2FwcGxlL0Rlc2t0b3AvQWVsZiBQcm9qZWN0cy9hZWxmLWNvZGUtZ2VuZXJhdG9yL25vZGVfbW9kdWxlcy9Ac2VnbWVudC9hbmFseXRpY3MtY29yZS9kaXN0L2VzbS9xdWV1ZS9ldmVudC1xdWV1ZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBfX2F3YWl0ZXIsIF9fZXh0ZW5kcywgX19nZW5lcmF0b3IgfSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IGdyb3VwQnkgfSBmcm9tICcuLi91dGlscy9ncm91cC1ieSc7XG5pbXBvcnQgeyBPTl9SRU1PVkVfRlJPTV9GVVRVUkUgfSBmcm9tICcuLi9wcmlvcml0eS1xdWV1ZSc7XG5pbXBvcnQgeyBDb3JlQ29udGV4dCwgQ29udGV4dENhbmNlbGF0aW9uIH0gZnJvbSAnLi4vY29udGV4dCc7XG5pbXBvcnQgeyBFbWl0dGVyIH0gZnJvbSAnQHNlZ21lbnQvYW5hbHl0aWNzLWdlbmVyaWMtdXRpbHMnO1xuaW1wb3J0IHsgY3JlYXRlVGFza0dyb3VwIH0gZnJvbSAnLi4vdGFzay90YXNrLWdyb3VwJztcbmltcG9ydCB7IGF0dGVtcHQsIGVuc3VyZSB9IGZyb20gJy4vZGVsaXZlcnknO1xudmFyIENvcmVFdmVudFF1ZXVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhDb3JlRXZlbnRRdWV1ZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBDb3JlRXZlbnRRdWV1ZShwcmlvcml0eVF1ZXVlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBbGwgZXZlbnQgZGVsaXZlcmllcyBnZXQgc3VzcGVuZGVkIHVudGlsIGFsbCB0aGUgdGFza3MgaW4gdGhpcyB0YXNrIGdyb3VwIGFyZSBjb21wbGV0ZS5cbiAgICAgICAgICogRm9yIGV4YW1wbGU6IGEgbWlkZGxld2FyZSB0aGF0IGF1Z21lbnRzIHRoZSBldmVudCBvYmplY3Qgc2hvdWxkIGJlIGxvYWRlZCBzYWZlbHkgYXMgYVxuICAgICAgICAgKiBjcml0aWNhbCB0YXNrLCB0aGlzIHdheSwgZXZlbnQgcXVldWUgd2lsbCB3YWl0IGZvciBpdCB0byBiZSByZWFkeSBiZWZvcmUgc2VuZGluZyBldmVudHMuXG4gICAgICAgICAqXG4gICAgICAgICAqIFRoaXMgYXBwbGllcyB0byBhbGwgdGhlIGV2ZW50cyBhbHJlYWR5IGluIHRoZSBxdWV1ZSwgYW5kIHRoZSB1cGNvbWluZyBvbmVzXG4gICAgICAgICAqL1xuICAgICAgICBfdGhpcy5jcml0aWNhbFRhc2tzID0gY3JlYXRlVGFza0dyb3VwKCk7XG4gICAgICAgIF90aGlzLnBsdWdpbnMgPSBbXTtcbiAgICAgICAgX3RoaXMuZmFpbGVkSW5pdGlhbGl6YXRpb25zID0gW107XG4gICAgICAgIF90aGlzLmZsdXNoaW5nID0gZmFsc2U7XG4gICAgICAgIF90aGlzLnF1ZXVlID0gcHJpb3JpdHlRdWV1ZTtcbiAgICAgICAgX3RoaXMucXVldWUub24oT05fUkVNT1ZFX0ZST01fRlVUVVJFLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfdGhpcy5zY2hlZHVsZUZsdXNoKDApO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBDb3JlRXZlbnRRdWV1ZS5wcm90b3R5cGUucmVnaXN0ZXIgPSBmdW5jdGlvbiAoY3R4LCBwbHVnaW4sIGluc3RhbmNlKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBoYW5kbGVMb2FkRXJyb3IsIGVycl8xO1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2lucy5wdXNoKHBsdWdpbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVMb2FkRXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZmFpbGVkSW5pdGlhbGl6YXRpb25zLnB1c2gocGx1Z2luLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmVtaXQoJ2luaXRpYWxpemF0aW9uX2ZhaWx1cmUnLCBwbHVnaW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihwbHVnaW4ubmFtZSwgZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgubG9nKCd3YXJuJywgJ0ZhaWxlZCB0byBsb2FkIGRlc3RpbmF0aW9uJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW46IHBsdWdpbi5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogZXJyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbHRlciBvdXQgdGhlIGZhaWxlZCBwbHVnaW4gYnkgZXhjbHVkaW5nIGl0IGZyb20gdGhlIGxpc3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5wbHVnaW5zID0gX3RoaXMucGx1Z2lucy5maWx0ZXIoZnVuY3Rpb24gKHApIHsgcmV0dXJuIHAgIT09IHBsdWdpbjsgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocGx1Z2luLnR5cGUgPT09ICdkZXN0aW5hdGlvbicgJiYgcGx1Z2luLm5hbWUgIT09ICdTZWdtZW50LmlvJykpIHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLmxvYWQoY3R4LCBpbnN0YW5jZSkuY2F0Y2goaGFuZGxlTG9hZEVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzEsIDMsICwgNF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcGx1Z2luLmxvYWQoY3R4LCBpbnN0YW5jZSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyXzEgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVMb2FkRXJyb3IoZXJyXzEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIENvcmVFdmVudFF1ZXVlLnByb3RvdHlwZS5kZXJlZ2lzdGVyID0gZnVuY3Rpb24gKGN0eCwgcGx1Z2luLCBpbnN0YW5jZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgZV8xO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFswLCAzLCAsIDRdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcGx1Z2luLnVubG9hZCkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBQcm9taXNlLnJlc29sdmUocGx1Z2luLnVubG9hZChjdHgsIGluc3RhbmNlKSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDI7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2lucyA9IHRoaXMucGx1Z2lucy5maWx0ZXIoZnVuY3Rpb24gKHApIHsgcmV0dXJuIHAubmFtZSAhPT0gcGx1Z2luLm5hbWU7IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVfMSA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5sb2coJ3dhcm4nLCAnRmFpbGVkIHRvIHVubG9hZCBkZXN0aW5hdGlvbicsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW46IHBsdWdpbi5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBlXzEsXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBDb3JlRXZlbnRRdWV1ZS5wcm90b3R5cGUuZGlzcGF0Y2ggPSBmdW5jdGlvbiAoY3R4KSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB3aWxsRGVsaXZlcjtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBjdHgubG9nKCdkZWJ1ZycsICdEaXNwYXRjaGluZycpO1xuICAgICAgICAgICAgICAgIGN0eC5zdGF0cy5pbmNyZW1lbnQoJ21lc3NhZ2VfZGlzcGF0Y2hlZCcpO1xuICAgICAgICAgICAgICAgIHRoaXMucXVldWUucHVzaChjdHgpO1xuICAgICAgICAgICAgICAgIHdpbGxEZWxpdmVyID0gdGhpcy5zdWJzY3JpYmVUb0RlbGl2ZXJ5KGN0eCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZUZsdXNoKDApO1xuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB3aWxsRGVsaXZlcl07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBDb3JlRXZlbnRRdWV1ZS5wcm90b3R5cGUuc3Vic2NyaWJlVG9EZWxpdmVyeSA9IGZ1bmN0aW9uIChjdHgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvbkRlbGl2ZXIgPSBmdW5jdGlvbiAoZmx1c2hlZCwgZGVsaXZlcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZsdXNoZWQuaXNTYW1lKGN0eCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMub2ZmKCdmbHVzaCcsIG9uRGVsaXZlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZWxpdmVyZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZmx1c2hlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGZsdXNoZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLm9uKCdmbHVzaCcsIG9uRGVsaXZlcik7XG4gICAgICAgICAgICAgICAgICAgIH0pXTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIENvcmVFdmVudFF1ZXVlLnByb3RvdHlwZS5kaXNwYXRjaFNpbmdsZSA9IGZ1bmN0aW9uIChjdHgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBjdHgubG9nKCdkZWJ1ZycsICdEaXNwYXRjaGluZycpO1xuICAgICAgICAgICAgICAgIGN0eC5zdGF0cy5pbmNyZW1lbnQoJ21lc3NhZ2VfZGlzcGF0Y2hlZCcpO1xuICAgICAgICAgICAgICAgIHRoaXMucXVldWUudXBkYXRlQXR0ZW1wdHMoY3R4KTtcbiAgICAgICAgICAgICAgICBjdHguYXR0ZW1wdHMgPSAxO1xuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLmRlbGl2ZXIoY3R4KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWNjZXB0ZWQgPSBfdGhpcy5lbnF1ZXVSZXRyeShlcnIsIGN0eCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFjY2VwdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LnNldEZhaWxlZERlbGl2ZXJ5KHsgcmVhc29uOiBlcnIgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGN0eDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5zdWJzY3JpYmVUb0RlbGl2ZXJ5KGN0eCk7XG4gICAgICAgICAgICAgICAgICAgIH0pXTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIENvcmVFdmVudFF1ZXVlLnByb3RvdHlwZS5pc0VtcHR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5xdWV1ZS5sZW5ndGggPT09IDA7XG4gICAgfTtcbiAgICBDb3JlRXZlbnRRdWV1ZS5wcm90b3R5cGUuc2NoZWR1bGVGbHVzaCA9IGZ1bmN0aW9uICh0aW1lb3V0KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0aW1lb3V0ID09PSB2b2lkIDApIHsgdGltZW91dCA9IDUwMDsgfVxuICAgICAgICBpZiAodGhpcy5mbHVzaGluZykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZmx1c2hpbmcgPSB0cnVlO1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcbiAgICAgICAgICAgIF90aGlzLmZsdXNoKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmZsdXNoaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5xdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnNjaGVkdWxlRmx1c2goMCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LCB0aW1lb3V0KTtcbiAgICB9O1xuICAgIENvcmVFdmVudFF1ZXVlLnByb3RvdHlwZS5kZWxpdmVyID0gZnVuY3Rpb24gKGN0eCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgc3RhcnQsIGRvbmUsIGVycl8yLCBlcnJvcjtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5jcml0aWNhbFRhc2tzLmRvbmUoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMjtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsyLCA0LCAsIDVdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuZmx1c2hPbmUoY3R4KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0eCA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvbmUgPSBEYXRlLm5vdygpIC0gc3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXQoJ2RlbGl2ZXJ5X3N1Y2Nlc3MnLCBjdHgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3R4LnN0YXRzLmdhdWdlKCdkZWxpdmVyZWQnLCBkb25lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5sb2coJ2RlYnVnJywgJ0RlbGl2ZXJlZCcsIGN0eC5ldmVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgY3R4XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyXzIgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvciA9IGVycl8yO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmxvZygnZXJyb3InLCAnRmFpbGVkIHRvIGRlbGl2ZXInLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXQoJ2RlbGl2ZXJ5X2ZhaWx1cmUnLCBjdHgsIGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5zdGF0cy5pbmNyZW1lbnQoJ2RlbGl2ZXJ5X2ZhaWxlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyXzI7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIENvcmVFdmVudFF1ZXVlLnByb3RvdHlwZS5lbnF1ZXVSZXRyeSA9IGZ1bmN0aW9uIChlcnIsIGN0eCkge1xuICAgICAgICB2YXIgcmV0cmlhYmxlID0gIShlcnIgaW5zdGFuY2VvZiBDb250ZXh0Q2FuY2VsYXRpb24pIHx8IGVyci5yZXRyeTtcbiAgICAgICAgaWYgKCFyZXRyaWFibGUpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5xdWV1ZS5wdXNoV2l0aEJhY2tvZmYoY3R4KTtcbiAgICB9O1xuICAgIENvcmVFdmVudFF1ZXVlLnByb3RvdHlwZS5mbHVzaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGN0eCwgZXJyXzMsIGFjY2VwdGVkO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucXVldWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIFtdXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGN0eCA9IHRoaXMucXVldWUucG9wKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWN0eCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBbXV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjdHguYXR0ZW1wdHMgPSB0aGlzLnF1ZXVlLmdldEF0dGVtcHRzKGN0eCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMSwgMywgLCA0XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmRlbGl2ZXIoY3R4KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0eCA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgnZmx1c2gnLCBjdHgsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycl8zID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXB0ZWQgPSB0aGlzLmVucXVldVJldHJ5KGVycl8zLCBjdHgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhY2NlcHRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5zZXRGYWlsZWREZWxpdmVyeSh7IHJlYXNvbjogZXJyXzMgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KCdmbHVzaCcsIGN0eCwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIFtdXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qLywgW2N0eF1dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIENvcmVFdmVudFF1ZXVlLnByb3RvdHlwZS5pc1JlYWR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyByZXR1cm4gdGhpcy5wbHVnaW5zLmV2ZXJ5KChwKSA9PiBwLmlzTG9hZGVkKCkpXG4gICAgICAgIC8vIHNob3VsZCB3ZSB3YWl0IGZvciBldmVyeSBwbHVnaW4gdG8gbG9hZD9cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBDb3JlRXZlbnRRdWV1ZS5wcm90b3R5cGUuYXZhaWxhYmxlRXh0ZW5zaW9ucyA9IGZ1bmN0aW9uIChkZW55TGlzdCkge1xuICAgICAgICB2YXIgYXZhaWxhYmxlID0gdGhpcy5wbHVnaW5zLmZpbHRlcihmdW5jdGlvbiAocCkge1xuICAgICAgICAgICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgICAgICAgICAvLyBPbmx5IGZpbHRlciBvdXQgZGVzdGluYXRpb24gcGx1Z2lucyBvciB0aGUgU2VnbWVudC5pbyBwbHVnaW5cbiAgICAgICAgICAgIGlmIChwLnR5cGUgIT09ICdkZXN0aW5hdGlvbicgJiYgcC5uYW1lICE9PSAnU2VnbWVudC5pbycpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBhbHRlcm5hdGl2ZU5hbWVNYXRjaCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIChfYSA9IHAuYWx0ZXJuYXRpdmVOYW1lcykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoZGVueUxpc3RbbmFtZV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBhbHRlcm5hdGl2ZU5hbWVNYXRjaCA9IGRlbnlMaXN0W25hbWVdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gRXhwbGljaXQgaW50ZWdyYXRpb24gb3B0aW9uIHRha2VzIHByZWNlZGVuY2UsIGBBbGw6IGZhbHNlYCBkb2VzIG5vdCBhcHBseSB0byBTZWdtZW50LmlvXG4gICAgICAgICAgICByZXR1cm4gKChfYyA9IChfYiA9IGRlbnlMaXN0W3AubmFtZV0pICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IGFsdGVybmF0aXZlTmFtZU1hdGNoKSAhPT0gbnVsbCAmJiBfYyAhPT0gdm9pZCAwID8gX2MgOiAocC5uYW1lID09PSAnU2VnbWVudC5pbycgPyB0cnVlIDogZGVueUxpc3QuQWxsKSAhPT0gZmFsc2UpO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIF9hID0gZ3JvdXBCeShhdmFpbGFibGUsICd0eXBlJyksIF9iID0gX2EuYmVmb3JlLCBiZWZvcmUgPSBfYiA9PT0gdm9pZCAwID8gW10gOiBfYiwgX2MgPSBfYS5lbnJpY2htZW50LCBlbnJpY2htZW50ID0gX2MgPT09IHZvaWQgMCA/IFtdIDogX2MsIF9kID0gX2EuZGVzdGluYXRpb24sIGRlc3RpbmF0aW9uID0gX2QgPT09IHZvaWQgMCA/IFtdIDogX2QsIF9lID0gX2EuYWZ0ZXIsIGFmdGVyID0gX2UgPT09IHZvaWQgMCA/IFtdIDogX2U7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBiZWZvcmU6IGJlZm9yZSxcbiAgICAgICAgICAgIGVucmljaG1lbnQ6IGVucmljaG1lbnQsXG4gICAgICAgICAgICBkZXN0aW5hdGlvbnM6IGRlc3RpbmF0aW9uLFxuICAgICAgICAgICAgYWZ0ZXI6IGFmdGVyLFxuICAgICAgICB9O1xuICAgIH07XG4gICAgQ29yZUV2ZW50UXVldWUucHJvdG90eXBlLmZsdXNoT25lID0gZnVuY3Rpb24gKGN0eCkge1xuICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgX2MsIGJlZm9yZSwgZW5yaWNobWVudCwgX2ksIGJlZm9yZV8xLCBiZWZvcmVXYXJlLCB0ZW1wLCBfZCwgZW5yaWNobWVudF8xLCBlbnJpY2htZW50V2FyZSwgdGVtcCwgX2UsIGRlc3RpbmF0aW9ucywgYWZ0ZXIsIGFmdGVyQ2FsbHM7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9mKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfZi5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaXNSZWFkeSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdOb3QgcmVhZHknKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdHguYXR0ZW1wdHMgPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KCdkZWxpdmVyeV9yZXRyeScsIGN0eCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBfYyA9IHRoaXMuYXZhaWxhYmxlRXh0ZW5zaW9ucygoX2EgPSBjdHguZXZlbnQuaW50ZWdyYXRpb25zKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiB7fSksIGJlZm9yZSA9IF9jLmJlZm9yZSwgZW5yaWNobWVudCA9IF9jLmVucmljaG1lbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBfaSA9IDAsIGJlZm9yZV8xID0gYmVmb3JlO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2YubGFiZWwgPSAxO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShfaSA8IGJlZm9yZV8xLmxlbmd0aCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYmVmb3JlV2FyZSA9IGJlZm9yZV8xW19pXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGVuc3VyZShjdHgsIGJlZm9yZVdhcmUpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcCA9IF9mLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ZW1wIGluc3RhbmNlb2YgQ29yZUNvbnRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHggPSB0ZW1wO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KCdtZXNzYWdlX2VucmljaGVkJywgY3R4LCBiZWZvcmVXYXJlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9mLmxhYmVsID0gMztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2krKztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBfZCA9IDAsIGVucmljaG1lbnRfMSA9IGVucmljaG1lbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBfZi5sYWJlbCA9IDU7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKF9kIDwgZW5yaWNobWVudF8xLmxlbmd0aCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgZW5yaWNobWVudFdhcmUgPSBlbnJpY2htZW50XzFbX2RdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgYXR0ZW1wdChjdHgsIGVucmljaG1lbnRXYXJlKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXAgPSBfZi5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGVtcCBpbnN0YW5jZW9mIENvcmVDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4ID0gdGVtcDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgnbWVzc2FnZV9lbnJpY2hlZCcsIGN0eCwgZW5yaWNobWVudFdhcmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2YubGFiZWwgPSA3O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgICAgICAgICBfZCsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9lID0gdGhpcy5hdmFpbGFibGVFeHRlbnNpb25zKChfYiA9IGN0eC5ldmVudC5pbnRlZ3JhdGlvbnMpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IHt9KSwgZGVzdGluYXRpb25zID0gX2UuZGVzdGluYXRpb25zLCBhZnRlciA9IF9lLmFmdGVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRlbXB0cyA9IGRlc3RpbmF0aW9ucy5tYXAoZnVuY3Rpb24gKGRlc3RpbmF0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF0dGVtcHQoY3R4LCBkZXN0aW5hdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFByb21pc2UuYWxsKGF0dGVtcHRzKS50aGVuKHJlc29sdmUpLmNhdGNoKHJlamVjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Yuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3R4LnN0YXRzLmluY3JlbWVudCgnbWVzc2FnZV9kZWxpdmVyZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgnbWVzc2FnZV9kZWxpdmVyZWQnLCBjdHgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWZ0ZXJDYWxscyA9IGFmdGVyLm1hcChmdW5jdGlvbiAoYWZ0ZXIpIHsgcmV0dXJuIGF0dGVtcHQoY3R4LCBhZnRlcik7IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgUHJvbWlzZS5hbGwoYWZ0ZXJDYWxscyldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Yuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGN0eF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIENvcmVFdmVudFF1ZXVlO1xufShFbWl0dGVyKSk7XG5leHBvcnQgeyBDb3JlRXZlbnRRdWV1ZSB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZXZlbnQtcXVldWUuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-core/dist/esm/queue/event-queue.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-core/dist/esm/stats/index.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@segment/analytics-core/dist/esm/stats/index.js ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CoreStats: () => (/* binding */ CoreStats),\n/* harmony export */   NullStats: () => (/* binding */ NullStats)\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ \"(ssr)/./node_modules/tslib/tslib.es6.mjs\");\n\nvar compactMetricType = function (type) {\n    var enums = {\n        gauge: 'g',\n        counter: 'c',\n    };\n    return enums[type];\n};\nvar CoreStats = /** @class */ (function () {\n    function CoreStats() {\n        this.metrics = [];\n    }\n    CoreStats.prototype.increment = function (metric, by, tags) {\n        if (by === void 0) { by = 1; }\n        this.metrics.push({\n            metric: metric,\n            value: by,\n            tags: tags !== null && tags !== void 0 ? tags : [],\n            type: 'counter',\n            timestamp: Date.now(),\n        });\n    };\n    CoreStats.prototype.gauge = function (metric, value, tags) {\n        this.metrics.push({\n            metric: metric,\n            value: value,\n            tags: tags !== null && tags !== void 0 ? tags : [],\n            type: 'gauge',\n            timestamp: Date.now(),\n        });\n    };\n    CoreStats.prototype.flush = function () {\n        var formatted = this.metrics.map(function (m) { return ((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)({}, m), { tags: m.tags.join(',') })); });\n        // ie doesn't like console.table\n        if (console.table) {\n            console.table(formatted);\n        }\n        else {\n            console.log(formatted);\n        }\n        this.metrics = [];\n    };\n    /**\n     * compact keys for smaller payload\n     */\n    CoreStats.prototype.serialize = function () {\n        return this.metrics.map(function (m) {\n            return {\n                m: m.metric,\n                v: m.value,\n                t: m.tags,\n                k: compactMetricType(m.type),\n                e: m.timestamp,\n            };\n        });\n    };\n    return CoreStats;\n}());\n\nvar NullStats = /** @class */ (function (_super) {\n    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__extends)(NullStats, _super);\n    function NullStats() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    NullStats.prototype.gauge = function () {\n        var _args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            _args[_i] = arguments[_i];\n        }\n    };\n    NullStats.prototype.increment = function () {\n        var _args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            _args[_i] = arguments[_i];\n        }\n    };\n    NullStats.prototype.flush = function () {\n        var _args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            _args[_i] = arguments[_i];\n        }\n    };\n    NullStats.prototype.serialize = function () {\n        var _args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            _args[_i] = arguments[_i];\n        }\n        return [];\n    };\n    return NullStats;\n}(CoreStats));\n\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUvZGlzdC9lc20vc3RhdHMvaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQTRDO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0Esd0RBQXdELFFBQVEsK0NBQVEsQ0FBQywrQ0FBUSxHQUFHLFFBQVEsd0JBQXdCLEtBQUs7QUFDekg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxDQUFDO0FBQ29CO0FBQ3JCO0FBQ0EsSUFBSSxnREFBUztBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsdUJBQXVCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsdUJBQXVCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsdUJBQXVCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsdUJBQXVCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ29CO0FBQ3JCIiwic291cmNlcyI6WyIvVXNlcnMvYXBwbGUvRGVza3RvcC9BZWxmIFByb2plY3RzL2FlbGYtY29kZS1nZW5lcmF0b3Ivbm9kZV9tb2R1bGVzL0BzZWdtZW50L2FuYWx5dGljcy1jb3JlL2Rpc3QvZXNtL3N0YXRzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IF9fYXNzaWduLCBfX2V4dGVuZHMgfSBmcm9tIFwidHNsaWJcIjtcbnZhciBjb21wYWN0TWV0cmljVHlwZSA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgdmFyIGVudW1zID0ge1xuICAgICAgICBnYXVnZTogJ2cnLFxuICAgICAgICBjb3VudGVyOiAnYycsXG4gICAgfTtcbiAgICByZXR1cm4gZW51bXNbdHlwZV07XG59O1xudmFyIENvcmVTdGF0cyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDb3JlU3RhdHMoKSB7XG4gICAgICAgIHRoaXMubWV0cmljcyA9IFtdO1xuICAgIH1cbiAgICBDb3JlU3RhdHMucHJvdG90eXBlLmluY3JlbWVudCA9IGZ1bmN0aW9uIChtZXRyaWMsIGJ5LCB0YWdzKSB7XG4gICAgICAgIGlmIChieSA9PT0gdm9pZCAwKSB7IGJ5ID0gMTsgfVxuICAgICAgICB0aGlzLm1ldHJpY3MucHVzaCh7XG4gICAgICAgICAgICBtZXRyaWM6IG1ldHJpYyxcbiAgICAgICAgICAgIHZhbHVlOiBieSxcbiAgICAgICAgICAgIHRhZ3M6IHRhZ3MgIT09IG51bGwgJiYgdGFncyAhPT0gdm9pZCAwID8gdGFncyA6IFtdLFxuICAgICAgICAgICAgdHlwZTogJ2NvdW50ZXInLFxuICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIENvcmVTdGF0cy5wcm90b3R5cGUuZ2F1Z2UgPSBmdW5jdGlvbiAobWV0cmljLCB2YWx1ZSwgdGFncykge1xuICAgICAgICB0aGlzLm1ldHJpY3MucHVzaCh7XG4gICAgICAgICAgICBtZXRyaWM6IG1ldHJpYyxcbiAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgICAgICAgIHRhZ3M6IHRhZ3MgIT09IG51bGwgJiYgdGFncyAhPT0gdm9pZCAwID8gdGFncyA6IFtdLFxuICAgICAgICAgICAgdHlwZTogJ2dhdWdlJyxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBDb3JlU3RhdHMucHJvdG90eXBlLmZsdXNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZm9ybWF0dGVkID0gdGhpcy5tZXRyaWNzLm1hcChmdW5jdGlvbiAobSkgeyByZXR1cm4gKF9fYXNzaWduKF9fYXNzaWduKHt9LCBtKSwgeyB0YWdzOiBtLnRhZ3Muam9pbignLCcpIH0pKTsgfSk7XG4gICAgICAgIC8vIGllIGRvZXNuJ3QgbGlrZSBjb25zb2xlLnRhYmxlXG4gICAgICAgIGlmIChjb25zb2xlLnRhYmxlKSB7XG4gICAgICAgICAgICBjb25zb2xlLnRhYmxlKGZvcm1hdHRlZCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhmb3JtYXR0ZWQpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubWV0cmljcyA9IFtdO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogY29tcGFjdCBrZXlzIGZvciBzbWFsbGVyIHBheWxvYWRcbiAgICAgKi9cbiAgICBDb3JlU3RhdHMucHJvdG90eXBlLnNlcmlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubWV0cmljcy5tYXAoZnVuY3Rpb24gKG0pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbTogbS5tZXRyaWMsXG4gICAgICAgICAgICAgICAgdjogbS52YWx1ZSxcbiAgICAgICAgICAgICAgICB0OiBtLnRhZ3MsXG4gICAgICAgICAgICAgICAgazogY29tcGFjdE1ldHJpY1R5cGUobS50eXBlKSxcbiAgICAgICAgICAgICAgICBlOiBtLnRpbWVzdGFtcCxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIENvcmVTdGF0cztcbn0oKSk7XG5leHBvcnQgeyBDb3JlU3RhdHMgfTtcbnZhciBOdWxsU3RhdHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKE51bGxTdGF0cywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBOdWxsU3RhdHMoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgTnVsbFN0YXRzLnByb3RvdHlwZS5nYXVnZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF9hcmdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBfYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBOdWxsU3RhdHMucHJvdG90eXBlLmluY3JlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF9hcmdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBfYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBOdWxsU3RhdHMucHJvdG90eXBlLmZsdXNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX2FyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIF9hcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE51bGxTdGF0cy5wcm90b3R5cGUuc2VyaWFsaXplID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX2FyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIF9hcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH07XG4gICAgcmV0dXJuIE51bGxTdGF0cztcbn0oQ29yZVN0YXRzKSk7XG5leHBvcnQgeyBOdWxsU3RhdHMgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-core/dist/esm/stats/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-core/dist/esm/task/task-group.js":
/*!**************************************************************************!*\
  !*** ./node_modules/@segment/analytics-core/dist/esm/task/task-group.js ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createTaskGroup: () => (/* binding */ createTaskGroup)\n/* harmony export */ });\n/* harmony import */ var _utils_is_thenable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/is-thenable */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/utils/is-thenable.js\");\n\nvar createTaskGroup = function () {\n    var taskCompletionPromise;\n    var resolvePromise;\n    var count = 0;\n    return {\n        done: function () { return taskCompletionPromise; },\n        run: function (op) {\n            var returnValue = op();\n            if ((0,_utils_is_thenable__WEBPACK_IMPORTED_MODULE_0__.isThenable)(returnValue)) {\n                if (++count === 1) {\n                    taskCompletionPromise = new Promise(function (res) { return (resolvePromise = res); });\n                }\n                returnValue.finally(function () { return --count === 0 && resolvePromise(); });\n            }\n            return returnValue;\n        },\n    };\n};\n//# sourceMappingURL=task-group.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUvZGlzdC9lc20vdGFzay90YXNrLWdyb3VwLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQWtEO0FBQzNDO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsK0JBQStCO0FBQzNEO0FBQ0E7QUFDQSxnQkFBZ0IsOERBQVU7QUFDMUI7QUFDQSx5RUFBeUUsZ0NBQWdDO0FBQ3pHO0FBQ0Esa0RBQWtELDJDQUEyQztBQUM3RjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiL1VzZXJzL2FwcGxlL0Rlc2t0b3AvQWVsZiBQcm9qZWN0cy9hZWxmLWNvZGUtZ2VuZXJhdG9yL25vZGVfbW9kdWxlcy9Ac2VnbWVudC9hbmFseXRpY3MtY29yZS9kaXN0L2VzbS90YXNrL3Rhc2stZ3JvdXAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXNUaGVuYWJsZSB9IGZyb20gJy4uL3V0aWxzL2lzLXRoZW5hYmxlJztcbmV4cG9ydCB2YXIgY3JlYXRlVGFza0dyb3VwID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0YXNrQ29tcGxldGlvblByb21pc2U7XG4gICAgdmFyIHJlc29sdmVQcm9taXNlO1xuICAgIHZhciBjb3VudCA9IDA7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZG9uZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGFza0NvbXBsZXRpb25Qcm9taXNlOyB9LFxuICAgICAgICBydW46IGZ1bmN0aW9uIChvcCkge1xuICAgICAgICAgICAgdmFyIHJldHVyblZhbHVlID0gb3AoKTtcbiAgICAgICAgICAgIGlmIChpc1RoZW5hYmxlKHJldHVyblZhbHVlKSkge1xuICAgICAgICAgICAgICAgIGlmICgrK2NvdW50ID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tDb21wbGV0aW9uUHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXMpIHsgcmV0dXJuIChyZXNvbHZlUHJvbWlzZSA9IHJlcyk7IH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm5WYWx1ZS5maW5hbGx5KGZ1bmN0aW9uICgpIHsgcmV0dXJuIC0tY291bnQgPT09IDAgJiYgcmVzb2x2ZVByb21pc2UoKTsgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0dXJuVmFsdWU7XG4gICAgICAgIH0sXG4gICAgfTtcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD10YXNrLWdyb3VwLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-core/dist/esm/task/task-group.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-core/dist/esm/utils/bind-all.js":
/*!*************************************************************************!*\
  !*** ./node_modules/@segment/analytics-core/dist/esm/utils/bind-all.js ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   bindAll: () => (/* binding */ bindAll)\n/* harmony export */ });\nfunction bindAll(obj) {\n    var proto = obj.constructor.prototype;\n    for (var _i = 0, _a = Object.getOwnPropertyNames(proto); _i < _a.length; _i++) {\n        var key = _a[_i];\n        if (key !== 'constructor') {\n            var desc = Object.getOwnPropertyDescriptor(obj.constructor.prototype, key);\n            if (!!desc && typeof desc.value === 'function') {\n                obj[key] = obj[key].bind(obj);\n            }\n        }\n    }\n    return obj;\n}\n//# sourceMappingURL=bind-all.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUvZGlzdC9lc20vdXRpbHMvYmluZC1hbGwuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFPO0FBQ1A7QUFDQSw2REFBNkQsZ0JBQWdCO0FBQzdFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIi9Vc2Vycy9hcHBsZS9EZXNrdG9wL0FlbGYgUHJvamVjdHMvYWVsZi1jb2RlLWdlbmVyYXRvci9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUvZGlzdC9lc20vdXRpbHMvYmluZC1hbGwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIGJpbmRBbGwob2JqKSB7XG4gICAgdmFyIHByb3RvID0gb2JqLmNvbnN0cnVjdG9yLnByb3RvdHlwZTtcbiAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMocHJvdG8pOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIga2V5ID0gX2FbX2ldO1xuICAgICAgICBpZiAoa2V5ICE9PSAnY29uc3RydWN0b3InKSB7XG4gICAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLmNvbnN0cnVjdG9yLnByb3RvdHlwZSwga2V5KTtcbiAgICAgICAgICAgIGlmICghIWRlc2MgJiYgdHlwZW9mIGRlc2MudmFsdWUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICBvYmpba2V5XSA9IG9ialtrZXldLmJpbmQob2JqKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb2JqO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YmluZC1hbGwuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-core/dist/esm/utils/bind-all.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-core/dist/esm/utils/group-by.js":
/*!*************************************************************************!*\
  !*** ./node_modules/@segment/analytics-core/dist/esm/utils/group-by.js ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   groupBy: () => (/* binding */ groupBy)\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ \"(ssr)/./node_modules/tslib/tslib.es6.mjs\");\n\nfunction groupBy(collection, grouper) {\n    var results = {};\n    collection.forEach(function (item) {\n        var _a;\n        var key = undefined;\n        if (typeof grouper === 'string') {\n            var suggestedKey = item[grouper];\n            key =\n                typeof suggestedKey !== 'string'\n                    ? JSON.stringify(suggestedKey)\n                    : suggestedKey;\n        }\n        else if (grouper instanceof Function) {\n            key = grouper(item);\n        }\n        if (key === undefined) {\n            return;\n        }\n        results[key] = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__spreadArray)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__spreadArray)([], ((_a = results[key]) !== null && _a !== void 0 ? _a : []), true), [item], false);\n    });\n    return results;\n}\n//# sourceMappingURL=group-by.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUvZGlzdC9lc20vdXRpbHMvZ3JvdXAtYnkuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBc0M7QUFDL0I7QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLG9EQUFhLENBQUMsb0RBQWE7QUFDbEQsS0FBSztBQUNMO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiL1VzZXJzL2FwcGxlL0Rlc2t0b3AvQWVsZiBQcm9qZWN0cy9hZWxmLWNvZGUtZ2VuZXJhdG9yL25vZGVfbW9kdWxlcy9Ac2VnbWVudC9hbmFseXRpY3MtY29yZS9kaXN0L2VzbS91dGlscy9ncm91cC1ieS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBfX3NwcmVhZEFycmF5IH0gZnJvbSBcInRzbGliXCI7XG5leHBvcnQgZnVuY3Rpb24gZ3JvdXBCeShjb2xsZWN0aW9uLCBncm91cGVyKSB7XG4gICAgdmFyIHJlc3VsdHMgPSB7fTtcbiAgICBjb2xsZWN0aW9uLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICB2YXIga2V5ID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAodHlwZW9mIGdyb3VwZXIgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB2YXIgc3VnZ2VzdGVkS2V5ID0gaXRlbVtncm91cGVyXTtcbiAgICAgICAgICAgIGtleSA9XG4gICAgICAgICAgICAgICAgdHlwZW9mIHN1Z2dlc3RlZEtleSAhPT0gJ3N0cmluZydcbiAgICAgICAgICAgICAgICAgICAgPyBKU09OLnN0cmluZ2lmeShzdWdnZXN0ZWRLZXkpXG4gICAgICAgICAgICAgICAgICAgIDogc3VnZ2VzdGVkS2V5O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGdyb3VwZXIgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xuICAgICAgICAgICAga2V5ID0gZ3JvdXBlcihpdGVtKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoa2V5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICByZXN1bHRzW2tleV0gPSBfX3NwcmVhZEFycmF5KF9fc3ByZWFkQXJyYXkoW10sICgoX2EgPSByZXN1bHRzW2tleV0pICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IFtdKSwgdHJ1ZSksIFtpdGVtXSwgZmFsc2UpO1xuICAgIH0pO1xuICAgIHJldHVybiByZXN1bHRzO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Z3JvdXAtYnkuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-core/dist/esm/utils/group-by.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-core/dist/esm/utils/is-thenable.js":
/*!****************************************************************************!*\
  !*** ./node_modules/@segment/analytics-core/dist/esm/utils/is-thenable.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   isThenable: () => (/* binding */ isThenable)\n/* harmony export */ });\n/**\n *  Check if  thenable\n *  (instanceof Promise doesn't respect realms)\n */\nvar isThenable = function (value) {\n    return typeof value === 'object' &&\n        value !== null &&\n        'then' in value &&\n        typeof value.then === 'function';\n};\n//# sourceMappingURL=is-thenable.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUvZGlzdC9lc20vdXRpbHMvaXMtdGhlbmFibGUuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIi9Vc2Vycy9hcHBsZS9EZXNrdG9wL0FlbGYgUHJvamVjdHMvYWVsZi1jb2RlLWdlbmVyYXRvci9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUvZGlzdC9lc20vdXRpbHMvaXMtdGhlbmFibGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiAgQ2hlY2sgaWYgIHRoZW5hYmxlXG4gKiAgKGluc3RhbmNlb2YgUHJvbWlzZSBkb2Vzbid0IHJlc3BlY3QgcmVhbG1zKVxuICovXG5leHBvcnQgdmFyIGlzVGhlbmFibGUgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJlxuICAgICAgICB2YWx1ZSAhPT0gbnVsbCAmJlxuICAgICAgICAndGhlbicgaW4gdmFsdWUgJiZcbiAgICAgICAgdHlwZW9mIHZhbHVlLnRoZW4gPT09ICdmdW5jdGlvbic7XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aXMtdGhlbmFibGUuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-core/dist/esm/utils/is-thenable.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-core/dist/esm/utils/pick.js":
/*!*********************************************************************!*\
  !*** ./node_modules/@segment/analytics-core/dist/esm/utils/pick.js ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   pickBy: () => (/* binding */ pickBy)\n/* harmony export */ });\nvar pickBy = function (obj, fn) {\n    return Object.keys(obj)\n        .filter(function (k) { return fn(k, obj[k]); })\n        .reduce(function (acc, key) { return ((acc[key] = obj[key]), acc); }, {});\n};\n//# sourceMappingURL=pick.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUvZGlzdC9lc20vdXRpbHMvcGljay5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQU87QUFDUDtBQUNBLCtCQUErQix1QkFBdUI7QUFDdEQsc0NBQXNDLHNDQUFzQyxJQUFJO0FBQ2hGO0FBQ0EiLCJzb3VyY2VzIjpbIi9Vc2Vycy9hcHBsZS9EZXNrdG9wL0FlbGYgUHJvamVjdHMvYWVsZi1jb2RlLWdlbmVyYXRvci9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUvZGlzdC9lc20vdXRpbHMvcGljay5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgdmFyIHBpY2tCeSA9IGZ1bmN0aW9uIChvYmosIGZuKSB7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKG9iailcbiAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoaykgeyByZXR1cm4gZm4oaywgb2JqW2tdKTsgfSlcbiAgICAgICAgLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBrZXkpIHsgcmV0dXJuICgoYWNjW2tleV0gPSBvYmpba2V5XSksIGFjYyk7IH0sIHt9KTtcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1waWNrLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-core/dist/esm/utils/pick.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-core/dist/esm/validation/assertions.js":
/*!********************************************************************************!*\
  !*** ./node_modules/@segment/analytics-core/dist/esm/validation/assertions.js ***!
  \********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   assertEventExists: () => (/* binding */ assertEventExists),\n/* harmony export */   assertEventType: () => (/* binding */ assertEventType),\n/* harmony export */   assertMessageId: () => (/* binding */ assertMessageId),\n/* harmony export */   assertTrackEventName: () => (/* binding */ assertTrackEventName),\n/* harmony export */   assertTrackEventProperties: () => (/* binding */ assertTrackEventProperties),\n/* harmony export */   assertTraits: () => (/* binding */ assertTraits),\n/* harmony export */   assertUserIdentity: () => (/* binding */ assertUserIdentity),\n/* harmony export */   validateEvent: () => (/* binding */ validateEvent)\n/* harmony export */ });\n/* harmony import */ var _errors__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./errors */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/validation/errors.js\");\n/* harmony import */ var _helpers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./helpers */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/validation/helpers.js\");\n\n\nvar stringError = 'is not a string';\nvar objError = 'is not an object';\nvar nilError = 'is nil';\n// user identity check could hypothetically could be used in the browser event factory, but not 100% sure -- so this is node only for now\nfunction assertUserIdentity(event) {\n    var USER_FIELD_NAME = '.userId/anonymousId/previousId/groupId';\n    var getAnyUserId = function (event) { var _a, _b, _c; return (_c = (_b = (_a = event.userId) !== null && _a !== void 0 ? _a : event.anonymousId) !== null && _b !== void 0 ? _b : event.groupId) !== null && _c !== void 0 ? _c : event.previousId; };\n    var id = getAnyUserId(event);\n    if (!(0,_helpers__WEBPACK_IMPORTED_MODULE_0__.exists)(id)) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_1__.ValidationError(USER_FIELD_NAME, nilError);\n    }\n    else if (!(0,_helpers__WEBPACK_IMPORTED_MODULE_0__.isString)(id)) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_1__.ValidationError(USER_FIELD_NAME, stringError);\n    }\n}\nfunction assertEventExists(event) {\n    if (!(0,_helpers__WEBPACK_IMPORTED_MODULE_0__.exists)(event)) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_1__.ValidationError('Event', nilError);\n    }\n    if (typeof event !== 'object') {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_1__.ValidationError('Event', objError);\n    }\n}\nfunction assertEventType(event) {\n    if (!(0,_helpers__WEBPACK_IMPORTED_MODULE_0__.isString)(event.type)) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_1__.ValidationError('.type', stringError);\n    }\n}\nfunction assertTrackEventName(event) {\n    if (!(0,_helpers__WEBPACK_IMPORTED_MODULE_0__.isString)(event.event)) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_1__.ValidationError('.event', stringError);\n    }\n}\nfunction assertTrackEventProperties(event) {\n    if (!(0,_helpers__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(event.properties)) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_1__.ValidationError('.properties', objError);\n    }\n}\nfunction assertTraits(event) {\n    if (!(0,_helpers__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(event.traits)) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_1__.ValidationError('.traits', objError);\n    }\n}\nfunction assertMessageId(event) {\n    if (!(0,_helpers__WEBPACK_IMPORTED_MODULE_0__.isString)(event.messageId)) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_1__.ValidationError('.messageId', stringError);\n    }\n}\nfunction validateEvent(event) {\n    assertEventExists(event);\n    assertEventType(event);\n    assertMessageId(event);\n    if (event.type === 'track') {\n        assertTrackEventName(event);\n        assertTrackEventProperties(event);\n    }\n    if (['group', 'identify'].includes(event.type)) {\n        assertTraits(event);\n    }\n}\n//# sourceMappingURL=assertions.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUvZGlzdC9lc20vdmFsaWRhdGlvbi9hc3NlcnRpb25zLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBMkM7QUFDaUI7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0EsMENBQTBDLGdCQUFnQjtBQUMxRDtBQUNBLFNBQVMsZ0RBQU07QUFDZixrQkFBa0Isb0RBQWU7QUFDakM7QUFDQSxjQUFjLGtEQUFRO0FBQ3RCLGtCQUFrQixvREFBZTtBQUNqQztBQUNBO0FBQ087QUFDUCxTQUFTLGdEQUFNO0FBQ2Ysa0JBQWtCLG9EQUFlO0FBQ2pDO0FBQ0E7QUFDQSxrQkFBa0Isb0RBQWU7QUFDakM7QUFDQTtBQUNPO0FBQ1AsU0FBUyxrREFBUTtBQUNqQixrQkFBa0Isb0RBQWU7QUFDakM7QUFDQTtBQUNPO0FBQ1AsU0FBUyxrREFBUTtBQUNqQixrQkFBa0Isb0RBQWU7QUFDakM7QUFDQTtBQUNPO0FBQ1AsU0FBUyx1REFBYTtBQUN0QixrQkFBa0Isb0RBQWU7QUFDakM7QUFDQTtBQUNPO0FBQ1AsU0FBUyx1REFBYTtBQUN0QixrQkFBa0Isb0RBQWU7QUFDakM7QUFDQTtBQUNPO0FBQ1AsU0FBUyxrREFBUTtBQUNqQixrQkFBa0Isb0RBQWU7QUFDakM7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyIvVXNlcnMvYXBwbGUvRGVza3RvcC9BZWxmIFByb2plY3RzL2FlbGYtY29kZS1nZW5lcmF0b3Ivbm9kZV9tb2R1bGVzL0BzZWdtZW50L2FuYWx5dGljcy1jb3JlL2Rpc3QvZXNtL3ZhbGlkYXRpb24vYXNzZXJ0aW9ucy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWYWxpZGF0aW9uRXJyb3IgfSBmcm9tICcuL2Vycm9ycyc7XG5pbXBvcnQgeyBpc1N0cmluZywgaXNQbGFpbk9iamVjdCwgZXhpc3RzIH0gZnJvbSAnLi9oZWxwZXJzJztcbnZhciBzdHJpbmdFcnJvciA9ICdpcyBub3QgYSBzdHJpbmcnO1xudmFyIG9iakVycm9yID0gJ2lzIG5vdCBhbiBvYmplY3QnO1xudmFyIG5pbEVycm9yID0gJ2lzIG5pbCc7XG4vLyB1c2VyIGlkZW50aXR5IGNoZWNrIGNvdWxkIGh5cG90aGV0aWNhbGx5IGNvdWxkIGJlIHVzZWQgaW4gdGhlIGJyb3dzZXIgZXZlbnQgZmFjdG9yeSwgYnV0IG5vdCAxMDAlIHN1cmUgLS0gc28gdGhpcyBpcyBub2RlIG9ubHkgZm9yIG5vd1xuZXhwb3J0IGZ1bmN0aW9uIGFzc2VydFVzZXJJZGVudGl0eShldmVudCkge1xuICAgIHZhciBVU0VSX0ZJRUxEX05BTUUgPSAnLnVzZXJJZC9hbm9ueW1vdXNJZC9wcmV2aW91c0lkL2dyb3VwSWQnO1xuICAgIHZhciBnZXRBbnlVc2VySWQgPSBmdW5jdGlvbiAoZXZlbnQpIHsgdmFyIF9hLCBfYiwgX2M7IHJldHVybiAoX2MgPSAoX2IgPSAoX2EgPSBldmVudC51c2VySWQpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IGV2ZW50LmFub255bW91c0lkKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBldmVudC5ncm91cElkKSAhPT0gbnVsbCAmJiBfYyAhPT0gdm9pZCAwID8gX2MgOiBldmVudC5wcmV2aW91c0lkOyB9O1xuICAgIHZhciBpZCA9IGdldEFueVVzZXJJZChldmVudCk7XG4gICAgaWYgKCFleGlzdHMoaWQpKSB7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoVVNFUl9GSUVMRF9OQU1FLCBuaWxFcnJvcik7XG4gICAgfVxuICAgIGVsc2UgaWYgKCFpc1N0cmluZyhpZCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihVU0VSX0ZJRUxEX05BTUUsIHN0cmluZ0Vycm9yKTtcbiAgICB9XG59XG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0RXZlbnRFeGlzdHMoZXZlbnQpIHtcbiAgICBpZiAoIWV4aXN0cyhldmVudCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcignRXZlbnQnLCBuaWxFcnJvcik7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgZXZlbnQgIT09ICdvYmplY3QnKSB7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoJ0V2ZW50Jywgb2JqRXJyb3IpO1xuICAgIH1cbn1cbmV4cG9ydCBmdW5jdGlvbiBhc3NlcnRFdmVudFR5cGUoZXZlbnQpIHtcbiAgICBpZiAoIWlzU3RyaW5nKGV2ZW50LnR5cGUpKSB7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoJy50eXBlJywgc3RyaW5nRXJyb3IpO1xuICAgIH1cbn1cbmV4cG9ydCBmdW5jdGlvbiBhc3NlcnRUcmFja0V2ZW50TmFtZShldmVudCkge1xuICAgIGlmICghaXNTdHJpbmcoZXZlbnQuZXZlbnQpKSB7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoJy5ldmVudCcsIHN0cmluZ0Vycm9yKTtcbiAgICB9XG59XG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0VHJhY2tFdmVudFByb3BlcnRpZXMoZXZlbnQpIHtcbiAgICBpZiAoIWlzUGxhaW5PYmplY3QoZXZlbnQucHJvcGVydGllcykpIHtcbiAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcignLnByb3BlcnRpZXMnLCBvYmpFcnJvcik7XG4gICAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIGFzc2VydFRyYWl0cyhldmVudCkge1xuICAgIGlmICghaXNQbGFpbk9iamVjdChldmVudC50cmFpdHMpKSB7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoJy50cmFpdHMnLCBvYmpFcnJvcik7XG4gICAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIGFzc2VydE1lc3NhZ2VJZChldmVudCkge1xuICAgIGlmICghaXNTdHJpbmcoZXZlbnQubWVzc2FnZUlkKSkge1xuICAgICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKCcubWVzc2FnZUlkJywgc3RyaW5nRXJyb3IpO1xuICAgIH1cbn1cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZUV2ZW50KGV2ZW50KSB7XG4gICAgYXNzZXJ0RXZlbnRFeGlzdHMoZXZlbnQpO1xuICAgIGFzc2VydEV2ZW50VHlwZShldmVudCk7XG4gICAgYXNzZXJ0TWVzc2FnZUlkKGV2ZW50KTtcbiAgICBpZiAoZXZlbnQudHlwZSA9PT0gJ3RyYWNrJykge1xuICAgICAgICBhc3NlcnRUcmFja0V2ZW50TmFtZShldmVudCk7XG4gICAgICAgIGFzc2VydFRyYWNrRXZlbnRQcm9wZXJ0aWVzKGV2ZW50KTtcbiAgICB9XG4gICAgaWYgKFsnZ3JvdXAnLCAnaWRlbnRpZnknXS5pbmNsdWRlcyhldmVudC50eXBlKSkge1xuICAgICAgICBhc3NlcnRUcmFpdHMoZXZlbnQpO1xuICAgIH1cbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFzc2VydGlvbnMuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-core/dist/esm/validation/assertions.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-core/dist/esm/validation/errors.js":
/*!****************************************************************************!*\
  !*** ./node_modules/@segment/analytics-core/dist/esm/validation/errors.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ValidationError: () => (/* binding */ ValidationError)\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ \"(ssr)/./node_modules/tslib/tslib.es6.mjs\");\n\nvar ValidationError = /** @class */ (function (_super) {\n    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__extends)(ValidationError, _super);\n    function ValidationError(field, message) {\n        var _this = _super.call(this, \"\".concat(field, \" \").concat(message)) || this;\n        _this.field = field;\n        return _this;\n    }\n    return ValidationError;\n}(Error));\n\n//# sourceMappingURL=errors.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUvZGlzdC9lc20vdmFsaWRhdGlvbi9lcnJvcnMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBa0M7QUFDbEM7QUFDQSxJQUFJLGdEQUFTO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUMwQjtBQUMzQiIsInNvdXJjZXMiOlsiL1VzZXJzL2FwcGxlL0Rlc2t0b3AvQWVsZiBQcm9qZWN0cy9hZWxmLWNvZGUtZ2VuZXJhdG9yL25vZGVfbW9kdWxlcy9Ac2VnbWVudC9hbmFseXRpY3MtY29yZS9kaXN0L2VzbS92YWxpZGF0aW9uL2Vycm9ycy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBfX2V4dGVuZHMgfSBmcm9tIFwidHNsaWJcIjtcbnZhciBWYWxpZGF0aW9uRXJyb3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFZhbGlkYXRpb25FcnJvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBWYWxpZGF0aW9uRXJyb3IoZmllbGQsIG1lc3NhZ2UpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgXCJcIi5jb25jYXQoZmllbGQsIFwiIFwiKS5jb25jYXQobWVzc2FnZSkpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmZpZWxkID0gZmllbGQ7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgcmV0dXJuIFZhbGlkYXRpb25FcnJvcjtcbn0oRXJyb3IpKTtcbmV4cG9ydCB7IFZhbGlkYXRpb25FcnJvciB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZXJyb3JzLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-core/dist/esm/validation/errors.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-core/dist/esm/validation/helpers.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/@segment/analytics-core/dist/esm/validation/helpers.js ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   exists: () => (/* binding */ exists),\n/* harmony export */   isFunction: () => (/* binding */ isFunction),\n/* harmony export */   isNumber: () => (/* binding */ isNumber),\n/* harmony export */   isPlainObject: () => (/* binding */ isPlainObject),\n/* harmony export */   isString: () => (/* binding */ isString)\n/* harmony export */ });\nfunction isString(obj) {\n    return typeof obj === 'string';\n}\nfunction isNumber(obj) {\n    return typeof obj === 'number';\n}\nfunction isFunction(obj) {\n    return typeof obj === 'function';\n}\nfunction exists(val) {\n    return val !== undefined && val !== null;\n}\nfunction isPlainObject(obj) {\n    return (Object.prototype.toString.call(obj).slice(8, -1).toLowerCase() === 'object');\n}\n//# sourceMappingURL=helpers.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUvZGlzdC9lc20vdmFsaWRhdGlvbi9oZWxwZXJzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQU87QUFDUDtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIi9Vc2Vycy9hcHBsZS9EZXNrdG9wL0FlbGYgUHJvamVjdHMvYWVsZi1jb2RlLWdlbmVyYXRvci9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUvZGlzdC9lc20vdmFsaWRhdGlvbi9oZWxwZXJzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBmdW5jdGlvbiBpc1N0cmluZyhvYmopIHtcbiAgICByZXR1cm4gdHlwZW9mIG9iaiA9PT0gJ3N0cmluZyc7XG59XG5leHBvcnQgZnVuY3Rpb24gaXNOdW1iZXIob2JqKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBvYmogPT09ICdudW1iZXInO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGlzRnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBvYmogPT09ICdmdW5jdGlvbic7XG59XG5leHBvcnQgZnVuY3Rpb24gZXhpc3RzKHZhbCkge1xuICAgIHJldHVybiB2YWwgIT09IHVuZGVmaW5lZCAmJiB2YWwgIT09IG51bGw7XG59XG5leHBvcnQgZnVuY3Rpb24gaXNQbGFpbk9iamVjdChvYmopIHtcbiAgICByZXR1cm4gKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvYmopLnNsaWNlKDgsIC0xKS50b0xvd2VyQ2FzZSgpID09PSAnb2JqZWN0Jyk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1oZWxwZXJzLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-core/dist/esm/validation/helpers.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-generic-utils/dist/esm/create-deferred/create-deferred.js":
/*!***************************************************************************************************!*\
  !*** ./node_modules/@segment/analytics-generic-utils/dist/esm/create-deferred/create-deferred.js ***!
  \***************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createDeferred: () => (/* binding */ createDeferred)\n/* harmony export */ });\n/**\n * Return a promise that can be externally resolved\n */\nvar createDeferred = function () {\n    var resolve;\n    var reject;\n    var settled = false;\n    var promise = new Promise(function (_resolve, _reject) {\n        resolve = function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            settled = true;\n            _resolve.apply(void 0, args);\n        };\n        reject = function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            settled = true;\n            _reject.apply(void 0, args);\n        };\n    });\n    return {\n        resolve: resolve,\n        reject: reject,\n        promise: promise,\n        isSettled: function () { return settled; },\n    };\n};\n//# sourceMappingURL=create-deferred.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWdlbmVyaWMtdXRpbHMvZGlzdC9lc20vY3JlYXRlLWRlZmVycmVkL2NyZWF0ZS1kZWZlcnJlZC5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsdUJBQXVCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLHVCQUF1QjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLGlCQUFpQjtBQUNsRDtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIi9Vc2Vycy9hcHBsZS9EZXNrdG9wL0FlbGYgUHJvamVjdHMvYWVsZi1jb2RlLWdlbmVyYXRvci9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWdlbmVyaWMtdXRpbHMvZGlzdC9lc20vY3JlYXRlLWRlZmVycmVkL2NyZWF0ZS1kZWZlcnJlZC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFJldHVybiBhIHByb21pc2UgdGhhdCBjYW4gYmUgZXh0ZXJuYWxseSByZXNvbHZlZFxuICovXG5leHBvcnQgdmFyIGNyZWF0ZURlZmVycmVkID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciByZXNvbHZlO1xuICAgIHZhciByZWplY3Q7XG4gICAgdmFyIHNldHRsZWQgPSBmYWxzZTtcbiAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChfcmVzb2x2ZSwgX3JlamVjdCkge1xuICAgICAgICByZXNvbHZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2V0dGxlZCA9IHRydWU7XG4gICAgICAgICAgICBfcmVzb2x2ZS5hcHBseSh2b2lkIDAsIGFyZ3MpO1xuICAgICAgICB9O1xuICAgICAgICByZWplY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZXR0bGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIF9yZWplY3QuYXBwbHkodm9pZCAwLCBhcmdzKTtcbiAgICAgICAgfTtcbiAgICB9KTtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXNvbHZlOiByZXNvbHZlLFxuICAgICAgICByZWplY3Q6IHJlamVjdCxcbiAgICAgICAgcHJvbWlzZTogcHJvbWlzZSxcbiAgICAgICAgaXNTZXR0bGVkOiBmdW5jdGlvbiAoKSB7IHJldHVybiBzZXR0bGVkOyB9LFxuICAgIH07XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y3JlYXRlLWRlZmVycmVkLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-generic-utils/dist/esm/create-deferred/create-deferred.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-generic-utils/dist/esm/emitter/emitter.js":
/*!***********************************************************************************!*\
  !*** ./node_modules/@segment/analytics-generic-utils/dist/esm/emitter/emitter.js ***!
  \***********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Emitter: () => (/* binding */ Emitter)\n/* harmony export */ });\n/**\n * Event Emitter that takes the expected contract as a generic\n * @example\n * ```ts\n *  type Contract = {\n *    delivery_success: [DeliverySuccessResponse, Metrics],\n *    delivery_failure: [DeliveryError]\n * }\n *  new Emitter<Contract>()\n *  .on('delivery_success', (res, metrics) => ...)\n *  .on('delivery_failure', (err) => ...)\n * ```\n */\nvar Emitter = /** @class */ (function () {\n    function Emitter(options) {\n        var _a;\n        this.callbacks = {};\n        this.warned = false;\n        this.maxListeners = (_a = options === null || options === void 0 ? void 0 : options.maxListeners) !== null && _a !== void 0 ? _a : 10;\n    }\n    Emitter.prototype.warnIfPossibleMemoryLeak = function (event) {\n        if (this.warned) {\n            return;\n        }\n        if (this.maxListeners &&\n            this.callbacks[event].length > this.maxListeners) {\n            console.warn(\"Event Emitter: Possible memory leak detected; \".concat(String(event), \" has exceeded \").concat(this.maxListeners, \" listeners.\"));\n            this.warned = true;\n        }\n    };\n    Emitter.prototype.on = function (event, callback) {\n        if (!this.callbacks[event]) {\n            this.callbacks[event] = [callback];\n        }\n        else {\n            this.callbacks[event].push(callback);\n            this.warnIfPossibleMemoryLeak(event);\n        }\n        return this;\n    };\n    Emitter.prototype.once = function (event, callback) {\n        var _this = this;\n        var on = function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            _this.off(event, on);\n            callback.apply(_this, args);\n        };\n        this.on(event, on);\n        return this;\n    };\n    Emitter.prototype.off = function (event, callback) {\n        var _a;\n        var fns = (_a = this.callbacks[event]) !== null && _a !== void 0 ? _a : [];\n        var without = fns.filter(function (fn) { return fn !== callback; });\n        this.callbacks[event] = without;\n        return this;\n    };\n    Emitter.prototype.emit = function (event) {\n        var _this = this;\n        var _a;\n        var args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            args[_i - 1] = arguments[_i];\n        }\n        var callbacks = (_a = this.callbacks[event]) !== null && _a !== void 0 ? _a : [];\n        callbacks.forEach(function (callback) {\n            callback.apply(_this, args);\n        });\n        return this;\n    };\n    return Emitter;\n}());\n\n//# sourceMappingURL=emitter.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWdlbmVyaWMtdXRpbHMvZGlzdC9lc20vZW1pdHRlci9lbWl0dGVyLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0VBQXdFO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsdUJBQXVCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQseUJBQXlCO0FBQzFFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHVCQUF1QjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDa0I7QUFDbkIiLCJzb3VyY2VzIjpbIi9Vc2Vycy9hcHBsZS9EZXNrdG9wL0FlbGYgUHJvamVjdHMvYWVsZi1jb2RlLWdlbmVyYXRvci9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLWdlbmVyaWMtdXRpbHMvZGlzdC9lc20vZW1pdHRlci9lbWl0dGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogRXZlbnQgRW1pdHRlciB0aGF0IHRha2VzIHRoZSBleHBlY3RlZCBjb250cmFjdCBhcyBhIGdlbmVyaWNcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogIHR5cGUgQ29udHJhY3QgPSB7XG4gKiAgICBkZWxpdmVyeV9zdWNjZXNzOiBbRGVsaXZlcnlTdWNjZXNzUmVzcG9uc2UsIE1ldHJpY3NdLFxuICogICAgZGVsaXZlcnlfZmFpbHVyZTogW0RlbGl2ZXJ5RXJyb3JdXG4gKiB9XG4gKiAgbmV3IEVtaXR0ZXI8Q29udHJhY3Q+KClcbiAqICAub24oJ2RlbGl2ZXJ5X3N1Y2Nlc3MnLCAocmVzLCBtZXRyaWNzKSA9PiAuLi4pXG4gKiAgLm9uKCdkZWxpdmVyeV9mYWlsdXJlJywgKGVycikgPT4gLi4uKVxuICogYGBgXG4gKi9cbnZhciBFbWl0dGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEVtaXR0ZXIob3B0aW9ucykge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHRoaXMuY2FsbGJhY2tzID0ge307XG4gICAgICAgIHRoaXMud2FybmVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMubWF4TGlzdGVuZXJzID0gKF9hID0gb3B0aW9ucyA9PT0gbnVsbCB8fCBvcHRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRpb25zLm1heExpc3RlbmVycykgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogMTA7XG4gICAgfVxuICAgIEVtaXR0ZXIucHJvdG90eXBlLndhcm5JZlBvc3NpYmxlTWVtb3J5TGVhayA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBpZiAodGhpcy53YXJuZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tYXhMaXN0ZW5lcnMgJiZcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tzW2V2ZW50XS5sZW5ndGggPiB0aGlzLm1heExpc3RlbmVycykge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKFwiRXZlbnQgRW1pdHRlcjogUG9zc2libGUgbWVtb3J5IGxlYWsgZGV0ZWN0ZWQ7IFwiLmNvbmNhdChTdHJpbmcoZXZlbnQpLCBcIiBoYXMgZXhjZWVkZWQgXCIpLmNvbmNhdCh0aGlzLm1heExpc3RlbmVycywgXCIgbGlzdGVuZXJzLlwiKSk7XG4gICAgICAgICAgICB0aGlzLndhcm5lZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEVtaXR0ZXIucHJvdG90eXBlLm9uID0gZnVuY3Rpb24gKGV2ZW50LCBjYWxsYmFjaykge1xuICAgICAgICBpZiAoIXRoaXMuY2FsbGJhY2tzW2V2ZW50XSkge1xuICAgICAgICAgICAgdGhpcy5jYWxsYmFja3NbZXZlbnRdID0gW2NhbGxiYWNrXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tzW2V2ZW50XS5wdXNoKGNhbGxiYWNrKTtcbiAgICAgICAgICAgIHRoaXMud2FybklmUG9zc2libGVNZW1vcnlMZWFrKGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIEVtaXR0ZXIucHJvdG90eXBlLm9uY2UgPSBmdW5jdGlvbiAoZXZlbnQsIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF90aGlzLm9mZihldmVudCwgb24pO1xuICAgICAgICAgICAgY2FsbGJhY2suYXBwbHkoX3RoaXMsIGFyZ3MpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLm9uKGV2ZW50LCBvbik7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgRW1pdHRlci5wcm90b3R5cGUub2ZmID0gZnVuY3Rpb24gKGV2ZW50LCBjYWxsYmFjaykge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHZhciBmbnMgPSAoX2EgPSB0aGlzLmNhbGxiYWNrc1tldmVudF0pICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IFtdO1xuICAgICAgICB2YXIgd2l0aG91dCA9IGZucy5maWx0ZXIoZnVuY3Rpb24gKGZuKSB7IHJldHVybiBmbiAhPT0gY2FsbGJhY2s7IH0pO1xuICAgICAgICB0aGlzLmNhbGxiYWNrc1tldmVudF0gPSB3aXRob3V0O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIEVtaXR0ZXIucHJvdG90eXBlLmVtaXQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2FsbGJhY2tzID0gKF9hID0gdGhpcy5jYWxsYmFja3NbZXZlbnRdKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBbXTtcbiAgICAgICAgY2FsbGJhY2tzLmZvckVhY2goZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICBjYWxsYmFjay5hcHBseShfdGhpcywgYXJncyk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIHJldHVybiBFbWl0dGVyO1xufSgpKTtcbmV4cG9ydCB7IEVtaXR0ZXIgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWVtaXR0ZXIuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-generic-utils/dist/esm/emitter/emitter.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-node/dist/esm/app/analytics-node.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/@segment/analytics-node/dist/esm/app/analytics-node.js ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Analytics: () => (/* binding */ Analytics)\n/* harmony export */ });\n/* harmony import */ var _segment_analytics_core__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @segment/analytics-core */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/utils/bind-all.js\");\n/* harmony import */ var _segment_analytics_core__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @segment/analytics-core */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/callback/index.js\");\n/* harmony import */ var _settings__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./settings */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/app/settings.js\");\n/* harmony import */ var _generated_version__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../generated/version */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/generated/version.js\");\n/* harmony import */ var _plugins_segmentio__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../plugins/segmentio */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/plugins/segmentio/index.js\");\n/* harmony import */ var _event_factory__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./event-factory */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/app/event-factory.js\");\n/* harmony import */ var _dispatch_emit__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./dispatch-emit */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/app/dispatch-emit.js\");\n/* harmony import */ var _emitter__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./emitter */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/app/emitter.js\");\n/* harmony import */ var _context__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./context */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/app/context.js\");\n/* harmony import */ var _event_queue__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./event-queue */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/app/event-queue.js\");\n/* harmony import */ var _lib_http_client__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../lib/http-client */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/http-client.js\");\n\n\n\n\n\n\n\n\n\n\nclass Analytics extends _emitter__WEBPACK_IMPORTED_MODULE_5__.NodeEmitter {\n    _eventFactory;\n    _isClosed = false;\n    _pendingEvents = 0;\n    _closeAndFlushDefaultTimeout;\n    _publisher;\n    _isFlushing = false;\n    _queue;\n    ready;\n    constructor(settings) {\n        super();\n        (0,_settings__WEBPACK_IMPORTED_MODULE_0__.validateSettings)(settings);\n        this._eventFactory = new _event_factory__WEBPACK_IMPORTED_MODULE_3__.NodeEventFactory();\n        this._queue = new _event_queue__WEBPACK_IMPORTED_MODULE_7__.NodeEventQueue();\n        const flushInterval = settings.flushInterval ?? 10000;\n        this._closeAndFlushDefaultTimeout = flushInterval * 1.25; // add arbitrary multiplier in case an event is in a plugin.\n        const { plugin, publisher } = (0,_plugins_segmentio__WEBPACK_IMPORTED_MODULE_2__.createConfiguredNodePlugin)({\n            writeKey: settings.writeKey,\n            host: settings.host,\n            path: settings.path,\n            maxRetries: settings.maxRetries ?? 3,\n            flushAt: settings.flushAt ?? settings.maxEventsInBatch ?? 15,\n            httpRequestTimeout: settings.httpRequestTimeout,\n            disable: settings.disable,\n            flushInterval,\n            httpClient: typeof settings.httpClient === 'function'\n                ? new _lib_http_client__WEBPACK_IMPORTED_MODULE_8__.FetchHTTPClient(settings.httpClient)\n                : settings.httpClient ?? new _lib_http_client__WEBPACK_IMPORTED_MODULE_8__.FetchHTTPClient(),\n            oauthSettings: settings.oauthSettings,\n        }, this);\n        this._publisher = publisher;\n        this.ready = this.register(plugin).then(() => undefined);\n        this.emit('initialize', settings);\n        (0,_segment_analytics_core__WEBPACK_IMPORTED_MODULE_9__.bindAll)(this);\n    }\n    get VERSION() {\n        return _generated_version__WEBPACK_IMPORTED_MODULE_1__.version;\n    }\n    /**\n     * Call this method to stop collecting new events and flush all existing events.\n     * This method also waits for any event method-specific callbacks to be triggered,\n     * and any of their subsequent promises to be resolved/rejected.\n     */\n    closeAndFlush({ timeout = this._closeAndFlushDefaultTimeout, } = {}) {\n        return this.flush({ timeout, close: true });\n    }\n    /**\n     * Call this method to flush all existing events..\n     * This method also waits for any event method-specific callbacks to be triggered,\n     * and any of their subsequent promises to be resolved/rejected.\n     */\n    async flush({ timeout, close = false, } = {}) {\n        if (this._isFlushing) {\n            // if we're already flushing, then we don't need to do anything\n            console.warn('Overlapping flush calls detected. Please wait for the previous flush to finish before calling .flush again');\n            return;\n        }\n        else {\n            this._isFlushing = true;\n        }\n        if (close) {\n            this._isClosed = true;\n        }\n        this._publisher.flush(this._pendingEvents);\n        const promise = new Promise((resolve) => {\n            if (!this._pendingEvents) {\n                resolve();\n            }\n            else {\n                this.once('drained', () => {\n                    resolve();\n                });\n            }\n        }).finally(() => {\n            this._isFlushing = false;\n        });\n        return timeout ? (0,_segment_analytics_core__WEBPACK_IMPORTED_MODULE_10__.pTimeout)(promise, timeout).catch(() => undefined) : promise;\n    }\n    _dispatch(segmentEvent, callback) {\n        if (this._isClosed) {\n            this.emit('call_after_close', segmentEvent);\n            return undefined;\n        }\n        this._pendingEvents++;\n        (0,_dispatch_emit__WEBPACK_IMPORTED_MODULE_4__.dispatchAndEmit)(segmentEvent, this._queue, this, callback)\n            .catch((ctx) => ctx)\n            .finally(() => {\n            this._pendingEvents--;\n            if (!this._pendingEvents) {\n                this.emit('drained');\n            }\n        });\n    }\n    /**\n     * Combines two unassociated user identities.\n     * @link https://segment.com/docs/connections/sources/catalog/libraries/server/node/#alias\n     */\n    alias({ userId, previousId, context, timestamp, integrations, messageId, }, callback) {\n        const segmentEvent = this._eventFactory.alias(userId, previousId, {\n            context,\n            integrations,\n            timestamp,\n            messageId,\n        });\n        this._dispatch(segmentEvent, callback);\n    }\n    /**\n     * Associates an identified user with a collective.\n     *  @link https://segment.com/docs/connections/sources/catalog/libraries/server/node/#group\n     */\n    group({ timestamp, groupId, userId, anonymousId, traits = {}, context, integrations, messageId, }, callback) {\n        const segmentEvent = this._eventFactory.group(groupId, traits, {\n            context,\n            anonymousId,\n            userId,\n            timestamp,\n            integrations,\n            messageId,\n        });\n        this._dispatch(segmentEvent, callback);\n    }\n    /**\n     * Includes a unique userId and (maybe anonymousId) and any optional traits you know about them.\n     * @link https://segment.com/docs/connections/sources/catalog/libraries/server/node/#identify\n     */\n    identify({ userId, anonymousId, traits = {}, context, timestamp, integrations, messageId, }, callback) {\n        const segmentEvent = this._eventFactory.identify(userId, traits, {\n            context,\n            anonymousId,\n            userId,\n            timestamp,\n            integrations,\n            messageId,\n        });\n        this._dispatch(segmentEvent, callback);\n    }\n    /**\n     * The page method lets you record page views on your website, along with optional extra information about the page being viewed.\n     * @link https://segment.com/docs/connections/sources/catalog/libraries/server/node/#page\n     */\n    page({ userId, anonymousId, category, name, properties, context, timestamp, integrations, messageId, }, callback) {\n        const segmentEvent = this._eventFactory.page(category ?? null, name ?? null, properties, { context, anonymousId, userId, timestamp, integrations, messageId });\n        this._dispatch(segmentEvent, callback);\n    }\n    /**\n     * Records screen views on your app, along with optional extra information\n     * about the screen viewed by the user.\n     *\n     * TODO: This is not documented on the segment docs ATM (for node).\n     */\n    screen({ userId, anonymousId, category, name, properties, context, timestamp, integrations, messageId, }, callback) {\n        const segmentEvent = this._eventFactory.screen(category ?? null, name ?? null, properties, { context, anonymousId, userId, timestamp, integrations, messageId });\n        this._dispatch(segmentEvent, callback);\n    }\n    /**\n     * Records actions your users perform.\n     * @link https://segment.com/docs/connections/sources/catalog/libraries/server/node/#track\n     */\n    track({ userId, anonymousId, event, properties, context, timestamp, integrations, messageId, }, callback) {\n        const segmentEvent = this._eventFactory.track(event, properties, {\n            context,\n            userId,\n            anonymousId,\n            timestamp,\n            integrations,\n            messageId,\n        });\n        this._dispatch(segmentEvent, callback);\n    }\n    /**\n     * Registers one or more plugins to augment Analytics functionality.\n     * @param plugins\n     */\n    register(...plugins) {\n        return this._queue.criticalTasks.run(async () => {\n            const ctx = _context__WEBPACK_IMPORTED_MODULE_6__.Context.system();\n            const registrations = plugins.map((xt) => this._queue.register(ctx, xt, this));\n            await Promise.all(registrations);\n            this.emit('register', plugins.map((el) => el.name));\n        });\n    }\n    /**\n     * Deregisters one or more plugins based on their names.\n     * @param pluginNames - The names of one or more plugins to deregister.\n     */\n    async deregister(...pluginNames) {\n        const ctx = _context__WEBPACK_IMPORTED_MODULE_6__.Context.system();\n        const deregistrations = pluginNames.map((pl) => {\n            const plugin = this._queue.plugins.find((p) => p.name === pl);\n            if (plugin) {\n                return this._queue.deregister(ctx, plugin, this);\n            }\n            else {\n                ctx.log('warn', `plugin ${pl} not found`);\n            }\n        });\n        await Promise.all(deregistrations);\n        this.emit('deregister', pluginNames);\n    }\n}\n//# sourceMappingURL=analytics-node.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vYXBwL2FuYWx5dGljcy1ub2RlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUE0RDtBQUNkO0FBQ0M7QUFDbUI7QUFDZjtBQUNEO0FBQ1Y7QUFDSjtBQUNXO0FBQ007QUFDOUMsd0JBQXdCLGlEQUFXO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSwyREFBZ0I7QUFDeEIsaUNBQWlDLDREQUFnQjtBQUNqRCwwQkFBMEIsd0RBQWM7QUFDeEM7QUFDQSxrRUFBa0U7QUFDbEUsZ0JBQWdCLG9CQUFvQixFQUFFLDhFQUEwQjtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsNkRBQWU7QUFDckMsNkNBQTZDLDZEQUFlO0FBQzVEO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFFBQVEsZ0VBQU87QUFDZjtBQUNBO0FBQ0EsZUFBZSx1REFBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsK0NBQStDLElBQUk7QUFDdkUsNEJBQTRCLHNCQUFzQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsMEJBQTBCLElBQUk7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1QseUJBQXlCLGtFQUFRO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSwrREFBZTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksa0VBQWtFO0FBQzlFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxvREFBb0QscUNBQXFDO0FBQ3JHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsZ0NBQWdDLGdEQUFnRDtBQUMvRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLCtGQUErRjtBQUMxRyxtR0FBbUcsa0VBQWtFO0FBQ3JLO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLCtGQUErRjtBQUM1RyxxR0FBcUcsa0VBQWtFO0FBQ3ZLO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksc0ZBQXNGO0FBQ2xHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsNkNBQU87QUFDL0I7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiw2Q0FBTztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsSUFBSTtBQUM5QztBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyIvVXNlcnMvYXBwbGUvRGVza3RvcC9BZWxmIFByb2plY3RzL2FlbGYtY29kZS1nZW5lcmF0b3Ivbm9kZV9tb2R1bGVzL0BzZWdtZW50L2FuYWx5dGljcy1ub2RlL2Rpc3QvZXNtL2FwcC9hbmFseXRpY3Mtbm9kZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBiaW5kQWxsLCBwVGltZW91dCB9IGZyb20gJ0BzZWdtZW50L2FuYWx5dGljcy1jb3JlJztcbmltcG9ydCB7IHZhbGlkYXRlU2V0dGluZ3MgfSBmcm9tICcuL3NldHRpbmdzJztcbmltcG9ydCB7IHZlcnNpb24gfSBmcm9tICcuLi9nZW5lcmF0ZWQvdmVyc2lvbic7XG5pbXBvcnQgeyBjcmVhdGVDb25maWd1cmVkTm9kZVBsdWdpbiB9IGZyb20gJy4uL3BsdWdpbnMvc2VnbWVudGlvJztcbmltcG9ydCB7IE5vZGVFdmVudEZhY3RvcnkgfSBmcm9tICcuL2V2ZW50LWZhY3RvcnknO1xuaW1wb3J0IHsgZGlzcGF0Y2hBbmRFbWl0IH0gZnJvbSAnLi9kaXNwYXRjaC1lbWl0JztcbmltcG9ydCB7IE5vZGVFbWl0dGVyIH0gZnJvbSAnLi9lbWl0dGVyJztcbmltcG9ydCB7IENvbnRleHQgfSBmcm9tICcuL2NvbnRleHQnO1xuaW1wb3J0IHsgTm9kZUV2ZW50UXVldWUgfSBmcm9tICcuL2V2ZW50LXF1ZXVlJztcbmltcG9ydCB7IEZldGNoSFRUUENsaWVudCB9IGZyb20gJy4uL2xpYi9odHRwLWNsaWVudCc7XG5leHBvcnQgY2xhc3MgQW5hbHl0aWNzIGV4dGVuZHMgTm9kZUVtaXR0ZXIge1xuICAgIF9ldmVudEZhY3Rvcnk7XG4gICAgX2lzQ2xvc2VkID0gZmFsc2U7XG4gICAgX3BlbmRpbmdFdmVudHMgPSAwO1xuICAgIF9jbG9zZUFuZEZsdXNoRGVmYXVsdFRpbWVvdXQ7XG4gICAgX3B1Ymxpc2hlcjtcbiAgICBfaXNGbHVzaGluZyA9IGZhbHNlO1xuICAgIF9xdWV1ZTtcbiAgICByZWFkeTtcbiAgICBjb25zdHJ1Y3RvcihzZXR0aW5ncykge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB2YWxpZGF0ZVNldHRpbmdzKHNldHRpbmdzKTtcbiAgICAgICAgdGhpcy5fZXZlbnRGYWN0b3J5ID0gbmV3IE5vZGVFdmVudEZhY3RvcnkoKTtcbiAgICAgICAgdGhpcy5fcXVldWUgPSBuZXcgTm9kZUV2ZW50UXVldWUoKTtcbiAgICAgICAgY29uc3QgZmx1c2hJbnRlcnZhbCA9IHNldHRpbmdzLmZsdXNoSW50ZXJ2YWwgPz8gMTAwMDA7XG4gICAgICAgIHRoaXMuX2Nsb3NlQW5kRmx1c2hEZWZhdWx0VGltZW91dCA9IGZsdXNoSW50ZXJ2YWwgKiAxLjI1OyAvLyBhZGQgYXJiaXRyYXJ5IG11bHRpcGxpZXIgaW4gY2FzZSBhbiBldmVudCBpcyBpbiBhIHBsdWdpbi5cbiAgICAgICAgY29uc3QgeyBwbHVnaW4sIHB1Ymxpc2hlciB9ID0gY3JlYXRlQ29uZmlndXJlZE5vZGVQbHVnaW4oe1xuICAgICAgICAgICAgd3JpdGVLZXk6IHNldHRpbmdzLndyaXRlS2V5LFxuICAgICAgICAgICAgaG9zdDogc2V0dGluZ3MuaG9zdCxcbiAgICAgICAgICAgIHBhdGg6IHNldHRpbmdzLnBhdGgsXG4gICAgICAgICAgICBtYXhSZXRyaWVzOiBzZXR0aW5ncy5tYXhSZXRyaWVzID8/IDMsXG4gICAgICAgICAgICBmbHVzaEF0OiBzZXR0aW5ncy5mbHVzaEF0ID8/IHNldHRpbmdzLm1heEV2ZW50c0luQmF0Y2ggPz8gMTUsXG4gICAgICAgICAgICBodHRwUmVxdWVzdFRpbWVvdXQ6IHNldHRpbmdzLmh0dHBSZXF1ZXN0VGltZW91dCxcbiAgICAgICAgICAgIGRpc2FibGU6IHNldHRpbmdzLmRpc2FibGUsXG4gICAgICAgICAgICBmbHVzaEludGVydmFsLFxuICAgICAgICAgICAgaHR0cENsaWVudDogdHlwZW9mIHNldHRpbmdzLmh0dHBDbGllbnQgPT09ICdmdW5jdGlvbidcbiAgICAgICAgICAgICAgICA/IG5ldyBGZXRjaEhUVFBDbGllbnQoc2V0dGluZ3MuaHR0cENsaWVudClcbiAgICAgICAgICAgICAgICA6IHNldHRpbmdzLmh0dHBDbGllbnQgPz8gbmV3IEZldGNoSFRUUENsaWVudCgpLFxuICAgICAgICAgICAgb2F1dGhTZXR0aW5nczogc2V0dGluZ3Mub2F1dGhTZXR0aW5ncyxcbiAgICAgICAgfSwgdGhpcyk7XG4gICAgICAgIHRoaXMuX3B1Ymxpc2hlciA9IHB1Ymxpc2hlcjtcbiAgICAgICAgdGhpcy5yZWFkeSA9IHRoaXMucmVnaXN0ZXIocGx1Z2luKS50aGVuKCgpID0+IHVuZGVmaW5lZCk7XG4gICAgICAgIHRoaXMuZW1pdCgnaW5pdGlhbGl6ZScsIHNldHRpbmdzKTtcbiAgICAgICAgYmluZEFsbCh0aGlzKTtcbiAgICB9XG4gICAgZ2V0IFZFUlNJT04oKSB7XG4gICAgICAgIHJldHVybiB2ZXJzaW9uO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsIHRoaXMgbWV0aG9kIHRvIHN0b3AgY29sbGVjdGluZyBuZXcgZXZlbnRzIGFuZCBmbHVzaCBhbGwgZXhpc3RpbmcgZXZlbnRzLlxuICAgICAqIFRoaXMgbWV0aG9kIGFsc28gd2FpdHMgZm9yIGFueSBldmVudCBtZXRob2Qtc3BlY2lmaWMgY2FsbGJhY2tzIHRvIGJlIHRyaWdnZXJlZCxcbiAgICAgKiBhbmQgYW55IG9mIHRoZWlyIHN1YnNlcXVlbnQgcHJvbWlzZXMgdG8gYmUgcmVzb2x2ZWQvcmVqZWN0ZWQuXG4gICAgICovXG4gICAgY2xvc2VBbmRGbHVzaCh7IHRpbWVvdXQgPSB0aGlzLl9jbG9zZUFuZEZsdXNoRGVmYXVsdFRpbWVvdXQsIH0gPSB7fSkge1xuICAgICAgICByZXR1cm4gdGhpcy5mbHVzaCh7IHRpbWVvdXQsIGNsb3NlOiB0cnVlIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsIHRoaXMgbWV0aG9kIHRvIGZsdXNoIGFsbCBleGlzdGluZyBldmVudHMuLlxuICAgICAqIFRoaXMgbWV0aG9kIGFsc28gd2FpdHMgZm9yIGFueSBldmVudCBtZXRob2Qtc3BlY2lmaWMgY2FsbGJhY2tzIHRvIGJlIHRyaWdnZXJlZCxcbiAgICAgKiBhbmQgYW55IG9mIHRoZWlyIHN1YnNlcXVlbnQgcHJvbWlzZXMgdG8gYmUgcmVzb2x2ZWQvcmVqZWN0ZWQuXG4gICAgICovXG4gICAgYXN5bmMgZmx1c2goeyB0aW1lb3V0LCBjbG9zZSA9IGZhbHNlLCB9ID0ge30pIHtcbiAgICAgICAgaWYgKHRoaXMuX2lzRmx1c2hpbmcpIHtcbiAgICAgICAgICAgIC8vIGlmIHdlJ3JlIGFscmVhZHkgZmx1c2hpbmcsIHRoZW4gd2UgZG9uJ3QgbmVlZCB0byBkbyBhbnl0aGluZ1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdPdmVybGFwcGluZyBmbHVzaCBjYWxscyBkZXRlY3RlZC4gUGxlYXNlIHdhaXQgZm9yIHRoZSBwcmV2aW91cyBmbHVzaCB0byBmaW5pc2ggYmVmb3JlIGNhbGxpbmcgLmZsdXNoIGFnYWluJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9pc0ZsdXNoaW5nID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2xvc2UpIHtcbiAgICAgICAgICAgIHRoaXMuX2lzQ2xvc2VkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9wdWJsaXNoZXIuZmx1c2godGhpcy5fcGVuZGluZ0V2ZW50cyk7XG4gICAgICAgIGNvbnN0IHByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9wZW5kaW5nRXZlbnRzKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbmNlKCdkcmFpbmVkJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5faXNGbHVzaGluZyA9IGZhbHNlO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRpbWVvdXQgPyBwVGltZW91dChwcm9taXNlLCB0aW1lb3V0KS5jYXRjaCgoKSA9PiB1bmRlZmluZWQpIDogcHJvbWlzZTtcbiAgICB9XG4gICAgX2Rpc3BhdGNoKHNlZ21lbnRFdmVudCwgY2FsbGJhY2spIHtcbiAgICAgICAgaWYgKHRoaXMuX2lzQ2xvc2VkKSB7XG4gICAgICAgICAgICB0aGlzLmVtaXQoJ2NhbGxfYWZ0ZXJfY2xvc2UnLCBzZWdtZW50RXZlbnQpO1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9wZW5kaW5nRXZlbnRzKys7XG4gICAgICAgIGRpc3BhdGNoQW5kRW1pdChzZWdtZW50RXZlbnQsIHRoaXMuX3F1ZXVlLCB0aGlzLCBjYWxsYmFjaylcbiAgICAgICAgICAgIC5jYXRjaCgoY3R4KSA9PiBjdHgpXG4gICAgICAgICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9wZW5kaW5nRXZlbnRzLS07XG4gICAgICAgICAgICBpZiAoIXRoaXMuX3BlbmRpbmdFdmVudHMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXQoJ2RyYWluZWQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbWJpbmVzIHR3byB1bmFzc29jaWF0ZWQgdXNlciBpZGVudGl0aWVzLlxuICAgICAqIEBsaW5rIGh0dHBzOi8vc2VnbWVudC5jb20vZG9jcy9jb25uZWN0aW9ucy9zb3VyY2VzL2NhdGFsb2cvbGlicmFyaWVzL3NlcnZlci9ub2RlLyNhbGlhc1xuICAgICAqL1xuICAgIGFsaWFzKHsgdXNlcklkLCBwcmV2aW91c0lkLCBjb250ZXh0LCB0aW1lc3RhbXAsIGludGVncmF0aW9ucywgbWVzc2FnZUlkLCB9LCBjYWxsYmFjaykge1xuICAgICAgICBjb25zdCBzZWdtZW50RXZlbnQgPSB0aGlzLl9ldmVudEZhY3RvcnkuYWxpYXModXNlcklkLCBwcmV2aW91c0lkLCB7XG4gICAgICAgICAgICBjb250ZXh0LFxuICAgICAgICAgICAgaW50ZWdyYXRpb25zLFxuICAgICAgICAgICAgdGltZXN0YW1wLFxuICAgICAgICAgICAgbWVzc2FnZUlkLFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fZGlzcGF0Y2goc2VnbWVudEV2ZW50LCBjYWxsYmFjayk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFzc29jaWF0ZXMgYW4gaWRlbnRpZmllZCB1c2VyIHdpdGggYSBjb2xsZWN0aXZlLlxuICAgICAqICBAbGluayBodHRwczovL3NlZ21lbnQuY29tL2RvY3MvY29ubmVjdGlvbnMvc291cmNlcy9jYXRhbG9nL2xpYnJhcmllcy9zZXJ2ZXIvbm9kZS8jZ3JvdXBcbiAgICAgKi9cbiAgICBncm91cCh7IHRpbWVzdGFtcCwgZ3JvdXBJZCwgdXNlcklkLCBhbm9ueW1vdXNJZCwgdHJhaXRzID0ge30sIGNvbnRleHQsIGludGVncmF0aW9ucywgbWVzc2FnZUlkLCB9LCBjYWxsYmFjaykge1xuICAgICAgICBjb25zdCBzZWdtZW50RXZlbnQgPSB0aGlzLl9ldmVudEZhY3RvcnkuZ3JvdXAoZ3JvdXBJZCwgdHJhaXRzLCB7XG4gICAgICAgICAgICBjb250ZXh0LFxuICAgICAgICAgICAgYW5vbnltb3VzSWQsXG4gICAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgICB0aW1lc3RhbXAsXG4gICAgICAgICAgICBpbnRlZ3JhdGlvbnMsXG4gICAgICAgICAgICBtZXNzYWdlSWQsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9kaXNwYXRjaChzZWdtZW50RXZlbnQsIGNhbGxiYWNrKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW5jbHVkZXMgYSB1bmlxdWUgdXNlcklkIGFuZCAobWF5YmUgYW5vbnltb3VzSWQpIGFuZCBhbnkgb3B0aW9uYWwgdHJhaXRzIHlvdSBrbm93IGFib3V0IHRoZW0uXG4gICAgICogQGxpbmsgaHR0cHM6Ly9zZWdtZW50LmNvbS9kb2NzL2Nvbm5lY3Rpb25zL3NvdXJjZXMvY2F0YWxvZy9saWJyYXJpZXMvc2VydmVyL25vZGUvI2lkZW50aWZ5XG4gICAgICovXG4gICAgaWRlbnRpZnkoeyB1c2VySWQsIGFub255bW91c0lkLCB0cmFpdHMgPSB7fSwgY29udGV4dCwgdGltZXN0YW1wLCBpbnRlZ3JhdGlvbnMsIG1lc3NhZ2VJZCwgfSwgY2FsbGJhY2spIHtcbiAgICAgICAgY29uc3Qgc2VnbWVudEV2ZW50ID0gdGhpcy5fZXZlbnRGYWN0b3J5LmlkZW50aWZ5KHVzZXJJZCwgdHJhaXRzLCB7XG4gICAgICAgICAgICBjb250ZXh0LFxuICAgICAgICAgICAgYW5vbnltb3VzSWQsXG4gICAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgICB0aW1lc3RhbXAsXG4gICAgICAgICAgICBpbnRlZ3JhdGlvbnMsXG4gICAgICAgICAgICBtZXNzYWdlSWQsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9kaXNwYXRjaChzZWdtZW50RXZlbnQsIGNhbGxiYWNrKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIHBhZ2UgbWV0aG9kIGxldHMgeW91IHJlY29yZCBwYWdlIHZpZXdzIG9uIHlvdXIgd2Vic2l0ZSwgYWxvbmcgd2l0aCBvcHRpb25hbCBleHRyYSBpbmZvcm1hdGlvbiBhYm91dCB0aGUgcGFnZSBiZWluZyB2aWV3ZWQuXG4gICAgICogQGxpbmsgaHR0cHM6Ly9zZWdtZW50LmNvbS9kb2NzL2Nvbm5lY3Rpb25zL3NvdXJjZXMvY2F0YWxvZy9saWJyYXJpZXMvc2VydmVyL25vZGUvI3BhZ2VcbiAgICAgKi9cbiAgICBwYWdlKHsgdXNlcklkLCBhbm9ueW1vdXNJZCwgY2F0ZWdvcnksIG5hbWUsIHByb3BlcnRpZXMsIGNvbnRleHQsIHRpbWVzdGFtcCwgaW50ZWdyYXRpb25zLCBtZXNzYWdlSWQsIH0sIGNhbGxiYWNrKSB7XG4gICAgICAgIGNvbnN0IHNlZ21lbnRFdmVudCA9IHRoaXMuX2V2ZW50RmFjdG9yeS5wYWdlKGNhdGVnb3J5ID8/IG51bGwsIG5hbWUgPz8gbnVsbCwgcHJvcGVydGllcywgeyBjb250ZXh0LCBhbm9ueW1vdXNJZCwgdXNlcklkLCB0aW1lc3RhbXAsIGludGVncmF0aW9ucywgbWVzc2FnZUlkIH0pO1xuICAgICAgICB0aGlzLl9kaXNwYXRjaChzZWdtZW50RXZlbnQsIGNhbGxiYWNrKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVjb3JkcyBzY3JlZW4gdmlld3Mgb24geW91ciBhcHAsIGFsb25nIHdpdGggb3B0aW9uYWwgZXh0cmEgaW5mb3JtYXRpb25cbiAgICAgKiBhYm91dCB0aGUgc2NyZWVuIHZpZXdlZCBieSB0aGUgdXNlci5cbiAgICAgKlxuICAgICAqIFRPRE86IFRoaXMgaXMgbm90IGRvY3VtZW50ZWQgb24gdGhlIHNlZ21lbnQgZG9jcyBBVE0gKGZvciBub2RlKS5cbiAgICAgKi9cbiAgICBzY3JlZW4oeyB1c2VySWQsIGFub255bW91c0lkLCBjYXRlZ29yeSwgbmFtZSwgcHJvcGVydGllcywgY29udGV4dCwgdGltZXN0YW1wLCBpbnRlZ3JhdGlvbnMsIG1lc3NhZ2VJZCwgfSwgY2FsbGJhY2spIHtcbiAgICAgICAgY29uc3Qgc2VnbWVudEV2ZW50ID0gdGhpcy5fZXZlbnRGYWN0b3J5LnNjcmVlbihjYXRlZ29yeSA/PyBudWxsLCBuYW1lID8/IG51bGwsIHByb3BlcnRpZXMsIHsgY29udGV4dCwgYW5vbnltb3VzSWQsIHVzZXJJZCwgdGltZXN0YW1wLCBpbnRlZ3JhdGlvbnMsIG1lc3NhZ2VJZCB9KTtcbiAgICAgICAgdGhpcy5fZGlzcGF0Y2goc2VnbWVudEV2ZW50LCBjYWxsYmFjayk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlY29yZHMgYWN0aW9ucyB5b3VyIHVzZXJzIHBlcmZvcm0uXG4gICAgICogQGxpbmsgaHR0cHM6Ly9zZWdtZW50LmNvbS9kb2NzL2Nvbm5lY3Rpb25zL3NvdXJjZXMvY2F0YWxvZy9saWJyYXJpZXMvc2VydmVyL25vZGUvI3RyYWNrXG4gICAgICovXG4gICAgdHJhY2soeyB1c2VySWQsIGFub255bW91c0lkLCBldmVudCwgcHJvcGVydGllcywgY29udGV4dCwgdGltZXN0YW1wLCBpbnRlZ3JhdGlvbnMsIG1lc3NhZ2VJZCwgfSwgY2FsbGJhY2spIHtcbiAgICAgICAgY29uc3Qgc2VnbWVudEV2ZW50ID0gdGhpcy5fZXZlbnRGYWN0b3J5LnRyYWNrKGV2ZW50LCBwcm9wZXJ0aWVzLCB7XG4gICAgICAgICAgICBjb250ZXh0LFxuICAgICAgICAgICAgdXNlcklkLFxuICAgICAgICAgICAgYW5vbnltb3VzSWQsXG4gICAgICAgICAgICB0aW1lc3RhbXAsXG4gICAgICAgICAgICBpbnRlZ3JhdGlvbnMsXG4gICAgICAgICAgICBtZXNzYWdlSWQsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9kaXNwYXRjaChzZWdtZW50RXZlbnQsIGNhbGxiYWNrKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVnaXN0ZXJzIG9uZSBvciBtb3JlIHBsdWdpbnMgdG8gYXVnbWVudCBBbmFseXRpY3MgZnVuY3Rpb25hbGl0eS5cbiAgICAgKiBAcGFyYW0gcGx1Z2luc1xuICAgICAqL1xuICAgIHJlZ2lzdGVyKC4uLnBsdWdpbnMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3F1ZXVlLmNyaXRpY2FsVGFza3MucnVuKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGN0eCA9IENvbnRleHQuc3lzdGVtKCk7XG4gICAgICAgICAgICBjb25zdCByZWdpc3RyYXRpb25zID0gcGx1Z2lucy5tYXAoKHh0KSA9PiB0aGlzLl9xdWV1ZS5yZWdpc3RlcihjdHgsIHh0LCB0aGlzKSk7XG4gICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChyZWdpc3RyYXRpb25zKTtcbiAgICAgICAgICAgIHRoaXMuZW1pdCgncmVnaXN0ZXInLCBwbHVnaW5zLm1hcCgoZWwpID0+IGVsLm5hbWUpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERlcmVnaXN0ZXJzIG9uZSBvciBtb3JlIHBsdWdpbnMgYmFzZWQgb24gdGhlaXIgbmFtZXMuXG4gICAgICogQHBhcmFtIHBsdWdpbk5hbWVzIC0gVGhlIG5hbWVzIG9mIG9uZSBvciBtb3JlIHBsdWdpbnMgdG8gZGVyZWdpc3Rlci5cbiAgICAgKi9cbiAgICBhc3luYyBkZXJlZ2lzdGVyKC4uLnBsdWdpbk5hbWVzKSB7XG4gICAgICAgIGNvbnN0IGN0eCA9IENvbnRleHQuc3lzdGVtKCk7XG4gICAgICAgIGNvbnN0IGRlcmVnaXN0cmF0aW9ucyA9IHBsdWdpbk5hbWVzLm1hcCgocGwpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHBsdWdpbiA9IHRoaXMuX3F1ZXVlLnBsdWdpbnMuZmluZCgocCkgPT4gcC5uYW1lID09PSBwbCk7XG4gICAgICAgICAgICBpZiAocGx1Z2luKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3F1ZXVlLmRlcmVnaXN0ZXIoY3R4LCBwbHVnaW4sIHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY3R4LmxvZygnd2FybicsIGBwbHVnaW4gJHtwbH0gbm90IGZvdW5kYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChkZXJlZ2lzdHJhdGlvbnMpO1xuICAgICAgICB0aGlzLmVtaXQoJ2RlcmVnaXN0ZXInLCBwbHVnaW5OYW1lcyk7XG4gICAgfVxufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YW5hbHl0aWNzLW5vZGUuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-node/dist/esm/app/analytics-node.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-node/dist/esm/app/context.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@segment/analytics-node/dist/esm/app/context.js ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Context: () => (/* binding */ Context)\n/* harmony export */ });\n/* harmony import */ var _segment_analytics_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @segment/analytics-core */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/context/index.js\");\n// create a derived class since we may want to add node specific things to Context later\n\n// While this is not a type, it is a definition\nclass Context extends _segment_analytics_core__WEBPACK_IMPORTED_MODULE_0__.CoreContext {\n    static system() {\n        return new this({ type: 'track', event: 'system' });\n    }\n}\n//# sourceMappingURL=context.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vYXBwL2NvbnRleHQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTtBQUNzRDtBQUN0RDtBQUNPLHNCQUFzQixnRUFBVztBQUN4QztBQUNBLDBCQUEwQixnQ0FBZ0M7QUFDMUQ7QUFDQTtBQUNBIiwic291cmNlcyI6WyIvVXNlcnMvYXBwbGUvRGVza3RvcC9BZWxmIFByb2plY3RzL2FlbGYtY29kZS1nZW5lcmF0b3Ivbm9kZV9tb2R1bGVzL0BzZWdtZW50L2FuYWx5dGljcy1ub2RlL2Rpc3QvZXNtL2FwcC9jb250ZXh0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGNyZWF0ZSBhIGRlcml2ZWQgY2xhc3Mgc2luY2Ugd2UgbWF5IHdhbnQgdG8gYWRkIG5vZGUgc3BlY2lmaWMgdGhpbmdzIHRvIENvbnRleHQgbGF0ZXJcbmltcG9ydCB7IENvcmVDb250ZXh0IH0gZnJvbSAnQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUnO1xuLy8gV2hpbGUgdGhpcyBpcyBub3QgYSB0eXBlLCBpdCBpcyBhIGRlZmluaXRpb25cbmV4cG9ydCBjbGFzcyBDb250ZXh0IGV4dGVuZHMgQ29yZUNvbnRleHQge1xuICAgIHN0YXRpYyBzeXN0ZW0oKSB7XG4gICAgICAgIHJldHVybiBuZXcgdGhpcyh7IHR5cGU6ICd0cmFjaycsIGV2ZW50OiAnc3lzdGVtJyB9KTtcbiAgICB9XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb250ZXh0LmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-node/dist/esm/app/context.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-node/dist/esm/app/dispatch-emit.js":
/*!****************************************************************************!*\
  !*** ./node_modules/@segment/analytics-node/dist/esm/app/dispatch-emit.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   dispatchAndEmit: () => (/* binding */ dispatchAndEmit)\n/* harmony export */ });\n/* harmony import */ var _segment_analytics_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @segment/analytics-core */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/analytics/dispatch.js\");\n/* harmony import */ var _context__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./context */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/app/context.js\");\n\n\nconst normalizeDispatchCb = (cb) => (ctx) => {\n    const failedDelivery = ctx.failedDelivery();\n    return failedDelivery ? cb(failedDelivery.reason, ctx) : cb(undefined, ctx);\n};\n/* Dispatch function, but swallow promise rejections and use event emitter instead */\nconst dispatchAndEmit = async (event, queue, emitter, callback) => {\n    try {\n        const context = new _context__WEBPACK_IMPORTED_MODULE_0__.Context(event);\n        const ctx = await (0,_segment_analytics_core__WEBPACK_IMPORTED_MODULE_1__.dispatch)(context, queue, emitter, {\n            ...(callback ? { callback: normalizeDispatchCb(callback) } : {}),\n        });\n        const failedDelivery = ctx.failedDelivery();\n        if (failedDelivery) {\n            emitter.emit('error', {\n                code: 'delivery_failure',\n                reason: failedDelivery.reason,\n                ctx: ctx,\n            });\n        }\n        else {\n            emitter.emit(event.type, ctx);\n        }\n    }\n    catch (err) {\n        emitter.emit('error', {\n            code: 'unknown',\n            reason: err,\n        });\n    }\n};\n//# sourceMappingURL=dispatch-emit.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vYXBwL2Rpc3BhdGNoLWVtaXQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQW1EO0FBQ2Y7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQSw0QkFBNEIsNkNBQU87QUFDbkMsMEJBQTBCLGlFQUFRO0FBQ2xDLDZCQUE2QiwwQ0FBMEMsSUFBSTtBQUMzRSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIi9Vc2Vycy9hcHBsZS9EZXNrdG9wL0FlbGYgUHJvamVjdHMvYWVsZi1jb2RlLWdlbmVyYXRvci9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vYXBwL2Rpc3BhdGNoLWVtaXQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGlzcGF0Y2ggfSBmcm9tICdAc2VnbWVudC9hbmFseXRpY3MtY29yZSc7XG5pbXBvcnQgeyBDb250ZXh0IH0gZnJvbSAnLi9jb250ZXh0JztcbmNvbnN0IG5vcm1hbGl6ZURpc3BhdGNoQ2IgPSAoY2IpID0+IChjdHgpID0+IHtcbiAgICBjb25zdCBmYWlsZWREZWxpdmVyeSA9IGN0eC5mYWlsZWREZWxpdmVyeSgpO1xuICAgIHJldHVybiBmYWlsZWREZWxpdmVyeSA/IGNiKGZhaWxlZERlbGl2ZXJ5LnJlYXNvbiwgY3R4KSA6IGNiKHVuZGVmaW5lZCwgY3R4KTtcbn07XG4vKiBEaXNwYXRjaCBmdW5jdGlvbiwgYnV0IHN3YWxsb3cgcHJvbWlzZSByZWplY3Rpb25zIGFuZCB1c2UgZXZlbnQgZW1pdHRlciBpbnN0ZWFkICovXG5leHBvcnQgY29uc3QgZGlzcGF0Y2hBbmRFbWl0ID0gYXN5bmMgKGV2ZW50LCBxdWV1ZSwgZW1pdHRlciwgY2FsbGJhY2spID0+IHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBjb250ZXh0ID0gbmV3IENvbnRleHQoZXZlbnQpO1xuICAgICAgICBjb25zdCBjdHggPSBhd2FpdCBkaXNwYXRjaChjb250ZXh0LCBxdWV1ZSwgZW1pdHRlciwge1xuICAgICAgICAgICAgLi4uKGNhbGxiYWNrID8geyBjYWxsYmFjazogbm9ybWFsaXplRGlzcGF0Y2hDYihjYWxsYmFjaykgfSA6IHt9KSxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGZhaWxlZERlbGl2ZXJ5ID0gY3R4LmZhaWxlZERlbGl2ZXJ5KCk7XG4gICAgICAgIGlmIChmYWlsZWREZWxpdmVyeSkge1xuICAgICAgICAgICAgZW1pdHRlci5lbWl0KCdlcnJvcicsIHtcbiAgICAgICAgICAgICAgICBjb2RlOiAnZGVsaXZlcnlfZmFpbHVyZScsXG4gICAgICAgICAgICAgICAgcmVhc29uOiBmYWlsZWREZWxpdmVyeS5yZWFzb24sXG4gICAgICAgICAgICAgICAgY3R4OiBjdHgsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGVtaXR0ZXIuZW1pdChldmVudC50eXBlLCBjdHgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgZW1pdHRlci5lbWl0KCdlcnJvcicsIHtcbiAgICAgICAgICAgIGNvZGU6ICd1bmtub3duJyxcbiAgICAgICAgICAgIHJlYXNvbjogZXJyLFxuICAgICAgICB9KTtcbiAgICB9XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGlzcGF0Y2gtZW1pdC5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-node/dist/esm/app/dispatch-emit.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-node/dist/esm/app/emitter.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@segment/analytics-node/dist/esm/app/emitter.js ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   NodeEmitter: () => (/* binding */ NodeEmitter)\n/* harmony export */ });\n/* harmony import */ var _segment_analytics_generic_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @segment/analytics-generic-utils */ \"(ssr)/./node_modules/@segment/analytics-generic-utils/dist/esm/emitter/emitter.js\");\n\nclass NodeEmitter extends _segment_analytics_generic_utils__WEBPACK_IMPORTED_MODULE_0__.Emitter {\n}\n//# sourceMappingURL=emitter.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vYXBwL2VtaXR0ZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBMkQ7QUFDcEQsMEJBQTBCLHFFQUFPO0FBQ3hDO0FBQ0EiLCJzb3VyY2VzIjpbIi9Vc2Vycy9hcHBsZS9EZXNrdG9wL0FlbGYgUHJvamVjdHMvYWVsZi1jb2RlLWdlbmVyYXRvci9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vYXBwL2VtaXR0ZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRW1pdHRlciB9IGZyb20gJ0BzZWdtZW50L2FuYWx5dGljcy1nZW5lcmljLXV0aWxzJztcbmV4cG9ydCBjbGFzcyBOb2RlRW1pdHRlciBleHRlbmRzIEVtaXR0ZXIge1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZW1pdHRlci5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-node/dist/esm/app/emitter.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-node/dist/esm/app/event-factory.js":
/*!****************************************************************************!*\
  !*** ./node_modules/@segment/analytics-node/dist/esm/app/event-factory.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   NodeEventFactory: () => (/* binding */ NodeEventFactory)\n/* harmony export */ });\n/* harmony import */ var _segment_analytics_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @segment/analytics-core */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/events/index.js\");\n/* harmony import */ var _segment_analytics_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @segment/analytics-core */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/validation/assertions.js\");\n/* harmony import */ var _lib_get_message_id__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/get-message-id */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/get-message-id.js\");\n\n\nclass NodeEventFactory extends _segment_analytics_core__WEBPACK_IMPORTED_MODULE_1__.CoreEventFactory {\n    constructor() {\n        super({\n            createMessageId: _lib_get_message_id__WEBPACK_IMPORTED_MODULE_0__.createMessageId,\n            onFinishedEvent: (event) => {\n                (0,_segment_analytics_core__WEBPACK_IMPORTED_MODULE_2__.assertUserIdentity)(event);\n            },\n        });\n    }\n}\n//# sourceMappingURL=event-factory.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vYXBwL2V2ZW50LWZhY3RvcnkuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUErRTtBQUN2QjtBQUNqRCwrQkFBK0IscUVBQWdCO0FBQ3REO0FBQ0E7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQSxnQkFBZ0IsMkVBQWtCO0FBQ2xDLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBIiwic291cmNlcyI6WyIvVXNlcnMvYXBwbGUvRGVza3RvcC9BZWxmIFByb2plY3RzL2FlbGYtY29kZS1nZW5lcmF0b3Ivbm9kZV9tb2R1bGVzL0BzZWdtZW50L2FuYWx5dGljcy1ub2RlL2Rpc3QvZXNtL2FwcC9ldmVudC1mYWN0b3J5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGFzc2VydFVzZXJJZGVudGl0eSwgQ29yZUV2ZW50RmFjdG9yeSB9IGZyb20gJ0BzZWdtZW50L2FuYWx5dGljcy1jb3JlJztcbmltcG9ydCB7IGNyZWF0ZU1lc3NhZ2VJZCB9IGZyb20gJy4uL2xpYi9nZXQtbWVzc2FnZS1pZCc7XG5leHBvcnQgY2xhc3MgTm9kZUV2ZW50RmFjdG9yeSBleHRlbmRzIENvcmVFdmVudEZhY3Rvcnkge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcih7XG4gICAgICAgICAgICBjcmVhdGVNZXNzYWdlSWQsXG4gICAgICAgICAgICBvbkZpbmlzaGVkRXZlbnQ6IChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGFzc2VydFVzZXJJZGVudGl0eShldmVudCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICB9XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1ldmVudC1mYWN0b3J5LmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-node/dist/esm/app/event-factory.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-node/dist/esm/app/event-queue.js":
/*!**************************************************************************!*\
  !*** ./node_modules/@segment/analytics-node/dist/esm/app/event-queue.js ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   NodeEventQueue: () => (/* binding */ NodeEventQueue)\n/* harmony export */ });\n/* harmony import */ var _segment_analytics_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @segment/analytics-core */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/priority-queue/index.js\");\n/* harmony import */ var _segment_analytics_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @segment/analytics-core */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/queue/event-queue.js\");\n\nclass NodePriorityQueue extends _segment_analytics_core__WEBPACK_IMPORTED_MODULE_0__.PriorityQueue {\n    constructor() {\n        super(1, []);\n    }\n    // do not use an internal \"seen\" map\n    getAttempts(ctx) {\n        return ctx.attempts ?? 0;\n    }\n    updateAttempts(ctx) {\n        ctx.attempts = this.getAttempts(ctx) + 1;\n        return this.getAttempts(ctx);\n    }\n}\nclass NodeEventQueue extends _segment_analytics_core__WEBPACK_IMPORTED_MODULE_1__.CoreEventQueue {\n    constructor() {\n        super(new NodePriorityQueue());\n    }\n}\n//# sourceMappingURL=event-queue.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vYXBwL2V2ZW50LXF1ZXVlLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUF3RTtBQUN4RSxnQ0FBZ0Msa0VBQWE7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ08sNkJBQTZCLG1FQUFjO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIi9Vc2Vycy9hcHBsZS9EZXNrdG9wL0FlbGYgUHJvamVjdHMvYWVsZi1jb2RlLWdlbmVyYXRvci9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vYXBwL2V2ZW50LXF1ZXVlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvcmVFdmVudFF1ZXVlLCBQcmlvcml0eVF1ZXVlIH0gZnJvbSAnQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUnO1xuY2xhc3MgTm9kZVByaW9yaXR5UXVldWUgZXh0ZW5kcyBQcmlvcml0eVF1ZXVlIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoMSwgW10pO1xuICAgIH1cbiAgICAvLyBkbyBub3QgdXNlIGFuIGludGVybmFsIFwic2VlblwiIG1hcFxuICAgIGdldEF0dGVtcHRzKGN0eCkge1xuICAgICAgICByZXR1cm4gY3R4LmF0dGVtcHRzID8/IDA7XG4gICAgfVxuICAgIHVwZGF0ZUF0dGVtcHRzKGN0eCkge1xuICAgICAgICBjdHguYXR0ZW1wdHMgPSB0aGlzLmdldEF0dGVtcHRzKGN0eCkgKyAxO1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRBdHRlbXB0cyhjdHgpO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBOb2RlRXZlbnRRdWV1ZSBleHRlbmRzIENvcmVFdmVudFF1ZXVlIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIobmV3IE5vZGVQcmlvcml0eVF1ZXVlKCkpO1xuICAgIH1cbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWV2ZW50LXF1ZXVlLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-node/dist/esm/app/event-queue.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-node/dist/esm/app/settings.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@segment/analytics-node/dist/esm/app/settings.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   validateSettings: () => (/* binding */ validateSettings)\n/* harmony export */ });\n/* harmony import */ var _segment_analytics_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @segment/analytics-core */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/validation/errors.js\");\n\nconst validateSettings = (settings) => {\n    if (!settings.writeKey) {\n        throw new _segment_analytics_core__WEBPACK_IMPORTED_MODULE_0__.ValidationError('writeKey', 'writeKey is missing.');\n    }\n};\n//# sourceMappingURL=settings.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vYXBwL3NldHRpbmdzLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQTBEO0FBQ25EO0FBQ1A7QUFDQSxrQkFBa0Isb0VBQWU7QUFDakM7QUFDQTtBQUNBIiwic291cmNlcyI6WyIvVXNlcnMvYXBwbGUvRGVza3RvcC9BZWxmIFByb2plY3RzL2FlbGYtY29kZS1nZW5lcmF0b3Ivbm9kZV9tb2R1bGVzL0BzZWdtZW50L2FuYWx5dGljcy1ub2RlL2Rpc3QvZXNtL2FwcC9zZXR0aW5ncy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWYWxpZGF0aW9uRXJyb3IgfSBmcm9tICdAc2VnbWVudC9hbmFseXRpY3MtY29yZSc7XG5leHBvcnQgY29uc3QgdmFsaWRhdGVTZXR0aW5ncyA9IChzZXR0aW5ncykgPT4ge1xuICAgIGlmICghc2V0dGluZ3Mud3JpdGVLZXkpIHtcbiAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcignd3JpdGVLZXknLCAnd3JpdGVLZXkgaXMgbWlzc2luZy4nKTtcbiAgICB9XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2V0dGluZ3MuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-node/dist/esm/app/settings.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-node/dist/esm/generated/version.js":
/*!****************************************************************************!*\
  !*** ./node_modules/@segment/analytics-node/dist/esm/generated/version.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   version: () => (/* binding */ version)\n/* harmony export */ });\n// This file is generated.\nconst version = '2.2.0';\n//# sourceMappingURL=version.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vZ2VuZXJhdGVkL3ZlcnNpb24uanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ087QUFDUCIsInNvdXJjZXMiOlsiL1VzZXJzL2FwcGxlL0Rlc2t0b3AvQWVsZiBQcm9qZWN0cy9hZWxmLWNvZGUtZ2VuZXJhdG9yL25vZGVfbW9kdWxlcy9Ac2VnbWVudC9hbmFseXRpY3Mtbm9kZS9kaXN0L2VzbS9nZW5lcmF0ZWQvdmVyc2lvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGlzIGZpbGUgaXMgZ2VuZXJhdGVkLlxuZXhwb3J0IGNvbnN0IHZlcnNpb24gPSAnMi4yLjAnO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dmVyc2lvbi5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-node/dist/esm/generated/version.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-node/dist/esm/index.common.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@segment/analytics-node/dist/esm/index.common.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Analytics: () => (/* reexport safe */ _app_analytics_node__WEBPACK_IMPORTED_MODULE_0__.Analytics),\n/* harmony export */   Context: () => (/* reexport safe */ _app_context__WEBPACK_IMPORTED_MODULE_1__.Context),\n/* harmony export */   FetchHTTPClient: () => (/* reexport safe */ _lib_http_client__WEBPACK_IMPORTED_MODULE_2__.FetchHTTPClient)\n/* harmony export */ });\n/* harmony import */ var _app_analytics_node__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./app/analytics-node */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/app/analytics-node.js\");\n/* harmony import */ var _app_context__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./app/context */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/app/context.js\");\n/* harmony import */ var _lib_http_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./lib/http-client */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/http-client.js\");\n\n\n\n//# sourceMappingURL=index.common.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vaW5kZXguY29tbW9uLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFpRDtBQUNUO0FBQ2E7QUFDckQiLCJzb3VyY2VzIjpbIi9Vc2Vycy9hcHBsZS9EZXNrdG9wL0FlbGYgUHJvamVjdHMvYWVsZi1jb2RlLWdlbmVyYXRvci9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vaW5kZXguY29tbW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCB7IEFuYWx5dGljcyB9IGZyb20gJy4vYXBwL2FuYWx5dGljcy1ub2RlJztcbmV4cG9ydCB7IENvbnRleHQgfSBmcm9tICcuL2FwcC9jb250ZXh0JztcbmV4cG9ydCB7IEZldGNoSFRUUENsaWVudCwgfSBmcm9tICcuL2xpYi9odHRwLWNsaWVudCc7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5jb21tb24uanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-node/dist/esm/index.common.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-node/dist/esm/index.js":
/*!****************************************************************!*\
  !*** ./node_modules/@segment/analytics-node/dist/esm/index.js ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Analytics: () => (/* reexport safe */ _index_common__WEBPACK_IMPORTED_MODULE_0__.Analytics),\n/* harmony export */   Context: () => (/* reexport safe */ _index_common__WEBPACK_IMPORTED_MODULE_0__.Context),\n/* harmony export */   FetchHTTPClient: () => (/* reexport safe */ _index_common__WEBPACK_IMPORTED_MODULE_0__.FetchHTTPClient),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _index_common__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index.common */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/index.common.js\");\n\n// export Analytics as both a named export and a default export (for backwards-compat. reasons)\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (_index_common__WEBPACK_IMPORTED_MODULE_0__.Analytics);\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBK0I7QUFDL0I7QUFDMkM7QUFDM0MsaUVBQWUsb0RBQVMsRUFBQztBQUN6QiIsInNvdXJjZXMiOlsiL1VzZXJzL2FwcGxlL0Rlc2t0b3AvQWVsZiBQcm9qZWN0cy9hZWxmLWNvZGUtZ2VuZXJhdG9yL25vZGVfbW9kdWxlcy9Ac2VnbWVudC9hbmFseXRpY3Mtbm9kZS9kaXN0L2VzbS9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgKiBmcm9tICcuL2luZGV4LmNvbW1vbic7XG4vLyBleHBvcnQgQW5hbHl0aWNzIGFzIGJvdGggYSBuYW1lZCBleHBvcnQgYW5kIGEgZGVmYXVsdCBleHBvcnQgKGZvciBiYWNrd2FyZHMtY29tcGF0LiByZWFzb25zKVxuaW1wb3J0IHsgQW5hbHl0aWNzIH0gZnJvbSAnLi9pbmRleC5jb21tb24nO1xuZXhwb3J0IGRlZmF1bHQgQW5hbHl0aWNzO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-node/dist/esm/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/abort.js":
/*!********************************************************************!*\
  !*** ./node_modules/@segment/analytics-node/dist/esm/lib/abort.js ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AbortController: () => (/* binding */ AbortController),\n/* harmony export */   AbortSignal: () => (/* binding */ AbortSignal),\n/* harmony export */   abortSignalAfterTimeout: () => (/* binding */ abortSignalAfterTimeout)\n/* harmony export */ });\n/* harmony import */ var _segment_analytics_generic_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @segment/analytics-generic-utils */ \"(ssr)/./node_modules/@segment/analytics-generic-utils/dist/esm/emitter/emitter.js\");\n/* harmony import */ var _env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./env */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/env.js\");\n/**\n * use non-native event emitter for the benefit of non-node runtimes like CF workers.\n */\n\n\n/**\n * adapted from: https://www.npmjs.com/package/node-abort-controller\n */\nclass AbortSignal {\n    onabort = null;\n    aborted = false;\n    eventEmitter = new _segment_analytics_generic_utils__WEBPACK_IMPORTED_MODULE_1__.Emitter();\n    toString() {\n        return '[object AbortSignal]';\n    }\n    get [Symbol.toStringTag]() {\n        return 'AbortSignal';\n    }\n    removeEventListener(...args) {\n        this.eventEmitter.off(...args);\n    }\n    addEventListener(...args) {\n        this.eventEmitter.on(...args);\n    }\n    dispatchEvent(type) {\n        const event = { type, target: this };\n        const handlerName = `on${type}`;\n        if (typeof this[handlerName] === 'function') {\n            ;\n            this[handlerName](event);\n        }\n        this.eventEmitter.emit(type, event);\n    }\n}\n/**\n * This polyfill is only neccessary to support versions of node < 14.17.\n * Can be removed once node 14 support is dropped.\n */\nclass AbortController {\n    signal = new AbortSignal();\n    abort() {\n        if (this.signal.aborted)\n            return;\n        this.signal.aborted = true;\n        this.signal.dispatchEvent('abort');\n    }\n    toString() {\n        return '[object AbortController]';\n    }\n    get [Symbol.toStringTag]() {\n        return 'AbortController';\n    }\n}\n/**\n * @param timeoutMs - Set a request timeout, after which the request is cancelled.\n */\nconst abortSignalAfterTimeout = (timeoutMs) => {\n    if ((0,_env__WEBPACK_IMPORTED_MODULE_0__.detectRuntime)() === 'cloudflare-worker') {\n        return []; // TODO: this is broken in cloudflare workers, otherwise results in \"A hanging Promise was canceled...\" error.\n    }\n    const ac = new (globalThis.AbortController || AbortController)();\n    const timeoutId = setTimeout(() => {\n        ac.abort();\n    }, timeoutMs);\n    // Allow Node.js processes to exit early if only the timeout is running\n    timeoutId?.unref?.();\n    return [ac.signal, timeoutId];\n};\n//# sourceMappingURL=abort.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vbGliL2Fib3J0LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQzJEO0FBQ3JCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBLHVCQUF1QixxRUFBTztBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QixpQ0FBaUMsS0FBSztBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUCxRQUFRLG1EQUFhO0FBQ3JCLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyIvVXNlcnMvYXBwbGUvRGVza3RvcC9BZWxmIFByb2plY3RzL2FlbGYtY29kZS1nZW5lcmF0b3Ivbm9kZV9tb2R1bGVzL0BzZWdtZW50L2FuYWx5dGljcy1ub2RlL2Rpc3QvZXNtL2xpYi9hYm9ydC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIHVzZSBub24tbmF0aXZlIGV2ZW50IGVtaXR0ZXIgZm9yIHRoZSBiZW5lZml0IG9mIG5vbi1ub2RlIHJ1bnRpbWVzIGxpa2UgQ0Ygd29ya2Vycy5cbiAqL1xuaW1wb3J0IHsgRW1pdHRlciB9IGZyb20gJ0BzZWdtZW50L2FuYWx5dGljcy1nZW5lcmljLXV0aWxzJztcbmltcG9ydCB7IGRldGVjdFJ1bnRpbWUgfSBmcm9tICcuL2Vudic7XG4vKipcbiAqIGFkYXB0ZWQgZnJvbTogaHR0cHM6Ly93d3cubnBtanMuY29tL3BhY2thZ2Uvbm9kZS1hYm9ydC1jb250cm9sbGVyXG4gKi9cbmV4cG9ydCBjbGFzcyBBYm9ydFNpZ25hbCB7XG4gICAgb25hYm9ydCA9IG51bGw7XG4gICAgYWJvcnRlZCA9IGZhbHNlO1xuICAgIGV2ZW50RW1pdHRlciA9IG5ldyBFbWl0dGVyKCk7XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiAnW29iamVjdCBBYm9ydFNpZ25hbF0nO1xuICAgIH1cbiAgICBnZXQgW1N5bWJvbC50b1N0cmluZ1RhZ10oKSB7XG4gICAgICAgIHJldHVybiAnQWJvcnRTaWduYWwnO1xuICAgIH1cbiAgICByZW1vdmVFdmVudExpc3RlbmVyKC4uLmFyZ3MpIHtcbiAgICAgICAgdGhpcy5ldmVudEVtaXR0ZXIub2ZmKC4uLmFyZ3MpO1xuICAgIH1cbiAgICBhZGRFdmVudExpc3RlbmVyKC4uLmFyZ3MpIHtcbiAgICAgICAgdGhpcy5ldmVudEVtaXR0ZXIub24oLi4uYXJncyk7XG4gICAgfVxuICAgIGRpc3BhdGNoRXZlbnQodHlwZSkge1xuICAgICAgICBjb25zdCBldmVudCA9IHsgdHlwZSwgdGFyZ2V0OiB0aGlzIH07XG4gICAgICAgIGNvbnN0IGhhbmRsZXJOYW1lID0gYG9uJHt0eXBlfWA7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpc1toYW5kbGVyTmFtZV0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIDtcbiAgICAgICAgICAgIHRoaXNbaGFuZGxlck5hbWVdKGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmV2ZW50RW1pdHRlci5lbWl0KHR5cGUsIGV2ZW50KTtcbiAgICB9XG59XG4vKipcbiAqIFRoaXMgcG9seWZpbGwgaXMgb25seSBuZWNjZXNzYXJ5IHRvIHN1cHBvcnQgdmVyc2lvbnMgb2Ygbm9kZSA8IDE0LjE3LlxuICogQ2FuIGJlIHJlbW92ZWQgb25jZSBub2RlIDE0IHN1cHBvcnQgaXMgZHJvcHBlZC5cbiAqL1xuZXhwb3J0IGNsYXNzIEFib3J0Q29udHJvbGxlciB7XG4gICAgc2lnbmFsID0gbmV3IEFib3J0U2lnbmFsKCk7XG4gICAgYWJvcnQoKSB7XG4gICAgICAgIGlmICh0aGlzLnNpZ25hbC5hYm9ydGVkKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLnNpZ25hbC5hYm9ydGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zaWduYWwuZGlzcGF0Y2hFdmVudCgnYWJvcnQnKTtcbiAgICB9XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiAnW29iamVjdCBBYm9ydENvbnRyb2xsZXJdJztcbiAgICB9XG4gICAgZ2V0IFtTeW1ib2wudG9TdHJpbmdUYWddKCkge1xuICAgICAgICByZXR1cm4gJ0Fib3J0Q29udHJvbGxlcic7XG4gICAgfVxufVxuLyoqXG4gKiBAcGFyYW0gdGltZW91dE1zIC0gU2V0IGEgcmVxdWVzdCB0aW1lb3V0LCBhZnRlciB3aGljaCB0aGUgcmVxdWVzdCBpcyBjYW5jZWxsZWQuXG4gKi9cbmV4cG9ydCBjb25zdCBhYm9ydFNpZ25hbEFmdGVyVGltZW91dCA9ICh0aW1lb3V0TXMpID0+IHtcbiAgICBpZiAoZGV0ZWN0UnVudGltZSgpID09PSAnY2xvdWRmbGFyZS13b3JrZXInKSB7XG4gICAgICAgIHJldHVybiBbXTsgLy8gVE9ETzogdGhpcyBpcyBicm9rZW4gaW4gY2xvdWRmbGFyZSB3b3JrZXJzLCBvdGhlcndpc2UgcmVzdWx0cyBpbiBcIkEgaGFuZ2luZyBQcm9taXNlIHdhcyBjYW5jZWxlZC4uLlwiIGVycm9yLlxuICAgIH1cbiAgICBjb25zdCBhYyA9IG5ldyAoZ2xvYmFsVGhpcy5BYm9ydENvbnRyb2xsZXIgfHwgQWJvcnRDb250cm9sbGVyKSgpO1xuICAgIGNvbnN0IHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBhYy5hYm9ydCgpO1xuICAgIH0sIHRpbWVvdXRNcyk7XG4gICAgLy8gQWxsb3cgTm9kZS5qcyBwcm9jZXNzZXMgdG8gZXhpdCBlYXJseSBpZiBvbmx5IHRoZSB0aW1lb3V0IGlzIHJ1bm5pbmdcbiAgICB0aW1lb3V0SWQ/LnVucmVmPy4oKTtcbiAgICByZXR1cm4gW2FjLnNpZ25hbCwgdGltZW91dElkXTtcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hYm9ydC5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/abort.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/create-url.js":
/*!*************************************************************************!*\
  !*** ./node_modules/@segment/analytics-node/dist/esm/lib/create-url.js ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   tryCreateFormattedUrl: () => (/* binding */ tryCreateFormattedUrl)\n/* harmony export */ });\nconst stripTrailingSlash = (str) => str.replace(/\\/$/, '');\n/**\n *\n * @param host e.g. \"http://foo.com\"\n * @param path e.g. \"/bar\"\n * @returns \"e.g.\" \"http://foo.com/bar\"\n */\nconst tryCreateFormattedUrl = (host, path) => {\n    return stripTrailingSlash(new URL(path || '', host).href);\n};\n//# sourceMappingURL=create-url.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vbGliL2NyZWF0ZS11cmwuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIi9Vc2Vycy9hcHBsZS9EZXNrdG9wL0FlbGYgUHJvamVjdHMvYWVsZi1jb2RlLWdlbmVyYXRvci9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vbGliL2NyZWF0ZS11cmwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgc3RyaXBUcmFpbGluZ1NsYXNoID0gKHN0cikgPT4gc3RyLnJlcGxhY2UoL1xcLyQvLCAnJyk7XG4vKipcbiAqXG4gKiBAcGFyYW0gaG9zdCBlLmcuIFwiaHR0cDovL2Zvby5jb21cIlxuICogQHBhcmFtIHBhdGggZS5nLiBcIi9iYXJcIlxuICogQHJldHVybnMgXCJlLmcuXCIgXCJodHRwOi8vZm9vLmNvbS9iYXJcIlxuICovXG5leHBvcnQgY29uc3QgdHJ5Q3JlYXRlRm9ybWF0dGVkVXJsID0gKGhvc3QsIHBhdGgpID0+IHtcbiAgICByZXR1cm4gc3RyaXBUcmFpbGluZ1NsYXNoKG5ldyBVUkwocGF0aCB8fCAnJywgaG9zdCkuaHJlZik7XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y3JlYXRlLXVybC5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/create-url.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/env.js":
/*!******************************************************************!*\
  !*** ./node_modules/@segment/analytics-node/dist/esm/lib/env.js ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   detectRuntime: () => (/* binding */ detectRuntime)\n/* harmony export */ });\nconst detectRuntime = () => {\n    if (typeof process === 'object' &&\n        process &&\n        typeof process.env === 'object' &&\n        process.env &&\n        typeof process.version === 'string') {\n        return 'node';\n    }\n    if (typeof window === 'object') {\n        return 'browser';\n    }\n    // @ts-ignore\n    if (typeof WebSocketPair !== 'undefined') {\n        return 'cloudflare-worker';\n    }\n    // @ts-ignore\n    if (typeof EdgeRuntime === 'string') {\n        return 'vercel-edge';\n    }\n    if (\n    // @ts-ignore\n    typeof WorkerGlobalScope !== 'undefined' &&\n        // @ts-ignore\n        typeof importScripts === 'function') {\n        return 'web-worker';\n    }\n    return 'unknown';\n};\n//# sourceMappingURL=env.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vbGliL2Vudi5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiL1VzZXJzL2FwcGxlL0Rlc2t0b3AvQWVsZiBQcm9qZWN0cy9hZWxmLWNvZGUtZ2VuZXJhdG9yL25vZGVfbW9kdWxlcy9Ac2VnbWVudC9hbmFseXRpY3Mtbm9kZS9kaXN0L2VzbS9saWIvZW52LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBkZXRlY3RSdW50aW1lID0gKCkgPT4ge1xuICAgIGlmICh0eXBlb2YgcHJvY2VzcyA9PT0gJ29iamVjdCcgJiZcbiAgICAgICAgcHJvY2VzcyAmJlxuICAgICAgICB0eXBlb2YgcHJvY2Vzcy5lbnYgPT09ICdvYmplY3QnICYmXG4gICAgICAgIHByb2Nlc3MuZW52ICYmXG4gICAgICAgIHR5cGVvZiBwcm9jZXNzLnZlcnNpb24gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHJldHVybiAnbm9kZSc7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0Jykge1xuICAgICAgICByZXR1cm4gJ2Jyb3dzZXInO1xuICAgIH1cbiAgICAvLyBAdHMtaWdub3JlXG4gICAgaWYgKHR5cGVvZiBXZWJTb2NrZXRQYWlyICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICByZXR1cm4gJ2Nsb3VkZmxhcmUtd29ya2VyJztcbiAgICB9XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGlmICh0eXBlb2YgRWRnZVJ1bnRpbWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHJldHVybiAndmVyY2VsLWVkZ2UnO1xuICAgIH1cbiAgICBpZiAoXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIHR5cGVvZiBXb3JrZXJHbG9iYWxTY29wZSAhPT0gJ3VuZGVmaW5lZCcgJiZcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICB0eXBlb2YgaW1wb3J0U2NyaXB0cyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICByZXR1cm4gJ3dlYi13b3JrZXInO1xuICAgIH1cbiAgICByZXR1cm4gJ3Vua25vd24nO1xufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWVudi5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/env.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/fetch.js":
/*!********************************************************************!*\
  !*** ./node_modules/@segment/analytics-node/dist/esm/lib/fetch.js ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   fetch: () => (/* binding */ fetch)\n/* harmony export */ });\nconst fetch = async (...args) => {\n    if (globalThis.fetch) {\n        return globalThis.fetch(...args);\n    }\n    // This guard causes is important, as it causes dead-code elimination to be enabled inside this block.\n    // @ts-ignore\n    else if (typeof EdgeRuntime !== 'string') {\n        return (await Promise.all(/*! import() */[__webpack_require__.e(\"vendor-chunks/whatwg-url\"), __webpack_require__.e(\"vendor-chunks/tr46\"), __webpack_require__.e(\"vendor-chunks/node-fetch\"), __webpack_require__.e(\"vendor-chunks/webidl-conversions\")]).then(__webpack_require__.bind(__webpack_require__, /*! node-fetch */ \"(ssr)/./node_modules/node-fetch/lib/index.mjs\"))).default(...args);\n    }\n    else {\n        throw new Error('Invariant: an edge runtime that does not support fetch should not exist');\n    }\n};\n//# sourceMappingURL=fetch.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vbGliL2ZldGNoLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixpV0FBb0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyIvVXNlcnMvYXBwbGUvRGVza3RvcC9BZWxmIFByb2plY3RzL2FlbGYtY29kZS1nZW5lcmF0b3Ivbm9kZV9tb2R1bGVzL0BzZWdtZW50L2FuYWx5dGljcy1ub2RlL2Rpc3QvZXNtL2xpYi9mZXRjaC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgZmV0Y2ggPSBhc3luYyAoLi4uYXJncykgPT4ge1xuICAgIGlmIChnbG9iYWxUaGlzLmZldGNoKSB7XG4gICAgICAgIHJldHVybiBnbG9iYWxUaGlzLmZldGNoKC4uLmFyZ3MpO1xuICAgIH1cbiAgICAvLyBUaGlzIGd1YXJkIGNhdXNlcyBpcyBpbXBvcnRhbnQsIGFzIGl0IGNhdXNlcyBkZWFkLWNvZGUgZWxpbWluYXRpb24gdG8gYmUgZW5hYmxlZCBpbnNpZGUgdGhpcyBibG9jay5cbiAgICAvLyBAdHMtaWdub3JlXG4gICAgZWxzZSBpZiAodHlwZW9mIEVkZ2VSdW50aW1lICE9PSAnc3RyaW5nJykge1xuICAgICAgICByZXR1cm4gKGF3YWl0IGltcG9ydCgnbm9kZS1mZXRjaCcpKS5kZWZhdWx0KC4uLmFyZ3MpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhcmlhbnQ6IGFuIGVkZ2UgcnVudGltZSB0aGF0IGRvZXMgbm90IHN1cHBvcnQgZmV0Y2ggc2hvdWxkIG5vdCBleGlzdCcpO1xuICAgIH1cbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1mZXRjaC5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/fetch.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/get-message-id.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/@segment/analytics-node/dist/esm/lib/get-message-id.js ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createMessageId: () => (/* binding */ createMessageId)\n/* harmony export */ });\n/* harmony import */ var _uuid__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./uuid */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/uuid.js\");\n\n/**\n * get a unique messageId with a very low chance of collisions\n * using @lukeed/uuid/secure uses the node crypto module, which is the fastest\n * @example \"node-next-1668208232027-743be593-7789-4b74-8078-cbcc8894c586\"\n */\nconst createMessageId = () => {\n    return `node-next-${Date.now()}-${(0,_uuid__WEBPACK_IMPORTED_MODULE_0__.uuid)()}`;\n};\n//# sourceMappingURL=get-message-id.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vbGliL2dldC1tZXNzYWdlLWlkLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQLHdCQUF3QixXQUFXLEdBQUcsMkNBQUksR0FBRztBQUM3QztBQUNBIiwic291cmNlcyI6WyIvVXNlcnMvYXBwbGUvRGVza3RvcC9BZWxmIFByb2plY3RzL2FlbGYtY29kZS1nZW5lcmF0b3Ivbm9kZV9tb2R1bGVzL0BzZWdtZW50L2FuYWx5dGljcy1ub2RlL2Rpc3QvZXNtL2xpYi9nZXQtbWVzc2FnZS1pZC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB1dWlkIH0gZnJvbSAnLi91dWlkJztcbi8qKlxuICogZ2V0IGEgdW5pcXVlIG1lc3NhZ2VJZCB3aXRoIGEgdmVyeSBsb3cgY2hhbmNlIG9mIGNvbGxpc2lvbnNcbiAqIHVzaW5nIEBsdWtlZWQvdXVpZC9zZWN1cmUgdXNlcyB0aGUgbm9kZSBjcnlwdG8gbW9kdWxlLCB3aGljaCBpcyB0aGUgZmFzdGVzdFxuICogQGV4YW1wbGUgXCJub2RlLW5leHQtMTY2ODIwODIzMjAyNy03NDNiZTU5My03Nzg5LTRiNzQtODA3OC1jYmNjODg5NGM1ODZcIlxuICovXG5leHBvcnQgY29uc3QgY3JlYXRlTWVzc2FnZUlkID0gKCkgPT4ge1xuICAgIHJldHVybiBgbm9kZS1uZXh0LSR7RGF0ZS5ub3coKX0tJHt1dWlkKCl9YDtcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1nZXQtbWVzc2FnZS1pZC5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/get-message-id.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/http-client.js":
/*!**************************************************************************!*\
  !*** ./node_modules/@segment/analytics-node/dist/esm/lib/http-client.js ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   FetchHTTPClient: () => (/* binding */ FetchHTTPClient)\n/* harmony export */ });\n/* harmony import */ var _abort__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./abort */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/abort.js\");\n/* harmony import */ var _fetch__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./fetch */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/fetch.js\");\n\n\n/**\n * Default HTTP client implementation using fetch\n */\nclass FetchHTTPClient {\n    _fetch;\n    constructor(fetchFn) {\n        this._fetch = fetchFn ?? _fetch__WEBPACK_IMPORTED_MODULE_1__.fetch;\n    }\n    async makeRequest(options) {\n        const [signal, timeoutId] = (0,_abort__WEBPACK_IMPORTED_MODULE_0__.abortSignalAfterTimeout)(options.httpRequestTimeout);\n        const requestInit = {\n            url: options.url,\n            method: options.method,\n            headers: options.headers,\n            body: options.body,\n            signal: signal,\n        };\n        return this._fetch(options.url, requestInit).finally(() => clearTimeout(timeoutId));\n    }\n}\n//# sourceMappingURL=http-client.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vbGliL2h0dHAtY2xpZW50LmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFrRDtBQUNGO0FBQ2hEO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBLGlDQUFpQyx5Q0FBWTtBQUM3QztBQUNBO0FBQ0Esb0NBQW9DLCtEQUF1QjtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyIvVXNlcnMvYXBwbGUvRGVza3RvcC9BZWxmIFByb2plY3RzL2FlbGYtY29kZS1nZW5lcmF0b3Ivbm9kZV9tb2R1bGVzL0BzZWdtZW50L2FuYWx5dGljcy1ub2RlL2Rpc3QvZXNtL2xpYi9odHRwLWNsaWVudC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBhYm9ydFNpZ25hbEFmdGVyVGltZW91dCB9IGZyb20gJy4vYWJvcnQnO1xuaW1wb3J0IHsgZmV0Y2ggYXMgZGVmYXVsdEZldGNoIH0gZnJvbSAnLi9mZXRjaCc7XG4vKipcbiAqIERlZmF1bHQgSFRUUCBjbGllbnQgaW1wbGVtZW50YXRpb24gdXNpbmcgZmV0Y2hcbiAqL1xuZXhwb3J0IGNsYXNzIEZldGNoSFRUUENsaWVudCB7XG4gICAgX2ZldGNoO1xuICAgIGNvbnN0cnVjdG9yKGZldGNoRm4pIHtcbiAgICAgICAgdGhpcy5fZmV0Y2ggPSBmZXRjaEZuID8/IGRlZmF1bHRGZXRjaDtcbiAgICB9XG4gICAgYXN5bmMgbWFrZVJlcXVlc3Qob3B0aW9ucykge1xuICAgICAgICBjb25zdCBbc2lnbmFsLCB0aW1lb3V0SWRdID0gYWJvcnRTaWduYWxBZnRlclRpbWVvdXQob3B0aW9ucy5odHRwUmVxdWVzdFRpbWVvdXQpO1xuICAgICAgICBjb25zdCByZXF1ZXN0SW5pdCA9IHtcbiAgICAgICAgICAgIHVybDogb3B0aW9ucy51cmwsXG4gICAgICAgICAgICBtZXRob2Q6IG9wdGlvbnMubWV0aG9kLFxuICAgICAgICAgICAgaGVhZGVyczogb3B0aW9ucy5oZWFkZXJzLFxuICAgICAgICAgICAgYm9keTogb3B0aW9ucy5ib2R5LFxuICAgICAgICAgICAgc2lnbmFsOiBzaWduYWwsXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB0aGlzLl9mZXRjaChvcHRpb25zLnVybCwgcmVxdWVzdEluaXQpLmZpbmFsbHkoKCkgPT4gY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCkpO1xuICAgIH1cbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWh0dHAtY2xpZW50LmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/http-client.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/token-manager.js":
/*!****************************************************************************!*\
  !*** ./node_modules/@segment/analytics-node/dist/esm/lib/token-manager.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TokenManager: () => (/* binding */ TokenManager)\n/* harmony export */ });\n/* harmony import */ var _uuid__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./uuid */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/uuid.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jose */ \"(ssr)/./node_modules/jose/dist/node/esm/key/import.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! jose */ \"(ssr)/./node_modules/jose/dist/node/esm/jwt/sign.js\");\n/* harmony import */ var _segment_analytics_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @segment/analytics-core */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/priority-queue/backoff.js\");\n/* harmony import */ var _segment_analytics_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @segment/analytics-core */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/callback/index.js\");\n/* harmony import */ var _segment_analytics_generic_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @segment/analytics-generic-utils */ \"(ssr)/./node_modules/@segment/analytics-generic-utils/dist/esm/emitter/emitter.js\");\n\n\n\n\nconst isAccessToken = (thing) => {\n    return Boolean(thing &&\n        typeof thing === 'object' &&\n        'access_token' in thing &&\n        'expires_in' in thing &&\n        typeof thing.access_token === 'string' &&\n        typeof thing.expires_in === 'number');\n};\nconst isValidCustomResponse = (response) => {\n    return typeof response.text === 'function';\n};\nfunction convertHeaders(headers) {\n    const lowercaseHeaders = {};\n    if (!headers)\n        return {};\n    if (isHeaders(headers)) {\n        for (const [name, value] of headers.entries()) {\n            lowercaseHeaders[name.toLowerCase()] = value;\n        }\n        return lowercaseHeaders;\n    }\n    for (const [name, value] of Object.entries(headers)) {\n        lowercaseHeaders[name.toLowerCase()] = value;\n    }\n    return lowercaseHeaders;\n}\nfunction isHeaders(thing) {\n    if (typeof thing === 'object' &&\n        thing !== null &&\n        'entries' in Object(thing) &&\n        typeof Object(thing).entries === 'function') {\n        return true;\n    }\n    return false;\n}\nclass TokenManager {\n    alg = 'RS256';\n    grantType = 'client_credentials';\n    clientAssertionType = 'urn:ietf:params:oauth:client-assertion-type:jwt-bearer';\n    clientId;\n    clientKey;\n    keyId;\n    scope;\n    authServer;\n    httpClient;\n    maxRetries;\n    clockSkewInSeconds = 0;\n    accessToken;\n    tokenEmitter = new _segment_analytics_generic_utils__WEBPACK_IMPORTED_MODULE_1__.Emitter();\n    retryCount;\n    pollerTimer;\n    constructor(props) {\n        this.keyId = props.keyId;\n        this.clientId = props.clientId;\n        this.clientKey = props.clientKey;\n        this.authServer = props.authServer ?? 'https://oauth2.segment.io';\n        this.scope = props.scope ?? 'tracking_api:write';\n        this.httpClient = props.httpClient;\n        this.maxRetries = props.maxRetries;\n        this.tokenEmitter.on('access_token', (event) => {\n            if ('token' in event) {\n                this.accessToken = event.token;\n            }\n        });\n        this.retryCount = 0;\n    }\n    stopPoller() {\n        clearTimeout(this.pollerTimer);\n    }\n    async pollerLoop() {\n        let timeUntilRefreshInMs = 25;\n        let response;\n        try {\n            response = await this.requestAccessToken();\n        }\n        catch (err) {\n            // Error without a status code - likely networking, retry\n            return this.handleTransientError({ error: err });\n        }\n        if (!isValidCustomResponse(response)) {\n            return this.handleInvalidCustomResponse();\n        }\n        const headers = convertHeaders(response.headers);\n        if (headers['date']) {\n            this.updateClockSkew(Date.parse(headers['date']));\n        }\n        // Handle status codes!\n        if (response.status === 200) {\n            try {\n                const body = await response.text();\n                const token = JSON.parse(body);\n                if (!isAccessToken(token)) {\n                    throw new Error('Response did not contain a valid access_token and expires_in');\n                }\n                // Success, we have a token!\n                token.expires_at = Math.round(Date.now() / 1000) + token.expires_in;\n                this.tokenEmitter.emit('access_token', { token });\n                // Reset our failure count\n                this.retryCount = 0;\n                // Refresh the token after half the expiry time passes\n                timeUntilRefreshInMs = (token.expires_in / 2) * 1000;\n                return this.queueNextPoll(timeUntilRefreshInMs);\n            }\n            catch (err) {\n                // Something went really wrong with the body, lets surface an error and try again?\n                return this.handleTransientError({ error: err, forceEmitError: true });\n            }\n        }\n        else if (response.status === 429) {\n            // Rate limited, wait for the reset time\n            return await this.handleRateLimited(response, headers, timeUntilRefreshInMs);\n        }\n        else if ([400, 401, 415].includes(response.status)) {\n            // Unrecoverable errors, stops the poller\n            return this.handleUnrecoverableErrors(response);\n        }\n        else {\n            return this.handleTransientError({\n                error: new Error(`[${response.status}] ${response.statusText}`),\n            });\n        }\n    }\n    handleTransientError({ error, forceEmitError, }) {\n        this.incrementRetries({ error, forceEmitError });\n        const timeUntilRefreshInMs = (0,_segment_analytics_core__WEBPACK_IMPORTED_MODULE_2__.backoff)({\n            attempt: this.retryCount,\n            minTimeout: 25,\n            maxTimeout: 1000,\n        });\n        this.queueNextPoll(timeUntilRefreshInMs);\n    }\n    handleInvalidCustomResponse() {\n        this.tokenEmitter.emit('access_token', {\n            error: new Error('HTTPClient does not implement response.text method'),\n        });\n    }\n    async handleRateLimited(response, headers, timeUntilRefreshInMs) {\n        this.incrementRetries({\n            error: new Error(`[${response.status}] ${response.statusText}`),\n        });\n        if (headers['x-ratelimit-reset']) {\n            const rateLimitResetTimestamp = parseInt(headers['x-ratelimit-reset'], 10);\n            if (isFinite(rateLimitResetTimestamp)) {\n                timeUntilRefreshInMs =\n                    rateLimitResetTimestamp - Date.now() + this.clockSkewInSeconds * 1000;\n            }\n            else {\n                timeUntilRefreshInMs = 5 * 1000;\n            }\n            // We want subsequent calls to get_token to be able to interrupt our\n            //  Timeout when it's waiting for e.g. a long normal expiration, but\n            //  not when we're waiting for a rate limit reset. Sleep instead.\n            await (0,_segment_analytics_core__WEBPACK_IMPORTED_MODULE_3__.sleep)(timeUntilRefreshInMs);\n            timeUntilRefreshInMs = 0;\n        }\n        this.queueNextPoll(timeUntilRefreshInMs);\n    }\n    handleUnrecoverableErrors(response) {\n        this.retryCount = 0;\n        this.tokenEmitter.emit('access_token', {\n            error: new Error(`[${response.status}] ${response.statusText}`),\n        });\n        this.stopPoller();\n    }\n    updateClockSkew(dateInMs) {\n        this.clockSkewInSeconds = (Date.now() - dateInMs) / 1000;\n    }\n    incrementRetries({ error, forceEmitError, }) {\n        this.retryCount++;\n        if (forceEmitError || this.retryCount % this.maxRetries === 0) {\n            this.retryCount = 0;\n            this.tokenEmitter.emit('access_token', { error: error });\n        }\n    }\n    queueNextPoll(timeUntilRefreshInMs) {\n        this.pollerTimer = setTimeout(() => this.pollerLoop(), timeUntilRefreshInMs);\n        if (this.pollerTimer.unref) {\n            this.pollerTimer.unref();\n        }\n    }\n    /**\n     * Solely responsible for building the HTTP request and calling the token service.\n     */\n    async requestAccessToken() {\n        // Set issued at time to 5 seconds in the past to account for clock skew\n        const ISSUED_AT_BUFFER_IN_SECONDS = 5;\n        const MAX_EXPIRY_IN_SECONDS = 60;\n        // Final expiry time takes into account the issued at time, so need to subtract IAT buffer\n        const EXPIRY_IN_SECONDS = MAX_EXPIRY_IN_SECONDS - ISSUED_AT_BUFFER_IN_SECONDS;\n        const jti = (0,_uuid__WEBPACK_IMPORTED_MODULE_0__.uuid)();\n        const currentUTCInSeconds = Math.round(Date.now() / 1000) - this.clockSkewInSeconds;\n        const jwtBody = {\n            iss: this.clientId,\n            sub: this.clientId,\n            aud: this.authServer,\n            iat: currentUTCInSeconds - ISSUED_AT_BUFFER_IN_SECONDS,\n            exp: currentUTCInSeconds + EXPIRY_IN_SECONDS,\n            jti,\n        };\n        const key = await (0,jose__WEBPACK_IMPORTED_MODULE_4__.importPKCS8)(this.clientKey, 'RS256');\n        const signedJwt = await new jose__WEBPACK_IMPORTED_MODULE_5__.SignJWT(jwtBody)\n            .setProtectedHeader({ alg: this.alg, kid: this.keyId, typ: 'JWT' })\n            .sign(key);\n        const requestBody = `grant_type=${this.grantType}&client_assertion_type=${this.clientAssertionType}&client_assertion=${signedJwt}&scope=${this.scope}`;\n        const accessTokenEndpoint = `${this.authServer}/token`;\n        const requestOptions = {\n            method: 'POST',\n            url: accessTokenEndpoint,\n            body: requestBody,\n            headers: {\n                'Content-Type': 'application/x-www-form-urlencoded',\n            },\n            httpRequestTimeout: 10000,\n        };\n        return this.httpClient.makeRequest(requestOptions);\n    }\n    async getAccessToken() {\n        // Use the cached token if it is still valid, otherwise wait for a new token.\n        if (this.isValidToken(this.accessToken)) {\n            return this.accessToken;\n        }\n        // stop poller first in order to make sure that it's not sleeping if we need a token immediately\n        // Otherwise it could be hours before the expiration time passes normally\n        this.stopPoller();\n        // startPoller needs to be called somewhere, either lazily when a token is first requested, or at instantiation.\n        // Doing it lazily currently\n        this.pollerLoop().catch(() => { });\n        return new Promise((resolve, reject) => {\n            this.tokenEmitter.once('access_token', (event) => {\n                if ('token' in event) {\n                    resolve(event.token);\n                }\n                else {\n                    reject(event.error);\n                }\n            });\n        });\n    }\n    clearToken() {\n        this.accessToken = undefined;\n    }\n    isValidToken(token) {\n        return (typeof token !== 'undefined' &&\n            token !== null &&\n            token.expires_in < Date.now() / 1000);\n    }\n}\n//# sourceMappingURL=token-manager.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vbGliL3Rva2VuLW1hbmFnZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUE4QjtBQUNjO0FBQ2E7QUFDRTtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIscUVBQU87QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQyxZQUFZO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUF5RCxPQUFPO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQsa0NBQWtDO0FBQ3JGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyxnQkFBZ0IsSUFBSSxvQkFBb0I7QUFDN0UsYUFBYTtBQUNiO0FBQ0E7QUFDQSwyQkFBMkIsd0JBQXdCO0FBQ25ELGdDQUFnQyx1QkFBdUI7QUFDdkQscUNBQXFDLGdFQUFPO0FBQzVDO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxnQkFBZ0IsSUFBSSxvQkFBb0I7QUFDekUsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiw4REFBSztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxnQkFBZ0IsSUFBSSxvQkFBb0I7QUFDekUsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsd0JBQXdCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBLHFEQUFxRCxjQUFjO0FBQ25FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsMkNBQUk7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLGlEQUFXO0FBQ3JDLG9DQUFvQyx5Q0FBTztBQUMzQyxrQ0FBa0MsNENBQTRDO0FBQzlFO0FBQ0EsMENBQTBDLGVBQWUseUJBQXlCLHlCQUF5QixvQkFBb0IsVUFBVSxTQUFTLFdBQVc7QUFDN0osdUNBQXVDLGdCQUFnQjtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QztBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyIvVXNlcnMvYXBwbGUvRGVza3RvcC9BZWxmIFByb2plY3RzL2FlbGYtY29kZS1nZW5lcmF0b3Ivbm9kZV9tb2R1bGVzL0BzZWdtZW50L2FuYWx5dGljcy1ub2RlL2Rpc3QvZXNtL2xpYi90b2tlbi1tYW5hZ2VyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHV1aWQgfSBmcm9tICcuL3V1aWQnO1xuaW1wb3J0IHsgU2lnbkpXVCwgaW1wb3J0UEtDUzggfSBmcm9tICdqb3NlJztcbmltcG9ydCB7IGJhY2tvZmYsIHNsZWVwIH0gZnJvbSAnQHNlZ21lbnQvYW5hbHl0aWNzLWNvcmUnO1xuaW1wb3J0IHsgRW1pdHRlciB9IGZyb20gJ0BzZWdtZW50L2FuYWx5dGljcy1nZW5lcmljLXV0aWxzJztcbmNvbnN0IGlzQWNjZXNzVG9rZW4gPSAodGhpbmcpID0+IHtcbiAgICByZXR1cm4gQm9vbGVhbih0aGluZyAmJlxuICAgICAgICB0eXBlb2YgdGhpbmcgPT09ICdvYmplY3QnICYmXG4gICAgICAgICdhY2Nlc3NfdG9rZW4nIGluIHRoaW5nICYmXG4gICAgICAgICdleHBpcmVzX2luJyBpbiB0aGluZyAmJlxuICAgICAgICB0eXBlb2YgdGhpbmcuYWNjZXNzX3Rva2VuID09PSAnc3RyaW5nJyAmJlxuICAgICAgICB0eXBlb2YgdGhpbmcuZXhwaXJlc19pbiA9PT0gJ251bWJlcicpO1xufTtcbmNvbnN0IGlzVmFsaWRDdXN0b21SZXNwb25zZSA9IChyZXNwb25zZSkgPT4ge1xuICAgIHJldHVybiB0eXBlb2YgcmVzcG9uc2UudGV4dCA9PT0gJ2Z1bmN0aW9uJztcbn07XG5mdW5jdGlvbiBjb252ZXJ0SGVhZGVycyhoZWFkZXJzKSB7XG4gICAgY29uc3QgbG93ZXJjYXNlSGVhZGVycyA9IHt9O1xuICAgIGlmICghaGVhZGVycylcbiAgICAgICAgcmV0dXJuIHt9O1xuICAgIGlmIChpc0hlYWRlcnMoaGVhZGVycykpIHtcbiAgICAgICAgZm9yIChjb25zdCBbbmFtZSwgdmFsdWVdIG9mIGhlYWRlcnMuZW50cmllcygpKSB7XG4gICAgICAgICAgICBsb3dlcmNhc2VIZWFkZXJzW25hbWUudG9Mb3dlckNhc2UoKV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbG93ZXJjYXNlSGVhZGVycztcbiAgICB9XG4gICAgZm9yIChjb25zdCBbbmFtZSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGhlYWRlcnMpKSB7XG4gICAgICAgIGxvd2VyY2FzZUhlYWRlcnNbbmFtZS50b0xvd2VyQ2FzZSgpXSA9IHZhbHVlO1xuICAgIH1cbiAgICByZXR1cm4gbG93ZXJjYXNlSGVhZGVycztcbn1cbmZ1bmN0aW9uIGlzSGVhZGVycyh0aGluZykge1xuICAgIGlmICh0eXBlb2YgdGhpbmcgPT09ICdvYmplY3QnICYmXG4gICAgICAgIHRoaW5nICE9PSBudWxsICYmXG4gICAgICAgICdlbnRyaWVzJyBpbiBPYmplY3QodGhpbmcpICYmXG4gICAgICAgIHR5cGVvZiBPYmplY3QodGhpbmcpLmVudHJpZXMgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cbmV4cG9ydCBjbGFzcyBUb2tlbk1hbmFnZXIge1xuICAgIGFsZyA9ICdSUzI1Nic7XG4gICAgZ3JhbnRUeXBlID0gJ2NsaWVudF9jcmVkZW50aWFscyc7XG4gICAgY2xpZW50QXNzZXJ0aW9uVHlwZSA9ICd1cm46aWV0ZjpwYXJhbXM6b2F1dGg6Y2xpZW50LWFzc2VydGlvbi10eXBlOmp3dC1iZWFyZXInO1xuICAgIGNsaWVudElkO1xuICAgIGNsaWVudEtleTtcbiAgICBrZXlJZDtcbiAgICBzY29wZTtcbiAgICBhdXRoU2VydmVyO1xuICAgIGh0dHBDbGllbnQ7XG4gICAgbWF4UmV0cmllcztcbiAgICBjbG9ja1NrZXdJblNlY29uZHMgPSAwO1xuICAgIGFjY2Vzc1Rva2VuO1xuICAgIHRva2VuRW1pdHRlciA9IG5ldyBFbWl0dGVyKCk7XG4gICAgcmV0cnlDb3VudDtcbiAgICBwb2xsZXJUaW1lcjtcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgICB0aGlzLmtleUlkID0gcHJvcHMua2V5SWQ7XG4gICAgICAgIHRoaXMuY2xpZW50SWQgPSBwcm9wcy5jbGllbnRJZDtcbiAgICAgICAgdGhpcy5jbGllbnRLZXkgPSBwcm9wcy5jbGllbnRLZXk7XG4gICAgICAgIHRoaXMuYXV0aFNlcnZlciA9IHByb3BzLmF1dGhTZXJ2ZXIgPz8gJ2h0dHBzOi8vb2F1dGgyLnNlZ21lbnQuaW8nO1xuICAgICAgICB0aGlzLnNjb3BlID0gcHJvcHMuc2NvcGUgPz8gJ3RyYWNraW5nX2FwaTp3cml0ZSc7XG4gICAgICAgIHRoaXMuaHR0cENsaWVudCA9IHByb3BzLmh0dHBDbGllbnQ7XG4gICAgICAgIHRoaXMubWF4UmV0cmllcyA9IHByb3BzLm1heFJldHJpZXM7XG4gICAgICAgIHRoaXMudG9rZW5FbWl0dGVyLm9uKCdhY2Nlc3NfdG9rZW4nLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmICgndG9rZW4nIGluIGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hY2Nlc3NUb2tlbiA9IGV2ZW50LnRva2VuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5yZXRyeUNvdW50ID0gMDtcbiAgICB9XG4gICAgc3RvcFBvbGxlcigpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMucG9sbGVyVGltZXIpO1xuICAgIH1cbiAgICBhc3luYyBwb2xsZXJMb29wKCkge1xuICAgICAgICBsZXQgdGltZVVudGlsUmVmcmVzaEluTXMgPSAyNTtcbiAgICAgICAgbGV0IHJlc3BvbnNlO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnJlcXVlc3RBY2Nlc3NUb2tlbigpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIC8vIEVycm9yIHdpdGhvdXQgYSBzdGF0dXMgY29kZSAtIGxpa2VseSBuZXR3b3JraW5nLCByZXRyeVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlVHJhbnNpZW50RXJyb3IoeyBlcnJvcjogZXJyIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaXNWYWxpZEN1c3RvbVJlc3BvbnNlKHJlc3BvbnNlKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlSW52YWxpZEN1c3RvbVJlc3BvbnNlKCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaGVhZGVycyA9IGNvbnZlcnRIZWFkZXJzKHJlc3BvbnNlLmhlYWRlcnMpO1xuICAgICAgICBpZiAoaGVhZGVyc1snZGF0ZSddKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUNsb2NrU2tldyhEYXRlLnBhcnNlKGhlYWRlcnNbJ2RhdGUnXSkpO1xuICAgICAgICB9XG4gICAgICAgIC8vIEhhbmRsZSBzdGF0dXMgY29kZXMhXG4gICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHRva2VuID0gSlNPTi5wYXJzZShib2R5KTtcbiAgICAgICAgICAgICAgICBpZiAoIWlzQWNjZXNzVG9rZW4odG9rZW4pKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUmVzcG9uc2UgZGlkIG5vdCBjb250YWluIGEgdmFsaWQgYWNjZXNzX3Rva2VuIGFuZCBleHBpcmVzX2luJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIFN1Y2Nlc3MsIHdlIGhhdmUgYSB0b2tlbiFcbiAgICAgICAgICAgICAgICB0b2tlbi5leHBpcmVzX2F0ID0gTWF0aC5yb3VuZChEYXRlLm5vdygpIC8gMTAwMCkgKyB0b2tlbi5leHBpcmVzX2luO1xuICAgICAgICAgICAgICAgIHRoaXMudG9rZW5FbWl0dGVyLmVtaXQoJ2FjY2Vzc190b2tlbicsIHsgdG9rZW4gfSk7XG4gICAgICAgICAgICAgICAgLy8gUmVzZXQgb3VyIGZhaWx1cmUgY291bnRcbiAgICAgICAgICAgICAgICB0aGlzLnJldHJ5Q291bnQgPSAwO1xuICAgICAgICAgICAgICAgIC8vIFJlZnJlc2ggdGhlIHRva2VuIGFmdGVyIGhhbGYgdGhlIGV4cGlyeSB0aW1lIHBhc3Nlc1xuICAgICAgICAgICAgICAgIHRpbWVVbnRpbFJlZnJlc2hJbk1zID0gKHRva2VuLmV4cGlyZXNfaW4gLyAyKSAqIDEwMDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucXVldWVOZXh0UG9sbCh0aW1lVW50aWxSZWZyZXNoSW5Ncyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgLy8gU29tZXRoaW5nIHdlbnQgcmVhbGx5IHdyb25nIHdpdGggdGhlIGJvZHksIGxldHMgc3VyZmFjZSBhbiBlcnJvciBhbmQgdHJ5IGFnYWluP1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmhhbmRsZVRyYW5zaWVudEVycm9yKHsgZXJyb3I6IGVyciwgZm9yY2VFbWl0RXJyb3I6IHRydWUgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MjkpIHtcbiAgICAgICAgICAgIC8vIFJhdGUgbGltaXRlZCwgd2FpdCBmb3IgdGhlIHJlc2V0IHRpbWVcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmhhbmRsZVJhdGVMaW1pdGVkKHJlc3BvbnNlLCBoZWFkZXJzLCB0aW1lVW50aWxSZWZyZXNoSW5Ncyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoWzQwMCwgNDAxLCA0MTVdLmluY2x1ZGVzKHJlc3BvbnNlLnN0YXR1cykpIHtcbiAgICAgICAgICAgIC8vIFVucmVjb3ZlcmFibGUgZXJyb3JzLCBzdG9wcyB0aGUgcG9sbGVyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5oYW5kbGVVbnJlY292ZXJhYmxlRXJyb3JzKHJlc3BvbnNlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmhhbmRsZVRyYW5zaWVudEVycm9yKHtcbiAgICAgICAgICAgICAgICBlcnJvcjogbmV3IEVycm9yKGBbJHtyZXNwb25zZS5zdGF0dXN9XSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBoYW5kbGVUcmFuc2llbnRFcnJvcih7IGVycm9yLCBmb3JjZUVtaXRFcnJvciwgfSkge1xuICAgICAgICB0aGlzLmluY3JlbWVudFJldHJpZXMoeyBlcnJvciwgZm9yY2VFbWl0RXJyb3IgfSk7XG4gICAgICAgIGNvbnN0IHRpbWVVbnRpbFJlZnJlc2hJbk1zID0gYmFja29mZih7XG4gICAgICAgICAgICBhdHRlbXB0OiB0aGlzLnJldHJ5Q291bnQsXG4gICAgICAgICAgICBtaW5UaW1lb3V0OiAyNSxcbiAgICAgICAgICAgIG1heFRpbWVvdXQ6IDEwMDAsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnF1ZXVlTmV4dFBvbGwodGltZVVudGlsUmVmcmVzaEluTXMpO1xuICAgIH1cbiAgICBoYW5kbGVJbnZhbGlkQ3VzdG9tUmVzcG9uc2UoKSB7XG4gICAgICAgIHRoaXMudG9rZW5FbWl0dGVyLmVtaXQoJ2FjY2Vzc190b2tlbicsIHtcbiAgICAgICAgICAgIGVycm9yOiBuZXcgRXJyb3IoJ0hUVFBDbGllbnQgZG9lcyBub3QgaW1wbGVtZW50IHJlc3BvbnNlLnRleHQgbWV0aG9kJyksXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhc3luYyBoYW5kbGVSYXRlTGltaXRlZChyZXNwb25zZSwgaGVhZGVycywgdGltZVVudGlsUmVmcmVzaEluTXMpIHtcbiAgICAgICAgdGhpcy5pbmNyZW1lbnRSZXRyaWVzKHtcbiAgICAgICAgICAgIGVycm9yOiBuZXcgRXJyb3IoYFske3Jlc3BvbnNlLnN0YXR1c31dICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKSxcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChoZWFkZXJzWyd4LXJhdGVsaW1pdC1yZXNldCddKSB7XG4gICAgICAgICAgICBjb25zdCByYXRlTGltaXRSZXNldFRpbWVzdGFtcCA9IHBhcnNlSW50KGhlYWRlcnNbJ3gtcmF0ZWxpbWl0LXJlc2V0J10sIDEwKTtcbiAgICAgICAgICAgIGlmIChpc0Zpbml0ZShyYXRlTGltaXRSZXNldFRpbWVzdGFtcCkpIHtcbiAgICAgICAgICAgICAgICB0aW1lVW50aWxSZWZyZXNoSW5NcyA9XG4gICAgICAgICAgICAgICAgICAgIHJhdGVMaW1pdFJlc2V0VGltZXN0YW1wIC0gRGF0ZS5ub3coKSArIHRoaXMuY2xvY2tTa2V3SW5TZWNvbmRzICogMTAwMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRpbWVVbnRpbFJlZnJlc2hJbk1zID0gNSAqIDEwMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBXZSB3YW50IHN1YnNlcXVlbnQgY2FsbHMgdG8gZ2V0X3Rva2VuIHRvIGJlIGFibGUgdG8gaW50ZXJydXB0IG91clxuICAgICAgICAgICAgLy8gIFRpbWVvdXQgd2hlbiBpdCdzIHdhaXRpbmcgZm9yIGUuZy4gYSBsb25nIG5vcm1hbCBleHBpcmF0aW9uLCBidXRcbiAgICAgICAgICAgIC8vICBub3Qgd2hlbiB3ZSdyZSB3YWl0aW5nIGZvciBhIHJhdGUgbGltaXQgcmVzZXQuIFNsZWVwIGluc3RlYWQuXG4gICAgICAgICAgICBhd2FpdCBzbGVlcCh0aW1lVW50aWxSZWZyZXNoSW5Ncyk7XG4gICAgICAgICAgICB0aW1lVW50aWxSZWZyZXNoSW5NcyA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5xdWV1ZU5leHRQb2xsKHRpbWVVbnRpbFJlZnJlc2hJbk1zKTtcbiAgICB9XG4gICAgaGFuZGxlVW5yZWNvdmVyYWJsZUVycm9ycyhyZXNwb25zZSkge1xuICAgICAgICB0aGlzLnJldHJ5Q291bnQgPSAwO1xuICAgICAgICB0aGlzLnRva2VuRW1pdHRlci5lbWl0KCdhY2Nlc3NfdG9rZW4nLCB7XG4gICAgICAgICAgICBlcnJvcjogbmV3IEVycm9yKGBbJHtyZXNwb25zZS5zdGF0dXN9XSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCksXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnN0b3BQb2xsZXIoKTtcbiAgICB9XG4gICAgdXBkYXRlQ2xvY2tTa2V3KGRhdGVJbk1zKSB7XG4gICAgICAgIHRoaXMuY2xvY2tTa2V3SW5TZWNvbmRzID0gKERhdGUubm93KCkgLSBkYXRlSW5NcykgLyAxMDAwO1xuICAgIH1cbiAgICBpbmNyZW1lbnRSZXRyaWVzKHsgZXJyb3IsIGZvcmNlRW1pdEVycm9yLCB9KSB7XG4gICAgICAgIHRoaXMucmV0cnlDb3VudCsrO1xuICAgICAgICBpZiAoZm9yY2VFbWl0RXJyb3IgfHwgdGhpcy5yZXRyeUNvdW50ICUgdGhpcy5tYXhSZXRyaWVzID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLnJldHJ5Q291bnQgPSAwO1xuICAgICAgICAgICAgdGhpcy50b2tlbkVtaXR0ZXIuZW1pdCgnYWNjZXNzX3Rva2VuJywgeyBlcnJvcjogZXJyb3IgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcXVldWVOZXh0UG9sbCh0aW1lVW50aWxSZWZyZXNoSW5Ncykge1xuICAgICAgICB0aGlzLnBvbGxlclRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB0aGlzLnBvbGxlckxvb3AoKSwgdGltZVVudGlsUmVmcmVzaEluTXMpO1xuICAgICAgICBpZiAodGhpcy5wb2xsZXJUaW1lci51bnJlZikge1xuICAgICAgICAgICAgdGhpcy5wb2xsZXJUaW1lci51bnJlZigpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNvbGVseSByZXNwb25zaWJsZSBmb3IgYnVpbGRpbmcgdGhlIEhUVFAgcmVxdWVzdCBhbmQgY2FsbGluZyB0aGUgdG9rZW4gc2VydmljZS5cbiAgICAgKi9cbiAgICBhc3luYyByZXF1ZXN0QWNjZXNzVG9rZW4oKSB7XG4gICAgICAgIC8vIFNldCBpc3N1ZWQgYXQgdGltZSB0byA1IHNlY29uZHMgaW4gdGhlIHBhc3QgdG8gYWNjb3VudCBmb3IgY2xvY2sgc2tld1xuICAgICAgICBjb25zdCBJU1NVRURfQVRfQlVGRkVSX0lOX1NFQ09ORFMgPSA1O1xuICAgICAgICBjb25zdCBNQVhfRVhQSVJZX0lOX1NFQ09ORFMgPSA2MDtcbiAgICAgICAgLy8gRmluYWwgZXhwaXJ5IHRpbWUgdGFrZXMgaW50byBhY2NvdW50IHRoZSBpc3N1ZWQgYXQgdGltZSwgc28gbmVlZCB0byBzdWJ0cmFjdCBJQVQgYnVmZmVyXG4gICAgICAgIGNvbnN0IEVYUElSWV9JTl9TRUNPTkRTID0gTUFYX0VYUElSWV9JTl9TRUNPTkRTIC0gSVNTVUVEX0FUX0JVRkZFUl9JTl9TRUNPTkRTO1xuICAgICAgICBjb25zdCBqdGkgPSB1dWlkKCk7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRVVENJblNlY29uZHMgPSBNYXRoLnJvdW5kKERhdGUubm93KCkgLyAxMDAwKSAtIHRoaXMuY2xvY2tTa2V3SW5TZWNvbmRzO1xuICAgICAgICBjb25zdCBqd3RCb2R5ID0ge1xuICAgICAgICAgICAgaXNzOiB0aGlzLmNsaWVudElkLFxuICAgICAgICAgICAgc3ViOiB0aGlzLmNsaWVudElkLFxuICAgICAgICAgICAgYXVkOiB0aGlzLmF1dGhTZXJ2ZXIsXG4gICAgICAgICAgICBpYXQ6IGN1cnJlbnRVVENJblNlY29uZHMgLSBJU1NVRURfQVRfQlVGRkVSX0lOX1NFQ09ORFMsXG4gICAgICAgICAgICBleHA6IGN1cnJlbnRVVENJblNlY29uZHMgKyBFWFBJUllfSU5fU0VDT05EUyxcbiAgICAgICAgICAgIGp0aSxcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3Qga2V5ID0gYXdhaXQgaW1wb3J0UEtDUzgodGhpcy5jbGllbnRLZXksICdSUzI1NicpO1xuICAgICAgICBjb25zdCBzaWduZWRKd3QgPSBhd2FpdCBuZXcgU2lnbkpXVChqd3RCb2R5KVxuICAgICAgICAgICAgLnNldFByb3RlY3RlZEhlYWRlcih7IGFsZzogdGhpcy5hbGcsIGtpZDogdGhpcy5rZXlJZCwgdHlwOiAnSldUJyB9KVxuICAgICAgICAgICAgLnNpZ24oa2V5KTtcbiAgICAgICAgY29uc3QgcmVxdWVzdEJvZHkgPSBgZ3JhbnRfdHlwZT0ke3RoaXMuZ3JhbnRUeXBlfSZjbGllbnRfYXNzZXJ0aW9uX3R5cGU9JHt0aGlzLmNsaWVudEFzc2VydGlvblR5cGV9JmNsaWVudF9hc3NlcnRpb249JHtzaWduZWRKd3R9JnNjb3BlPSR7dGhpcy5zY29wZX1gO1xuICAgICAgICBjb25zdCBhY2Nlc3NUb2tlbkVuZHBvaW50ID0gYCR7dGhpcy5hdXRoU2VydmVyfS90b2tlbmA7XG4gICAgICAgIGNvbnN0IHJlcXVlc3RPcHRpb25zID0ge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICB1cmw6IGFjY2Vzc1Rva2VuRW5kcG9pbnQsXG4gICAgICAgICAgICBib2R5OiByZXF1ZXN0Qm9keSxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaHR0cFJlcXVlc3RUaW1lb3V0OiAxMDAwMCxcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cENsaWVudC5tYWtlUmVxdWVzdChyZXF1ZXN0T3B0aW9ucyk7XG4gICAgfVxuICAgIGFzeW5jIGdldEFjY2Vzc1Rva2VuKCkge1xuICAgICAgICAvLyBVc2UgdGhlIGNhY2hlZCB0b2tlbiBpZiBpdCBpcyBzdGlsbCB2YWxpZCwgb3RoZXJ3aXNlIHdhaXQgZm9yIGEgbmV3IHRva2VuLlxuICAgICAgICBpZiAodGhpcy5pc1ZhbGlkVG9rZW4odGhpcy5hY2Nlc3NUb2tlbikpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFjY2Vzc1Rva2VuO1xuICAgICAgICB9XG4gICAgICAgIC8vIHN0b3AgcG9sbGVyIGZpcnN0IGluIG9yZGVyIHRvIG1ha2Ugc3VyZSB0aGF0IGl0J3Mgbm90IHNsZWVwaW5nIGlmIHdlIG5lZWQgYSB0b2tlbiBpbW1lZGlhdGVseVxuICAgICAgICAvLyBPdGhlcndpc2UgaXQgY291bGQgYmUgaG91cnMgYmVmb3JlIHRoZSBleHBpcmF0aW9uIHRpbWUgcGFzc2VzIG5vcm1hbGx5XG4gICAgICAgIHRoaXMuc3RvcFBvbGxlcigpO1xuICAgICAgICAvLyBzdGFydFBvbGxlciBuZWVkcyB0byBiZSBjYWxsZWQgc29tZXdoZXJlLCBlaXRoZXIgbGF6aWx5IHdoZW4gYSB0b2tlbiBpcyBmaXJzdCByZXF1ZXN0ZWQsIG9yIGF0IGluc3RhbnRpYXRpb24uXG4gICAgICAgIC8vIERvaW5nIGl0IGxhemlseSBjdXJyZW50bHlcbiAgICAgICAgdGhpcy5wb2xsZXJMb29wKCkuY2F0Y2goKCkgPT4geyB9KTtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHRoaXMudG9rZW5FbWl0dGVyLm9uY2UoJ2FjY2Vzc190b2tlbicsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICgndG9rZW4nIGluIGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZXZlbnQudG9rZW4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGV2ZW50LmVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNsZWFyVG9rZW4oKSB7XG4gICAgICAgIHRoaXMuYWNjZXNzVG9rZW4gPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGlzVmFsaWRUb2tlbih0b2tlbikge1xuICAgICAgICByZXR1cm4gKHR5cGVvZiB0b2tlbiAhPT0gJ3VuZGVmaW5lZCcgJiZcbiAgICAgICAgICAgIHRva2VuICE9PSBudWxsICYmXG4gICAgICAgICAgICB0b2tlbi5leHBpcmVzX2luIDwgRGF0ZS5ub3coKSAvIDEwMDApO1xuICAgIH1cbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRva2VuLW1hbmFnZXIuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/token-manager.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/uuid.js":
/*!*******************************************************************!*\
  !*** ./node_modules/@segment/analytics-node/dist/esm/lib/uuid.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   uuid: () => (/* reexport safe */ _lukeed_uuid__WEBPACK_IMPORTED_MODULE_0__.v4)\n/* harmony export */ });\n/* harmony import */ var _lukeed_uuid__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @lukeed/uuid */ \"(ssr)/./node_modules/@lukeed/uuid/dist/index.mjs\");\n\n//# sourceMappingURL=uuid.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vbGliL3V1aWQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBMEM7QUFDMUMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9hcHBsZS9EZXNrdG9wL0FlbGYgUHJvamVjdHMvYWVsZi1jb2RlLWdlbmVyYXRvci9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vbGliL3V1aWQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IHsgdjQgYXMgdXVpZCB9IGZyb20gJ0BsdWtlZWQvdXVpZCc7XG4vLyMgc291cmNlTWFwcGluZ1VSTD11dWlkLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/uuid.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-node/dist/esm/plugins/segmentio/context-batch.js":
/*!******************************************************************************************!*\
  !*** ./node_modules/@segment/analytics-node/dist/esm/plugins/segmentio/context-batch.js ***!
  \******************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ContextBatch: () => (/* binding */ ContextBatch)\n/* harmony export */ });\n/* harmony import */ var _lib_uuid__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/uuid */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/uuid.js\");\n\nconst MAX_EVENT_SIZE_IN_KB = 32;\nconst MAX_BATCH_SIZE_IN_KB = 480; //  (500 KB is the limit, leaving some padding)\nclass ContextBatch {\n    id = (0,_lib_uuid__WEBPACK_IMPORTED_MODULE_0__.uuid)();\n    items = [];\n    sizeInBytes = 0;\n    maxEventCount;\n    constructor(maxEventCount) {\n        this.maxEventCount = Math.max(1, maxEventCount);\n    }\n    tryAdd(item) {\n        if (this.length === this.maxEventCount)\n            return {\n                success: false,\n                message: `Event limit of ${this.maxEventCount} has been exceeded.`,\n            };\n        const eventSize = this.calculateSize(item.context);\n        if (eventSize > MAX_EVENT_SIZE_IN_KB * 1024) {\n            return {\n                success: false,\n                message: `Event exceeds maximum event size of ${MAX_EVENT_SIZE_IN_KB} KB`,\n            };\n        }\n        if (this.sizeInBytes + eventSize > MAX_BATCH_SIZE_IN_KB * 1024) {\n            return {\n                success: false,\n                message: `Event has caused batch size to exceed ${MAX_BATCH_SIZE_IN_KB} KB`,\n            };\n        }\n        this.items.push(item);\n        this.sizeInBytes += eventSize;\n        return { success: true };\n    }\n    get length() {\n        return this.items.length;\n    }\n    calculateSize(ctx) {\n        return encodeURI(JSON.stringify(ctx.event)).split(/%..|i/).length;\n    }\n    getEvents() {\n        const events = this.items.map(({ context }) => context.event);\n        return events;\n    }\n    getContexts() {\n        return this.items.map((item) => item.context);\n    }\n    resolveEvents() {\n        this.items.forEach(({ resolver, context }) => resolver(context));\n    }\n}\n//# sourceMappingURL=context-batch.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vcGx1Z2lucy9zZWdtZW50aW8vY29udGV4dC1iYXRjaC5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFzQztBQUN0QztBQUNBLGtDQUFrQztBQUMzQjtBQUNQLFNBQVMsK0NBQUk7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxvQkFBb0I7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdFQUFnRSxzQkFBc0I7QUFDdEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtFQUFrRSxzQkFBc0I7QUFDeEY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QyxTQUFTO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QixtQkFBbUI7QUFDakQ7QUFDQTtBQUNBIiwic291cmNlcyI6WyIvVXNlcnMvYXBwbGUvRGVza3RvcC9BZWxmIFByb2plY3RzL2FlbGYtY29kZS1nZW5lcmF0b3Ivbm9kZV9tb2R1bGVzL0BzZWdtZW50L2FuYWx5dGljcy1ub2RlL2Rpc3QvZXNtL3BsdWdpbnMvc2VnbWVudGlvL2NvbnRleHQtYmF0Y2guanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdXVpZCB9IGZyb20gJy4uLy4uL2xpYi91dWlkJztcbmNvbnN0IE1BWF9FVkVOVF9TSVpFX0lOX0tCID0gMzI7XG5jb25zdCBNQVhfQkFUQ0hfU0laRV9JTl9LQiA9IDQ4MDsgLy8gICg1MDAgS0IgaXMgdGhlIGxpbWl0LCBsZWF2aW5nIHNvbWUgcGFkZGluZylcbmV4cG9ydCBjbGFzcyBDb250ZXh0QmF0Y2gge1xuICAgIGlkID0gdXVpZCgpO1xuICAgIGl0ZW1zID0gW107XG4gICAgc2l6ZUluQnl0ZXMgPSAwO1xuICAgIG1heEV2ZW50Q291bnQ7XG4gICAgY29uc3RydWN0b3IobWF4RXZlbnRDb3VudCkge1xuICAgICAgICB0aGlzLm1heEV2ZW50Q291bnQgPSBNYXRoLm1heCgxLCBtYXhFdmVudENvdW50KTtcbiAgICB9XG4gICAgdHJ5QWRkKGl0ZW0pIHtcbiAgICAgICAgaWYgKHRoaXMubGVuZ3RoID09PSB0aGlzLm1heEV2ZW50Q291bnQpXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGBFdmVudCBsaW1pdCBvZiAke3RoaXMubWF4RXZlbnRDb3VudH0gaGFzIGJlZW4gZXhjZWVkZWQuYCxcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNvbnN0IGV2ZW50U2l6ZSA9IHRoaXMuY2FsY3VsYXRlU2l6ZShpdGVtLmNvbnRleHQpO1xuICAgICAgICBpZiAoZXZlbnRTaXplID4gTUFYX0VWRU5UX1NJWkVfSU5fS0IgKiAxMDI0KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGBFdmVudCBleGNlZWRzIG1heGltdW0gZXZlbnQgc2l6ZSBvZiAke01BWF9FVkVOVF9TSVpFX0lOX0tCfSBLQmAsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNpemVJbkJ5dGVzICsgZXZlbnRTaXplID4gTUFYX0JBVENIX1NJWkVfSU5fS0IgKiAxMDI0KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGBFdmVudCBoYXMgY2F1c2VkIGJhdGNoIHNpemUgdG8gZXhjZWVkICR7TUFYX0JBVENIX1NJWkVfSU5fS0J9IEtCYCxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pdGVtcy5wdXNoKGl0ZW0pO1xuICAgICAgICB0aGlzLnNpemVJbkJ5dGVzICs9IGV2ZW50U2l6ZTtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xuICAgIH1cbiAgICBnZXQgbGVuZ3RoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pdGVtcy5sZW5ndGg7XG4gICAgfVxuICAgIGNhbGN1bGF0ZVNpemUoY3R4KSB7XG4gICAgICAgIHJldHVybiBlbmNvZGVVUkkoSlNPTi5zdHJpbmdpZnkoY3R4LmV2ZW50KSkuc3BsaXQoLyUuLnxpLykubGVuZ3RoO1xuICAgIH1cbiAgICBnZXRFdmVudHMoKSB7XG4gICAgICAgIGNvbnN0IGV2ZW50cyA9IHRoaXMuaXRlbXMubWFwKCh7IGNvbnRleHQgfSkgPT4gY29udGV4dC5ldmVudCk7XG4gICAgICAgIHJldHVybiBldmVudHM7XG4gICAgfVxuICAgIGdldENvbnRleHRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pdGVtcy5tYXAoKGl0ZW0pID0+IGl0ZW0uY29udGV4dCk7XG4gICAgfVxuICAgIHJlc29sdmVFdmVudHMoKSB7XG4gICAgICAgIHRoaXMuaXRlbXMuZm9yRWFjaCgoeyByZXNvbHZlciwgY29udGV4dCB9KSA9PiByZXNvbHZlcihjb250ZXh0KSk7XG4gICAgfVxufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29udGV4dC1iYXRjaC5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-node/dist/esm/plugins/segmentio/context-batch.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-node/dist/esm/plugins/segmentio/index.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@segment/analytics-node/dist/esm/plugins/segmentio/index.js ***!
  \**********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createConfiguredNodePlugin: () => (/* binding */ createConfiguredNodePlugin),\n/* harmony export */   createNodePlugin: () => (/* binding */ createNodePlugin)\n/* harmony export */ });\n/* harmony import */ var _publisher__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./publisher */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/plugins/segmentio/publisher.js\");\n/* harmony import */ var _generated_version__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../generated/version */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/generated/version.js\");\n/* harmony import */ var _lib_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../lib/env */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/env.js\");\n\n\n\nfunction normalizeEvent(ctx) {\n    ctx.updateEvent('context.library.name', '@segment/analytics-node');\n    ctx.updateEvent('context.library.version', _generated_version__WEBPACK_IMPORTED_MODULE_1__.version);\n    const runtime = (0,_lib_env__WEBPACK_IMPORTED_MODULE_2__.detectRuntime)();\n    if (runtime === 'node') {\n        // eslint-disable-next-line no-restricted-globals\n        ctx.updateEvent('_metadata.nodeVersion', process.version);\n    }\n    ctx.updateEvent('_metadata.jsRuntime', runtime);\n}\nfunction createNodePlugin(publisher) {\n    function action(ctx) {\n        normalizeEvent(ctx);\n        return publisher.enqueue(ctx);\n    }\n    return {\n        name: 'Segment.io',\n        type: 'destination',\n        version: '1.0.0',\n        isLoaded: () => true,\n        load: () => Promise.resolve(),\n        alias: action,\n        group: action,\n        identify: action,\n        page: action,\n        screen: action,\n        track: action,\n    };\n}\nconst createConfiguredNodePlugin = (props, emitter) => {\n    const publisher = new _publisher__WEBPACK_IMPORTED_MODULE_0__.Publisher(props, emitter);\n    return {\n        publisher: publisher,\n        plugin: createNodePlugin(publisher),\n    };\n};\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vcGx1Z2lucy9zZWdtZW50aW8vaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBd0M7QUFDVTtBQUNKO0FBQzlDO0FBQ0E7QUFDQSwrQ0FBK0MsdURBQU87QUFDdEQsb0JBQW9CLHVEQUFhO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUCwwQkFBMEIsaURBQVM7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyIvVXNlcnMvYXBwbGUvRGVza3RvcC9BZWxmIFByb2plY3RzL2FlbGYtY29kZS1nZW5lcmF0b3Ivbm9kZV9tb2R1bGVzL0BzZWdtZW50L2FuYWx5dGljcy1ub2RlL2Rpc3QvZXNtL3BsdWdpbnMvc2VnbWVudGlvL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFB1Ymxpc2hlciB9IGZyb20gJy4vcHVibGlzaGVyJztcbmltcG9ydCB7IHZlcnNpb24gfSBmcm9tICcuLi8uLi9nZW5lcmF0ZWQvdmVyc2lvbic7XG5pbXBvcnQgeyBkZXRlY3RSdW50aW1lIH0gZnJvbSAnLi4vLi4vbGliL2Vudic7XG5mdW5jdGlvbiBub3JtYWxpemVFdmVudChjdHgpIHtcbiAgICBjdHgudXBkYXRlRXZlbnQoJ2NvbnRleHQubGlicmFyeS5uYW1lJywgJ0BzZWdtZW50L2FuYWx5dGljcy1ub2RlJyk7XG4gICAgY3R4LnVwZGF0ZUV2ZW50KCdjb250ZXh0LmxpYnJhcnkudmVyc2lvbicsIHZlcnNpb24pO1xuICAgIGNvbnN0IHJ1bnRpbWUgPSBkZXRlY3RSdW50aW1lKCk7XG4gICAgaWYgKHJ1bnRpbWUgPT09ICdub2RlJykge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzXG4gICAgICAgIGN0eC51cGRhdGVFdmVudCgnX21ldGFkYXRhLm5vZGVWZXJzaW9uJywgcHJvY2Vzcy52ZXJzaW9uKTtcbiAgICB9XG4gICAgY3R4LnVwZGF0ZUV2ZW50KCdfbWV0YWRhdGEuanNSdW50aW1lJywgcnVudGltZSk7XG59XG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlTm9kZVBsdWdpbihwdWJsaXNoZXIpIHtcbiAgICBmdW5jdGlvbiBhY3Rpb24oY3R4KSB7XG4gICAgICAgIG5vcm1hbGl6ZUV2ZW50KGN0eCk7XG4gICAgICAgIHJldHVybiBwdWJsaXNoZXIuZW5xdWV1ZShjdHgpO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBuYW1lOiAnU2VnbWVudC5pbycsXG4gICAgICAgIHR5cGU6ICdkZXN0aW5hdGlvbicsXG4gICAgICAgIHZlcnNpb246ICcxLjAuMCcsXG4gICAgICAgIGlzTG9hZGVkOiAoKSA9PiB0cnVlLFxuICAgICAgICBsb2FkOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoKSxcbiAgICAgICAgYWxpYXM6IGFjdGlvbixcbiAgICAgICAgZ3JvdXA6IGFjdGlvbixcbiAgICAgICAgaWRlbnRpZnk6IGFjdGlvbixcbiAgICAgICAgcGFnZTogYWN0aW9uLFxuICAgICAgICBzY3JlZW46IGFjdGlvbixcbiAgICAgICAgdHJhY2s6IGFjdGlvbixcbiAgICB9O1xufVxuZXhwb3J0IGNvbnN0IGNyZWF0ZUNvbmZpZ3VyZWROb2RlUGx1Z2luID0gKHByb3BzLCBlbWl0dGVyKSA9PiB7XG4gICAgY29uc3QgcHVibGlzaGVyID0gbmV3IFB1Ymxpc2hlcihwcm9wcywgZW1pdHRlcik7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcHVibGlzaGVyOiBwdWJsaXNoZXIsXG4gICAgICAgIHBsdWdpbjogY3JlYXRlTm9kZVBsdWdpbihwdWJsaXNoZXIpLFxuICAgIH07XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-node/dist/esm/plugins/segmentio/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@segment/analytics-node/dist/esm/plugins/segmentio/publisher.js":
/*!**************************************************************************************!*\
  !*** ./node_modules/@segment/analytics-node/dist/esm/plugins/segmentio/publisher.js ***!
  \**************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Publisher: () => (/* binding */ Publisher)\n/* harmony export */ });\n/* harmony import */ var _segment_analytics_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @segment/analytics-core */ \"(ssr)/./node_modules/@segment/analytics-core/dist/esm/priority-queue/backoff.js\");\n/* harmony import */ var _lib_create_url__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/create-url */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/create-url.js\");\n/* harmony import */ var _segment_analytics_generic_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @segment/analytics-generic-utils */ \"(ssr)/./node_modules/@segment/analytics-generic-utils/dist/esm/create-deferred/create-deferred.js\");\n/* harmony import */ var _context_batch__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./context-batch */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/plugins/segmentio/context-batch.js\");\n/* harmony import */ var _lib_token_manager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../lib/token-manager */ \"(ssr)/./node_modules/@segment/analytics-node/dist/esm/lib/token-manager.js\");\n\n\n\n\n\nfunction sleep(timeoutInMs) {\n    return new Promise((resolve) => setTimeout(resolve, timeoutInMs));\n}\nfunction noop() { }\n/**\n * The Publisher is responsible for batching events and sending them to the Segment API.\n */\nclass Publisher {\n    pendingFlushTimeout;\n    _batch;\n    _flushInterval;\n    _flushAt;\n    _maxRetries;\n    _url;\n    _flushPendingItemsCount;\n    _httpRequestTimeout;\n    _emitter;\n    _disable;\n    _httpClient;\n    _writeKey;\n    _tokenManager;\n    constructor({ host, path, maxRetries, flushAt, flushInterval, writeKey, httpRequestTimeout, httpClient, disable, oauthSettings, }, emitter) {\n        this._emitter = emitter;\n        this._maxRetries = maxRetries;\n        this._flushAt = Math.max(flushAt, 1);\n        this._flushInterval = flushInterval;\n        this._url = (0,_lib_create_url__WEBPACK_IMPORTED_MODULE_0__.tryCreateFormattedUrl)(host ?? 'https://api.segment.io', path ?? '/v1/batch');\n        this._httpRequestTimeout = httpRequestTimeout ?? 10000;\n        this._disable = Boolean(disable);\n        this._httpClient = httpClient;\n        this._writeKey = writeKey;\n        if (oauthSettings) {\n            this._tokenManager = new _lib_token_manager__WEBPACK_IMPORTED_MODULE_2__.TokenManager({\n                ...oauthSettings,\n                httpClient: oauthSettings.httpClient ?? httpClient,\n                maxRetries: oauthSettings.maxRetries ?? maxRetries,\n            });\n        }\n    }\n    createBatch() {\n        this.pendingFlushTimeout && clearTimeout(this.pendingFlushTimeout);\n        const batch = new _context_batch__WEBPACK_IMPORTED_MODULE_1__.ContextBatch(this._flushAt);\n        this._batch = batch;\n        this.pendingFlushTimeout = setTimeout(() => {\n            if (batch === this._batch) {\n                this._batch = undefined;\n            }\n            this.pendingFlushTimeout = undefined;\n            if (batch.length) {\n                this.send(batch).catch(noop);\n            }\n        }, this._flushInterval);\n        return batch;\n    }\n    clearBatch() {\n        this.pendingFlushTimeout && clearTimeout(this.pendingFlushTimeout);\n        this._batch = undefined;\n    }\n    flush(pendingItemsCount) {\n        if (!pendingItemsCount) {\n            // if number of pending items is 0, there will never be anything else entering the batch, since the app is closed.\n            if (this._tokenManager) {\n                this._tokenManager.stopPoller();\n            }\n            return;\n        }\n        this._flushPendingItemsCount = pendingItemsCount;\n        // if batch is empty, there's nothing to flush, and when things come in, enqueue will handle them.\n        if (!this._batch)\n            return;\n        // the number of globally pending items will always be larger or the same as batch size.\n        // Any mismatch is because some globally pending items are in plugins.\n        const isExpectingNoMoreItems = this._batch.length === pendingItemsCount;\n        if (isExpectingNoMoreItems) {\n            this.send(this._batch)\n                .catch(noop)\n                .finally(() => {\n                // stop poller so program can exit ().\n                if (this._tokenManager) {\n                    this._tokenManager.stopPoller();\n                }\n            });\n            this.clearBatch();\n        }\n    }\n    /**\n     * Enqueues the context for future delivery.\n     * @param ctx - Context containing a Segment event.\n     * @returns a promise that resolves with the context after the event has been delivered.\n     */\n    enqueue(ctx) {\n        const batch = this._batch ?? this.createBatch();\n        const { promise: ctxPromise, resolve } = (0,_segment_analytics_generic_utils__WEBPACK_IMPORTED_MODULE_3__.createDeferred)();\n        const pendingItem = {\n            context: ctx,\n            resolver: resolve,\n        };\n        /*\n          The following logic ensures that a batch is never orphaned,\n          and is always sent before a new batch is created.\n    \n          Add an event to the existing batch.\n            Success: Check if batch is full or no more items are expected to come in (i.e. closing). If so, send batch.\n            Failure: Assume event is too big to fit in current batch - send existing batch.\n              Add an event to the new batch.\n                Success: Check if batch is full and send if it is.\n                Failure: Event exceeds maximum size (it will never fit), fail the event.\n        */\n        const addStatus = batch.tryAdd(pendingItem);\n        if (addStatus.success) {\n            const isExpectingNoMoreItems = batch.length === this._flushPendingItemsCount;\n            const isFull = batch.length === this._flushAt;\n            if (isFull || isExpectingNoMoreItems) {\n                this.send(batch).catch(noop);\n                this.clearBatch();\n            }\n            return ctxPromise;\n        }\n        // If the new item causes the maximimum event size to be exceeded, send the current batch and create a new one.\n        if (batch.length) {\n            this.send(batch).catch(noop);\n            this.clearBatch();\n        }\n        const fallbackBatch = this.createBatch();\n        const fbAddStatus = fallbackBatch.tryAdd(pendingItem);\n        if (fbAddStatus.success) {\n            const isExpectingNoMoreItems = fallbackBatch.length === this._flushPendingItemsCount;\n            if (isExpectingNoMoreItems) {\n                this.send(fallbackBatch).catch(noop);\n                this.clearBatch();\n            }\n            return ctxPromise;\n        }\n        else {\n            // this should only occur if max event size is exceeded\n            ctx.setFailedDelivery({\n                reason: new Error(fbAddStatus.message),\n            });\n            return Promise.resolve(ctx);\n        }\n    }\n    async send(batch) {\n        if (this._flushPendingItemsCount) {\n            this._flushPendingItemsCount -= batch.length;\n        }\n        const events = batch.getEvents();\n        const maxAttempts = this._maxRetries + 1;\n        let currentAttempt = 0;\n        while (currentAttempt < maxAttempts) {\n            currentAttempt++;\n            let requestedRetryTimeout;\n            let failureReason;\n            try {\n                if (this._disable) {\n                    return batch.resolveEvents();\n                }\n                let authString = undefined;\n                if (this._tokenManager) {\n                    const token = await this._tokenManager.getAccessToken();\n                    if (token && token.access_token) {\n                        authString = `Bearer ${token.access_token}`;\n                    }\n                }\n                const headers = {\n                    'Content-Type': 'application/json',\n                    'User-Agent': 'analytics-node-next/latest',\n                    ...(authString ? { Authorization: authString } : {}),\n                };\n                const request = {\n                    url: this._url,\n                    method: 'POST',\n                    headers: headers,\n                    body: JSON.stringify({\n                        batch: events,\n                        writeKey: this._writeKey,\n                        sentAt: new Date(),\n                    }),\n                    httpRequestTimeout: this._httpRequestTimeout,\n                };\n                this._emitter.emit('http_request', {\n                    body: request.body,\n                    method: request.method,\n                    url: request.url,\n                    headers: request.headers,\n                });\n                const response = await this._httpClient.makeRequest(request);\n                if (response.status >= 200 && response.status < 300) {\n                    // Successfully sent events, so exit!\n                    batch.resolveEvents();\n                    return;\n                }\n                else if (this._tokenManager &&\n                    (response.status === 400 ||\n                        response.status === 401 ||\n                        response.status === 403)) {\n                    // Retry with a new OAuth token if we have OAuth data\n                    this._tokenManager.clearToken();\n                    failureReason = new Error(`[${response.status}] ${response.statusText}`);\n                }\n                else if (response.status === 400) {\n                    // https://segment.com/docs/connections/sources/catalog/libraries/server/http-api/#max-request-size\n                    // Request either malformed or size exceeded - don't retry.\n                    resolveFailedBatch(batch, new Error(`[${response.status}] ${response.statusText}`));\n                    return;\n                }\n                else if (response.status === 429) {\n                    // Rate limited, wait for the reset time\n                    if (response.headers && 'x-ratelimit-reset' in response.headers) {\n                        const rateLimitResetTimestamp = parseInt(response.headers['x-ratelimit-reset'], 10);\n                        if (isFinite(rateLimitResetTimestamp)) {\n                            requestedRetryTimeout = rateLimitResetTimestamp - Date.now();\n                        }\n                    }\n                    failureReason = new Error(`[${response.status}] ${response.statusText}`);\n                }\n                else {\n                    // Treat other errors as transient and retry.\n                    failureReason = new Error(`[${response.status}] ${response.statusText}`);\n                }\n            }\n            catch (err) {\n                // Network errors get thrown, retry them.\n                failureReason = err;\n            }\n            // Final attempt failed, update context and resolve events.\n            if (currentAttempt === maxAttempts) {\n                resolveFailedBatch(batch, failureReason);\n                return;\n            }\n            // Retry after attempt-based backoff.\n            await sleep(requestedRetryTimeout\n                ? requestedRetryTimeout\n                : (0,_segment_analytics_core__WEBPACK_IMPORTED_MODULE_4__.backoff)({\n                    attempt: currentAttempt,\n                    minTimeout: 25,\n                    maxTimeout: 1000,\n                }));\n        }\n    }\n}\nfunction resolveFailedBatch(batch, reason) {\n    batch.getContexts().forEach((ctx) => ctx.setFailedDelivery({ reason }));\n    batch.resolveEvents();\n}\n//# sourceMappingURL=publisher.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5vZGUvZGlzdC9lc20vcGx1Z2lucy9zZWdtZW50aW8vcHVibGlzaGVyLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFrRDtBQUNXO0FBQ0s7QUFDbkI7QUFDUTtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsbUhBQW1IO0FBQ3JJO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHNFQUFxQjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLDREQUFZO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQix3REFBWTtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiwrQkFBK0IsRUFBRSxnRkFBYztBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQStDLG1CQUFtQjtBQUNsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLDRCQUE0QixJQUFJO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrREFBa0QsZ0JBQWdCLElBQUksb0JBQW9CO0FBQzFGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNERBQTRELGdCQUFnQixJQUFJLG9CQUFvQjtBQUNwRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCxnQkFBZ0IsSUFBSSxvQkFBb0I7QUFDMUY7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELGdCQUFnQixJQUFJLG9CQUFvQjtBQUMxRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLGdFQUFPO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlFQUFpRSxRQUFRO0FBQ3pFO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiL1VzZXJzL2FwcGxlL0Rlc2t0b3AvQWVsZiBQcm9qZWN0cy9hZWxmLWNvZGUtZ2VuZXJhdG9yL25vZGVfbW9kdWxlcy9Ac2VnbWVudC9hbmFseXRpY3Mtbm9kZS9kaXN0L2VzbS9wbHVnaW5zL3NlZ21lbnRpby9wdWJsaXNoZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYmFja29mZiB9IGZyb20gJ0BzZWdtZW50L2FuYWx5dGljcy1jb3JlJztcbmltcG9ydCB7IHRyeUNyZWF0ZUZvcm1hdHRlZFVybCB9IGZyb20gJy4uLy4uL2xpYi9jcmVhdGUtdXJsJztcbmltcG9ydCB7IGNyZWF0ZURlZmVycmVkIH0gZnJvbSAnQHNlZ21lbnQvYW5hbHl0aWNzLWdlbmVyaWMtdXRpbHMnO1xuaW1wb3J0IHsgQ29udGV4dEJhdGNoIH0gZnJvbSAnLi9jb250ZXh0LWJhdGNoJztcbmltcG9ydCB7IFRva2VuTWFuYWdlciB9IGZyb20gJy4uLy4uL2xpYi90b2tlbi1tYW5hZ2VyJztcbmZ1bmN0aW9uIHNsZWVwKHRpbWVvdXRJbk1zKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIHRpbWVvdXRJbk1zKSk7XG59XG5mdW5jdGlvbiBub29wKCkgeyB9XG4vKipcbiAqIFRoZSBQdWJsaXNoZXIgaXMgcmVzcG9uc2libGUgZm9yIGJhdGNoaW5nIGV2ZW50cyBhbmQgc2VuZGluZyB0aGVtIHRvIHRoZSBTZWdtZW50IEFQSS5cbiAqL1xuZXhwb3J0IGNsYXNzIFB1Ymxpc2hlciB7XG4gICAgcGVuZGluZ0ZsdXNoVGltZW91dDtcbiAgICBfYmF0Y2g7XG4gICAgX2ZsdXNoSW50ZXJ2YWw7XG4gICAgX2ZsdXNoQXQ7XG4gICAgX21heFJldHJpZXM7XG4gICAgX3VybDtcbiAgICBfZmx1c2hQZW5kaW5nSXRlbXNDb3VudDtcbiAgICBfaHR0cFJlcXVlc3RUaW1lb3V0O1xuICAgIF9lbWl0dGVyO1xuICAgIF9kaXNhYmxlO1xuICAgIF9odHRwQ2xpZW50O1xuICAgIF93cml0ZUtleTtcbiAgICBfdG9rZW5NYW5hZ2VyO1xuICAgIGNvbnN0cnVjdG9yKHsgaG9zdCwgcGF0aCwgbWF4UmV0cmllcywgZmx1c2hBdCwgZmx1c2hJbnRlcnZhbCwgd3JpdGVLZXksIGh0dHBSZXF1ZXN0VGltZW91dCwgaHR0cENsaWVudCwgZGlzYWJsZSwgb2F1dGhTZXR0aW5ncywgfSwgZW1pdHRlcikge1xuICAgICAgICB0aGlzLl9lbWl0dGVyID0gZW1pdHRlcjtcbiAgICAgICAgdGhpcy5fbWF4UmV0cmllcyA9IG1heFJldHJpZXM7XG4gICAgICAgIHRoaXMuX2ZsdXNoQXQgPSBNYXRoLm1heChmbHVzaEF0LCAxKTtcbiAgICAgICAgdGhpcy5fZmx1c2hJbnRlcnZhbCA9IGZsdXNoSW50ZXJ2YWw7XG4gICAgICAgIHRoaXMuX3VybCA9IHRyeUNyZWF0ZUZvcm1hdHRlZFVybChob3N0ID8/ICdodHRwczovL2FwaS5zZWdtZW50LmlvJywgcGF0aCA/PyAnL3YxL2JhdGNoJyk7XG4gICAgICAgIHRoaXMuX2h0dHBSZXF1ZXN0VGltZW91dCA9IGh0dHBSZXF1ZXN0VGltZW91dCA/PyAxMDAwMDtcbiAgICAgICAgdGhpcy5fZGlzYWJsZSA9IEJvb2xlYW4oZGlzYWJsZSk7XG4gICAgICAgIHRoaXMuX2h0dHBDbGllbnQgPSBodHRwQ2xpZW50O1xuICAgICAgICB0aGlzLl93cml0ZUtleSA9IHdyaXRlS2V5O1xuICAgICAgICBpZiAob2F1dGhTZXR0aW5ncykge1xuICAgICAgICAgICAgdGhpcy5fdG9rZW5NYW5hZ2VyID0gbmV3IFRva2VuTWFuYWdlcih7XG4gICAgICAgICAgICAgICAgLi4ub2F1dGhTZXR0aW5ncyxcbiAgICAgICAgICAgICAgICBodHRwQ2xpZW50OiBvYXV0aFNldHRpbmdzLmh0dHBDbGllbnQgPz8gaHR0cENsaWVudCxcbiAgICAgICAgICAgICAgICBtYXhSZXRyaWVzOiBvYXV0aFNldHRpbmdzLm1heFJldHJpZXMgPz8gbWF4UmV0cmllcyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNyZWF0ZUJhdGNoKCkge1xuICAgICAgICB0aGlzLnBlbmRpbmdGbHVzaFRpbWVvdXQgJiYgY2xlYXJUaW1lb3V0KHRoaXMucGVuZGluZ0ZsdXNoVGltZW91dCk7XG4gICAgICAgIGNvbnN0IGJhdGNoID0gbmV3IENvbnRleHRCYXRjaCh0aGlzLl9mbHVzaEF0KTtcbiAgICAgICAgdGhpcy5fYmF0Y2ggPSBiYXRjaDtcbiAgICAgICAgdGhpcy5wZW5kaW5nRmx1c2hUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBpZiAoYmF0Y2ggPT09IHRoaXMuX2JhdGNoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYmF0Y2ggPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnBlbmRpbmdGbHVzaFRpbWVvdXQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICBpZiAoYmF0Y2gubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZW5kKGJhdGNoKS5jYXRjaChub29wKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgdGhpcy5fZmx1c2hJbnRlcnZhbCk7XG4gICAgICAgIHJldHVybiBiYXRjaDtcbiAgICB9XG4gICAgY2xlYXJCYXRjaCgpIHtcbiAgICAgICAgdGhpcy5wZW5kaW5nRmx1c2hUaW1lb3V0ICYmIGNsZWFyVGltZW91dCh0aGlzLnBlbmRpbmdGbHVzaFRpbWVvdXQpO1xuICAgICAgICB0aGlzLl9iYXRjaCA9IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgZmx1c2gocGVuZGluZ0l0ZW1zQ291bnQpIHtcbiAgICAgICAgaWYgKCFwZW5kaW5nSXRlbXNDb3VudCkge1xuICAgICAgICAgICAgLy8gaWYgbnVtYmVyIG9mIHBlbmRpbmcgaXRlbXMgaXMgMCwgdGhlcmUgd2lsbCBuZXZlciBiZSBhbnl0aGluZyBlbHNlIGVudGVyaW5nIHRoZSBiYXRjaCwgc2luY2UgdGhlIGFwcCBpcyBjbG9zZWQuXG4gICAgICAgICAgICBpZiAodGhpcy5fdG9rZW5NYW5hZ2VyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdG9rZW5NYW5hZ2VyLnN0b3BQb2xsZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9mbHVzaFBlbmRpbmdJdGVtc0NvdW50ID0gcGVuZGluZ0l0ZW1zQ291bnQ7XG4gICAgICAgIC8vIGlmIGJhdGNoIGlzIGVtcHR5LCB0aGVyZSdzIG5vdGhpbmcgdG8gZmx1c2gsIGFuZCB3aGVuIHRoaW5ncyBjb21lIGluLCBlbnF1ZXVlIHdpbGwgaGFuZGxlIHRoZW0uXG4gICAgICAgIGlmICghdGhpcy5fYmF0Y2gpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIC8vIHRoZSBudW1iZXIgb2YgZ2xvYmFsbHkgcGVuZGluZyBpdGVtcyB3aWxsIGFsd2F5cyBiZSBsYXJnZXIgb3IgdGhlIHNhbWUgYXMgYmF0Y2ggc2l6ZS5cbiAgICAgICAgLy8gQW55IG1pc21hdGNoIGlzIGJlY2F1c2Ugc29tZSBnbG9iYWxseSBwZW5kaW5nIGl0ZW1zIGFyZSBpbiBwbHVnaW5zLlxuICAgICAgICBjb25zdCBpc0V4cGVjdGluZ05vTW9yZUl0ZW1zID0gdGhpcy5fYmF0Y2gubGVuZ3RoID09PSBwZW5kaW5nSXRlbXNDb3VudDtcbiAgICAgICAgaWYgKGlzRXhwZWN0aW5nTm9Nb3JlSXRlbXMpIHtcbiAgICAgICAgICAgIHRoaXMuc2VuZCh0aGlzLl9iYXRjaClcbiAgICAgICAgICAgICAgICAuY2F0Y2gobm9vcClcbiAgICAgICAgICAgICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gc3RvcCBwb2xsZXIgc28gcHJvZ3JhbSBjYW4gZXhpdCAoKS5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fdG9rZW5NYW5hZ2VyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rva2VuTWFuYWdlci5zdG9wUG9sbGVyKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmNsZWFyQmF0Y2goKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBFbnF1ZXVlcyB0aGUgY29udGV4dCBmb3IgZnV0dXJlIGRlbGl2ZXJ5LlxuICAgICAqIEBwYXJhbSBjdHggLSBDb250ZXh0IGNvbnRhaW5pbmcgYSBTZWdtZW50IGV2ZW50LlxuICAgICAqIEByZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIHdpdGggdGhlIGNvbnRleHQgYWZ0ZXIgdGhlIGV2ZW50IGhhcyBiZWVuIGRlbGl2ZXJlZC5cbiAgICAgKi9cbiAgICBlbnF1ZXVlKGN0eCkge1xuICAgICAgICBjb25zdCBiYXRjaCA9IHRoaXMuX2JhdGNoID8/IHRoaXMuY3JlYXRlQmF0Y2goKTtcbiAgICAgICAgY29uc3QgeyBwcm9taXNlOiBjdHhQcm9taXNlLCByZXNvbHZlIH0gPSBjcmVhdGVEZWZlcnJlZCgpO1xuICAgICAgICBjb25zdCBwZW5kaW5nSXRlbSA9IHtcbiAgICAgICAgICAgIGNvbnRleHQ6IGN0eCxcbiAgICAgICAgICAgIHJlc29sdmVyOiByZXNvbHZlLFxuICAgICAgICB9O1xuICAgICAgICAvKlxuICAgICAgICAgIFRoZSBmb2xsb3dpbmcgbG9naWMgZW5zdXJlcyB0aGF0IGEgYmF0Y2ggaXMgbmV2ZXIgb3JwaGFuZWQsXG4gICAgICAgICAgYW5kIGlzIGFsd2F5cyBzZW50IGJlZm9yZSBhIG5ldyBiYXRjaCBpcyBjcmVhdGVkLlxuICAgIFxuICAgICAgICAgIEFkZCBhbiBldmVudCB0byB0aGUgZXhpc3RpbmcgYmF0Y2guXG4gICAgICAgICAgICBTdWNjZXNzOiBDaGVjayBpZiBiYXRjaCBpcyBmdWxsIG9yIG5vIG1vcmUgaXRlbXMgYXJlIGV4cGVjdGVkIHRvIGNvbWUgaW4gKGkuZS4gY2xvc2luZykuIElmIHNvLCBzZW5kIGJhdGNoLlxuICAgICAgICAgICAgRmFpbHVyZTogQXNzdW1lIGV2ZW50IGlzIHRvbyBiaWcgdG8gZml0IGluIGN1cnJlbnQgYmF0Y2ggLSBzZW5kIGV4aXN0aW5nIGJhdGNoLlxuICAgICAgICAgICAgICBBZGQgYW4gZXZlbnQgdG8gdGhlIG5ldyBiYXRjaC5cbiAgICAgICAgICAgICAgICBTdWNjZXNzOiBDaGVjayBpZiBiYXRjaCBpcyBmdWxsIGFuZCBzZW5kIGlmIGl0IGlzLlxuICAgICAgICAgICAgICAgIEZhaWx1cmU6IEV2ZW50IGV4Y2VlZHMgbWF4aW11bSBzaXplIChpdCB3aWxsIG5ldmVyIGZpdCksIGZhaWwgdGhlIGV2ZW50LlxuICAgICAgICAqL1xuICAgICAgICBjb25zdCBhZGRTdGF0dXMgPSBiYXRjaC50cnlBZGQocGVuZGluZ0l0ZW0pO1xuICAgICAgICBpZiAoYWRkU3RhdHVzLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgIGNvbnN0IGlzRXhwZWN0aW5nTm9Nb3JlSXRlbXMgPSBiYXRjaC5sZW5ndGggPT09IHRoaXMuX2ZsdXNoUGVuZGluZ0l0ZW1zQ291bnQ7XG4gICAgICAgICAgICBjb25zdCBpc0Z1bGwgPSBiYXRjaC5sZW5ndGggPT09IHRoaXMuX2ZsdXNoQXQ7XG4gICAgICAgICAgICBpZiAoaXNGdWxsIHx8IGlzRXhwZWN0aW5nTm9Nb3JlSXRlbXMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbmQoYmF0Y2gpLmNhdGNoKG5vb3ApO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJCYXRjaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGN0eFByb21pc2U7XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgdGhlIG5ldyBpdGVtIGNhdXNlcyB0aGUgbWF4aW1pbXVtIGV2ZW50IHNpemUgdG8gYmUgZXhjZWVkZWQsIHNlbmQgdGhlIGN1cnJlbnQgYmF0Y2ggYW5kIGNyZWF0ZSBhIG5ldyBvbmUuXG4gICAgICAgIGlmIChiYXRjaC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMuc2VuZChiYXRjaCkuY2F0Y2gobm9vcCk7XG4gICAgICAgICAgICB0aGlzLmNsZWFyQmF0Y2goKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBmYWxsYmFja0JhdGNoID0gdGhpcy5jcmVhdGVCYXRjaCgpO1xuICAgICAgICBjb25zdCBmYkFkZFN0YXR1cyA9IGZhbGxiYWNrQmF0Y2gudHJ5QWRkKHBlbmRpbmdJdGVtKTtcbiAgICAgICAgaWYgKGZiQWRkU3RhdHVzLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgIGNvbnN0IGlzRXhwZWN0aW5nTm9Nb3JlSXRlbXMgPSBmYWxsYmFja0JhdGNoLmxlbmd0aCA9PT0gdGhpcy5fZmx1c2hQZW5kaW5nSXRlbXNDb3VudDtcbiAgICAgICAgICAgIGlmIChpc0V4cGVjdGluZ05vTW9yZUl0ZW1zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZW5kKGZhbGxiYWNrQmF0Y2gpLmNhdGNoKG5vb3ApO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJCYXRjaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGN0eFByb21pc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyB0aGlzIHNob3VsZCBvbmx5IG9jY3VyIGlmIG1heCBldmVudCBzaXplIGlzIGV4Y2VlZGVkXG4gICAgICAgICAgICBjdHguc2V0RmFpbGVkRGVsaXZlcnkoe1xuICAgICAgICAgICAgICAgIHJlYXNvbjogbmV3IEVycm9yKGZiQWRkU3RhdHVzLm1lc3NhZ2UpLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGN0eCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYXN5bmMgc2VuZChiYXRjaCkge1xuICAgICAgICBpZiAodGhpcy5fZmx1c2hQZW5kaW5nSXRlbXNDb3VudCkge1xuICAgICAgICAgICAgdGhpcy5fZmx1c2hQZW5kaW5nSXRlbXNDb3VudCAtPSBiYXRjaC5sZW5ndGg7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZXZlbnRzID0gYmF0Y2guZ2V0RXZlbnRzKCk7XG4gICAgICAgIGNvbnN0IG1heEF0dGVtcHRzID0gdGhpcy5fbWF4UmV0cmllcyArIDE7XG4gICAgICAgIGxldCBjdXJyZW50QXR0ZW1wdCA9IDA7XG4gICAgICAgIHdoaWxlIChjdXJyZW50QXR0ZW1wdCA8IG1heEF0dGVtcHRzKSB7XG4gICAgICAgICAgICBjdXJyZW50QXR0ZW1wdCsrO1xuICAgICAgICAgICAgbGV0IHJlcXVlc3RlZFJldHJ5VGltZW91dDtcbiAgICAgICAgICAgIGxldCBmYWlsdXJlUmVhc29uO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fZGlzYWJsZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYmF0Y2gucmVzb2x2ZUV2ZW50cygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBsZXQgYXV0aFN0cmluZyA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fdG9rZW5NYW5hZ2VyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRva2VuID0gYXdhaXQgdGhpcy5fdG9rZW5NYW5hZ2VyLmdldEFjY2Vzc1Rva2VuKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0b2tlbiAmJiB0b2tlbi5hY2Nlc3NfdG9rZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhTdHJpbmcgPSBgQmVhcmVyICR7dG9rZW4uYWNjZXNzX3Rva2VufWA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgaGVhZGVycyA9IHtcbiAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAgICAgJ1VzZXItQWdlbnQnOiAnYW5hbHl0aWNzLW5vZGUtbmV4dC9sYXRlc3QnLFxuICAgICAgICAgICAgICAgICAgICAuLi4oYXV0aFN0cmluZyA/IHsgQXV0aG9yaXphdGlvbjogYXV0aFN0cmluZyB9IDoge30pLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgY29uc3QgcmVxdWVzdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB0aGlzLl91cmwsXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJzLFxuICAgICAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgICAgICBiYXRjaDogZXZlbnRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVLZXk6IHRoaXMuX3dyaXRlS2V5LFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VudEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgaHR0cFJlcXVlc3RUaW1lb3V0OiB0aGlzLl9odHRwUmVxdWVzdFRpbWVvdXQsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQoJ2h0dHBfcmVxdWVzdCcsIHtcbiAgICAgICAgICAgICAgICAgICAgYm9keTogcmVxdWVzdC5ib2R5LFxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IHJlcXVlc3QubWV0aG9kLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHJlcXVlc3QudXJsLFxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiByZXF1ZXN0LmhlYWRlcnMsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLl9odHRwQ2xpZW50Lm1ha2VSZXF1ZXN0KHJlcXVlc3QpO1xuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1cyA8IDMwMCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBTdWNjZXNzZnVsbHkgc2VudCBldmVudHMsIHNvIGV4aXQhXG4gICAgICAgICAgICAgICAgICAgIGJhdGNoLnJlc29sdmVFdmVudHMoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLl90b2tlbk1hbmFnZXIgJiZcbiAgICAgICAgICAgICAgICAgICAgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAwIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZS5zdGF0dXMgPT09IDQwMSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2Uuc3RhdHVzID09PSA0MDMpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFJldHJ5IHdpdGggYSBuZXcgT0F1dGggdG9rZW4gaWYgd2UgaGF2ZSBPQXV0aCBkYXRhXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rva2VuTWFuYWdlci5jbGVhclRva2VuKCk7XG4gICAgICAgICAgICAgICAgICAgIGZhaWx1cmVSZWFzb24gPSBuZXcgRXJyb3IoYFske3Jlc3BvbnNlLnN0YXR1c31dICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9zZWdtZW50LmNvbS9kb2NzL2Nvbm5lY3Rpb25zL3NvdXJjZXMvY2F0YWxvZy9saWJyYXJpZXMvc2VydmVyL2h0dHAtYXBpLyNtYXgtcmVxdWVzdC1zaXplXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlcXVlc3QgZWl0aGVyIG1hbGZvcm1lZCBvciBzaXplIGV4Y2VlZGVkIC0gZG9uJ3QgcmV0cnkuXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmVGYWlsZWRCYXRjaChiYXRjaCwgbmV3IEVycm9yKGBbJHtyZXNwb25zZS5zdGF0dXN9XSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDI5KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFJhdGUgbGltaXRlZCwgd2FpdCBmb3IgdGhlIHJlc2V0IHRpbWVcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmhlYWRlcnMgJiYgJ3gtcmF0ZWxpbWl0LXJlc2V0JyBpbiByZXNwb25zZS5oZWFkZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByYXRlTGltaXRSZXNldFRpbWVzdGFtcCA9IHBhcnNlSW50KHJlc3BvbnNlLmhlYWRlcnNbJ3gtcmF0ZWxpbWl0LXJlc2V0J10sIDEwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0Zpbml0ZShyYXRlTGltaXRSZXNldFRpbWVzdGFtcCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0ZWRSZXRyeVRpbWVvdXQgPSByYXRlTGltaXRSZXNldFRpbWVzdGFtcCAtIERhdGUubm93KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZmFpbHVyZVJlYXNvbiA9IG5ldyBFcnJvcihgWyR7cmVzcG9uc2Uuc3RhdHVzfV0gJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVHJlYXQgb3RoZXIgZXJyb3JzIGFzIHRyYW5zaWVudCBhbmQgcmV0cnkuXG4gICAgICAgICAgICAgICAgICAgIGZhaWx1cmVSZWFzb24gPSBuZXcgRXJyb3IoYFske3Jlc3BvbnNlLnN0YXR1c31dICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgLy8gTmV0d29yayBlcnJvcnMgZ2V0IHRocm93biwgcmV0cnkgdGhlbS5cbiAgICAgICAgICAgICAgICBmYWlsdXJlUmVhc29uID0gZXJyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gRmluYWwgYXR0ZW1wdCBmYWlsZWQsIHVwZGF0ZSBjb250ZXh0IGFuZCByZXNvbHZlIGV2ZW50cy5cbiAgICAgICAgICAgIGlmIChjdXJyZW50QXR0ZW1wdCA9PT0gbWF4QXR0ZW1wdHMpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlRmFpbGVkQmF0Y2goYmF0Y2gsIGZhaWx1cmVSZWFzb24pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIFJldHJ5IGFmdGVyIGF0dGVtcHQtYmFzZWQgYmFja29mZi5cbiAgICAgICAgICAgIGF3YWl0IHNsZWVwKHJlcXVlc3RlZFJldHJ5VGltZW91dFxuICAgICAgICAgICAgICAgID8gcmVxdWVzdGVkUmV0cnlUaW1lb3V0XG4gICAgICAgICAgICAgICAgOiBiYWNrb2ZmKHtcbiAgICAgICAgICAgICAgICAgICAgYXR0ZW1wdDogY3VycmVudEF0dGVtcHQsXG4gICAgICAgICAgICAgICAgICAgIG1pblRpbWVvdXQ6IDI1LFxuICAgICAgICAgICAgICAgICAgICBtYXhUaW1lb3V0OiAxMDAwLFxuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIHJlc29sdmVGYWlsZWRCYXRjaChiYXRjaCwgcmVhc29uKSB7XG4gICAgYmF0Y2guZ2V0Q29udGV4dHMoKS5mb3JFYWNoKChjdHgpID0+IGN0eC5zZXRGYWlsZWREZWxpdmVyeSh7IHJlYXNvbiB9KSk7XG4gICAgYmF0Y2gucmVzb2x2ZUV2ZW50cygpO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cHVibGlzaGVyLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@segment/analytics-node/dist/esm/plugins/segmentio/publisher.js\n");

/***/ })

};
;